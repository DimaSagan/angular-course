import{$a as Mh,Aa as nn,Ab as Bh,Ba as rn,Ca as Qe,Cb as qh,Da as ce,Db as $h,Eb as Wh,Ga as Qr,Hb as Xr,Jb as $i,Kb as kt,La as sn,Lb as zh,M as Sh,Ma as on,Na as an,Oa as Yr,Pa as Jr,Q as ct,Qa as Oh,R as Dt,S as Ln,Sa as kh,T as en,Ta as We,U as Hr,Ua as cn,V as Ve,Va as un,X as oe,Y as ut,Ya as xh,Z as Nt,_ as Ot,_a as Lh,a as Ct,aa as Mn,b as Th,bb as jo,cb as Ho,cc as M,d as Pt,dc as B,e as g,f as Bo,fa as Rh,g as qo,ga as Ch,gb as lt,ha as Vn,ib as Ko,j as wh,ja as tn,k as Ah,ka as Kr,la as Fn,m as jr,n as $o,o as Wo,ob as Vh,p as zo,pb as Fh,q as bh,ra as Ie,sa as xe,ta as Ph,tb as de,ub as Uh,wa as Dh,wb as Un,xa as Ke,ya as Go,za as Nh}from"./chunk-7HUVPVHK.js";var AT=M("[Movie] Load Movies",B()),bT=M("[Movie] Load Movies Success",B()),ST=M("[Movie] Load Moviess Failure",B()),RT=M("[Movie] Show More Movies",B()),CT=M("[Movie] Show More Movies Success",B()),PT=M("[Movie] Load Movie Details",B()),DT=M("[Movie] Load Movie Details Success",B()),NT=M("[Movie] Load Movie Details Failure",B()),OT=M("[Movie Details] Clear"),kT=M("[]Movie] Load Movie Credits",B()),xT=M("[]Movie] Load Movie Credits Success",B()),LT=M("[Movie] Load Movie Trailers",B()),MT=M("[Movie] Load Movie Trailers Success",B()),VT=M("[Movie] Load User Movie List",B()),FT=M("[Movie] Load User Movie List Success",B()),UT=M("[Movie] Load User Movie List Failure",B()),BT=M("[Movie] Set Movie To User List",B()),qT=M("[Movie] Set Movie To User List Success",B()),$T=M("[Login] Set User Details",B()),WT=M("[Login] Set User Details Success",B()),zT=M("[Login] Set User Details Failure",B()),GT=M("[Search] Search Movie",B()),jT=M("[Search] Search Movie Success",B()),HT=M("[Search] Search Movie Success Failure",B()),KT=M("[User Subscription] Set User Subscription",B()),QT=M("[User Subscription] Set User Subscription Success",B()),YT=M("[User Unsubscribe] Unsubscribe"),JT=M("[User Unsubscribe] Unsubscribe Succeess",B()),XT=M("[DB] Add Movie To Favorite",B()),ZT=M("[DB] Add Movie To Favorite Succeess"),ew=M("[DB] Add Movie To Favorite Failure",B()),tw=M("[DB] Get Favorites Movies",B()),nw=M("[DB] Get Favorites Movies Succeess",B()),iw=M("[DB] Put Movie From Favorites",B()),rw=M("[DB] Put Movie From Favorites Succeess"),sw=M("[DB] Add Movie To Wachlist",B()),ow=M("[DB] Add Movie To Wachlist Succeess"),aw=M("[DB] Add Movie To Wachlist Failure",B()),cw=M("[DB] Get Wachlist Movies",B()),uw=M("[DB] Get Wachlist Movies Succeess",B()),lw=M("[DB] Put Movie From Wachlist",B()),hw=M("[DB] Put Movie From Wachlist Succeess"),dw=M("[Login Db] Check User Login"),fw=M("[Login Db] Check User Login Succeess",B()),pw=M("[Login DB] Google Login In Data Base"),mw=M("[Login DB] Google Login In Data Base Succeess",B()),gw=M("[Login DB] Google Login In Data Base Failure",B()),_w=M("[login DB] Create New User",B()),yw=M("[login DB] Create New User Succeess"),Iw=M("[login DB] Create New User Failure",B()),vw=M("[login DB] Email And Password Login",B()),Ew=M("[login DB] Email And Password Login Succeess",B()),Tw=M("[login DB] Email And Password Login Failure",B()),ww=M("[login DB] User Log Out"),Aw=M("[login DB] User Log Out Succeess");var jh=function(n){let e=[],t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},eg=function(n){let e=[],t=0,i=0;for(;t<n.length;){let r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){let s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){let s=n[t++],a=n[t++],c=n[t++],l=((r&7)<<18|(s&63)<<12|(a&63)<<6|c&63)-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(l&1023))}else{let s=n[t++],a=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|a&63)}}return e.join("")},Hh={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){let s=n[r],a=r+1<n.length,c=a?n[r+1]:0,l=r+2<n.length,d=l?n[r+2]:0,p=s>>2,I=(s&3)<<4|c>>4,b=(c&15)<<2|d>>6,R=d&63;l||(R=64,a||(b=64)),i.push(t[p],t[I],t[b],t[R])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(jh(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):eg(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){let s=t[n.charAt(r++)],c=r<n.length?t[n.charAt(r)]:0;++r;let d=r<n.length?t[n.charAt(r)]:64;++r;let I=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||c==null||d==null||I==null)throw new Yo;let b=s<<2|c>>4;if(i.push(b),d!==64){let R=c<<4&240|d>>2;if(i.push(R),I!==64){let D=d<<6&192|I;i.push(D)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},Yo=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},tg=function(n){let e=jh(n);return Hh.encodeByteArray(e,!0)},Wi=function(n){return tg(n).replace(/\./g,"")},Xo=function(n){try{return Hh.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function ng(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var ig=()=>ng().__FIREBASE_DEFAULTS__,rg=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},sg=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Xo(n[1]);return e&&JSON.parse(e)},es=()=>{try{return ig()||rg()||sg()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Zo=n=>{var e,t;return(t=(e=es())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Kh=n=>{let e=Zo(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},ea=()=>{var n;return(n=es())===null||n===void 0?void 0:n.config},ta=n=>{var e;return(e=es())===null||e===void 0?void 0:e[`_${n}`]};var Zr=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}};function Qh(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Wi(JSON.stringify(t)),Wi(JSON.stringify(a)),""].join(".")}function pe(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Yh(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(pe())}function og(){var n;let e=(n=es())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Jh(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Xh(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Zh(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ed(){let n=pe();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function td(){return!og()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function na(){try{return typeof indexedDB=="object"}catch{return!1}}function nd(){return new Promise((n,e)=>{try{let t=!0,i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var s;e(((s=r.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var ag="FirebaseError",Le=class n extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=ag,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ht.prototype.create)}},ht=class{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){let i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],a=s?cg(s,i):"Error",c=`${this.serviceName}: ${a} (${r}).`;return new Le(r,c,i)}};function cg(n,e){return n.replace(ug,(t,i)=>{let r=e[i];return r!=null?String(r):`<${i}?>`})}var ug=/\{\$([^}]+)}/g;function id(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function ln(n,e){if(n===e)return!0;let t=Object.keys(n),i=Object.keys(e);for(let r of t){if(!i.includes(r))return!1;let s=n[r],a=e[r];if(Gh(s)&&Gh(a)){if(!ln(s,a))return!1}else if(s!==a)return!1}for(let r of i)if(!t.includes(r))return!1;return!0}function Gh(n){return n!==null&&typeof n=="object"}function Bn(n){let e=[];for(let[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function qn(n){let e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){let[r,s]=i.split("=");e[decodeURIComponent(r)]=decodeURIComponent(s)}}),e}function $n(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function rd(n,e){let t=new Jo(n,e);return t.subscribe.bind(t)}var Jo=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");lg(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=Qo),r.error===void 0&&(r.error=Qo),r.complete===void 0&&(r.complete=Qo);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function lg(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Qo(){}var Sw=4*60*60*1e3;function me(n){return n&&n._delegate?n._delegate:n}var Fe=class{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var hn="[DEFAULT]";var ia=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let i=new Zr;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{let r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let i=this.normalizeInstanceIdentifier(e?.identifier),r=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(dg(e))try{this.getOrInitializeService({instanceIdentifier:hn})}catch{}for(let[t,i]of this.instancesDeferred.entries()){let r=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=hn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return g(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=hn){return this.instances.has(e)}getOptions(e=hn){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(let[s,a]of this.instancesDeferred.entries()){let c=this.normalizeInstanceIdentifier(s);i===c&&a.resolve(r)}return r}onInit(e,t){var i;let r=this.normalizeInstanceIdentifier(t),s=(i=this.onInitCallbacks.get(r))!==null&&i!==void 0?i:new Set;s.add(e),this.onInitCallbacks.set(r,s);let a=this.instances.get(r);return a&&e(a,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let i=this.onInitCallbacks.get(t);if(i)for(let r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:hg(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=hn){return this.component?this.component.multipleInstances?e:hn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function hg(n){return n===hn?void 0:n}function dg(n){return n.instantiationMode==="EAGER"}var ts=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new ia(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var fg=[],G=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(G||{}),pg={debug:G.DEBUG,verbose:G.VERBOSE,info:G.INFO,warn:G.WARN,error:G.ERROR,silent:G.SILENT},mg=G.INFO,gg={[G.DEBUG]:"log",[G.VERBOSE]:"log",[G.INFO]:"info",[G.WARN]:"warn",[G.ERROR]:"error"},_g=(n,e,...t)=>{if(e<n.logLevel)return;let i=new Date().toISOString(),r=gg[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},xt=class{constructor(e){this.name=e,this._logLevel=mg,this._logHandler=_g,this._userLogHandler=null,fg.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in G))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?pg[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,G.DEBUG,...e),this._logHandler(this,G.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,G.VERBOSE,...e),this._logHandler(this,G.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,G.INFO,...e),this._logHandler(this,G.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,G.WARN,...e),this._logHandler(this,G.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,G.ERROR,...e),this._logHandler(this,G.ERROR,...e)}};var yg=(n,e)=>e.some(t=>n instanceof t),sd,od;function Ig(){return sd||(sd=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function vg(){return od||(od=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var ad=new WeakMap,sa=new WeakMap,cd=new WeakMap,ra=new WeakMap,aa=new WeakMap;function Eg(n){let e=new Promise((t,i)=>{let r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(Ye(n.result)),r()},a=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&ad.set(t,n)}).catch(()=>{}),aa.set(e,n),e}function Tg(n){if(sa.has(n))return;let e=new Promise((t,i)=>{let r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),r()},a=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});sa.set(n,e)}var oa={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return sa.get(n);if(e==="objectStoreNames")return n.objectStoreNames||cd.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ye(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function ud(n){oa=n(oa)}function wg(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let i=n.call(ns(this),e,...t);return cd.set(i,e.sort?e.sort():[e]),Ye(i)}:vg().includes(n)?function(...e){return n.apply(ns(this),e),Ye(ad.get(this))}:function(...e){return Ye(n.apply(ns(this),e))}}function Ag(n){return typeof n=="function"?wg(n):(n instanceof IDBTransaction&&Tg(n),yg(n,Ig())?new Proxy(n,oa):n)}function Ye(n){if(n instanceof IDBRequest)return Eg(n);if(ra.has(n))return ra.get(n);let e=Ag(n);return e!==n&&(ra.set(n,e),aa.set(e,n)),e}var ns=n=>aa.get(n);function hd(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){let a=indexedDB.open(n,e),c=Ye(a);return i&&a.addEventListener("upgradeneeded",l=>{i(Ye(a.result),l.oldVersion,l.newVersion,Ye(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),c.then(l=>{s&&l.addEventListener("close",()=>s()),r&&l.addEventListener("versionchange",d=>r(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}var bg=["get","getKey","getAll","getAllKeys","count"],Sg=["put","add","delete","clear"],ca=new Map;function ld(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(ca.get(e))return ca.get(e);let t=e.replace(/FromIndex$/,""),i=e!==t,r=Sg.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||bg.includes(t)))return;let s=function(a,...c){return g(this,null,function*(){let l=this.transaction(a,r?"readwrite":"readonly"),d=l.store;return i&&(d=d.index(c.shift())),(yield Promise.all([d[t](...c),r&&l.done]))[0]})};return ca.set(e,s),s}ud(n=>Th(Ct({},n),{get:(e,t,i)=>ld(e,t)||n.get(e,t,i),has:(e,t)=>!!ld(e,t)||n.has(e,t)}));var la=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Rg(t)){let i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}};function Rg(n){let e=n.getComponent();return e?.type==="VERSION"}var ha="@firebase/app",dd="0.10.12";var dt=new xt("@firebase/app"),Cg="@firebase/app-compat",Pg="@firebase/analytics-compat",Dg="@firebase/analytics",Ng="@firebase/app-check-compat",Og="@firebase/app-check",kg="@firebase/auth",xg="@firebase/auth-compat",Lg="@firebase/database",Mg="@firebase/data-connect",Vg="@firebase/database-compat",Fg="@firebase/functions",Ug="@firebase/functions-compat",Bg="@firebase/installations",qg="@firebase/installations-compat",$g="@firebase/messaging",Wg="@firebase/messaging-compat",zg="@firebase/performance",Gg="@firebase/performance-compat",jg="@firebase/remote-config",Hg="@firebase/remote-config-compat",Kg="@firebase/storage",Qg="@firebase/storage-compat",Yg="@firebase/firestore",Jg="@firebase/vertexai-preview",Xg="@firebase/firestore-compat",Zg="firebase",e_="10.14.0";var da="[DEFAULT]",t_={[ha]:"fire-core",[Cg]:"fire-core-compat",[Dg]:"fire-analytics",[Pg]:"fire-analytics-compat",[Og]:"fire-app-check",[Ng]:"fire-app-check-compat",[kg]:"fire-auth",[xg]:"fire-auth-compat",[Lg]:"fire-rtdb",[Mg]:"fire-data-connect",[Vg]:"fire-rtdb-compat",[Fg]:"fire-fn",[Ug]:"fire-fn-compat",[Bg]:"fire-iid",[qg]:"fire-iid-compat",[$g]:"fire-fcm",[Wg]:"fire-fcm-compat",[zg]:"fire-perf",[Gg]:"fire-perf-compat",[jg]:"fire-rc",[Hg]:"fire-rc-compat",[Kg]:"fire-gcs",[Qg]:"fire-gcs-compat",[Yg]:"fire-fst",[Xg]:"fire-fst-compat",[Jg]:"fire-vertex","fire-js":"fire-js",[Zg]:"fire-js-all"};var zi=new Map,n_=new Map,fa=new Map;function fd(n,e){try{n.container.addComponent(e)}catch(t){dt.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Mt(n){let e=n.name;if(fa.has(e))return dt.debug(`There were multiple attempts to register component ${e}.`),!1;fa.set(e,n);for(let t of zi.values())fd(t,n);for(let t of n_.values())fd(t,n);return!0}function ji(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ue(n){return n.settings!==void 0}var i_={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Lt=new ht("app","Firebase",i_);var pa=class{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Fe("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Lt.create("app-deleted",{appName:this._name})}};var Vt=e_;function _a(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let i=Object.assign({name:da,automaticDataCollectionEnabled:!1},e),r=i.name;if(typeof r!="string"||!r)throw Lt.create("bad-app-name",{appName:String(r)});if(t||(t=ea()),!t)throw Lt.create("no-options");let s=zi.get(r);if(s){if(ln(t,s.options)&&ln(i,s.config))return s;throw Lt.create("duplicate-app",{appName:r})}let a=new ts(r);for(let l of fa.values())a.addComponent(l);let c=new pa(t,i,a);return zi.set(r,c),c}function Wn(n=da){let e=zi.get(n);if(!e&&n===da&&ea())return _a();if(!e)throw Lt.create("no-app",{appName:n});return e}function is(){return Array.from(zi.values())}function fe(n,e,t){var i;let r=(i=t_[n])!==null&&i!==void 0?i:n;t&&(r+=`-${t}`);let s=r.match(/\s|\//),a=e.match(/\s|\//);if(s||a){let c=[`Unable to register library "${r}" with version "${e}":`];s&&c.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&a&&c.push("and"),a&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),dt.warn(c.join(" "));return}Mt(new Fe(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}var r_="firebase-heartbeat-database",s_=1,Gi="firebase-heartbeat-store",ua=null;function _d(){return ua||(ua=hd(r_,s_,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Gi)}catch(t){console.warn(t)}}}}).catch(n=>{throw Lt.create("idb-open",{originalErrorMessage:n.message})})),ua}function o_(n){return g(this,null,function*(){try{let t=(yield _d()).transaction(Gi),i=yield t.objectStore(Gi).get(yd(n));return yield t.done,i}catch(e){if(e instanceof Le)dt.warn(e.message);else{let t=Lt.create("idb-get",{originalErrorMessage:e?.message});dt.warn(t.message)}}})}function pd(n,e){return g(this,null,function*(){try{let i=(yield _d()).transaction(Gi,"readwrite");yield i.objectStore(Gi).put(e,yd(n)),yield i.done}catch(t){if(t instanceof Le)dt.warn(t.message);else{let i=Lt.create("idb-set",{originalErrorMessage:t?.message});dt.warn(i.message)}}})}function yd(n){return`${n.name}!${n.options.appId}`}var a_=1024,c_=30*24*60*60*1e3,ma=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new ga(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}triggerHeartbeat(){return g(this,null,function*(){var e,t;try{let r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=md();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{let c=new Date(a.date).valueOf();return Date.now()-c<=c_}),this._storage.overwrite(this._heartbeatsCache))}catch(i){dt.warn(i)}})}getHeartbeatsHeader(){return g(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=md(),{heartbeatsToSend:i,unsentEntries:r}=u_(this._heartbeatsCache.heartbeats),s=Wi(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return dt.warn(t),""}})}};function md(){return new Date().toISOString().substring(0,10)}function u_(n,e=a_){let t=[],i=n.slice();for(let r of n){let s=t.find(a=>a.agent===r.agent);if(s){if(s.dates.push(r.date),gd(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),gd(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}var ga=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return g(this,null,function*(){return na()?nd().then(()=>!0).catch(()=>!1):!1})}read(){return g(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield o_(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return g(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let r=yield this.read();return pd(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return g(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let r=yield this.read();return pd(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return})}};function gd(n){return Wi(JSON.stringify({version:2,heartbeats:n})).length}function l_(n){Mt(new Fe("platform-logger",e=>new la(e),"PRIVATE")),Mt(new Fe("heartbeat",e=>new ma(e),"PRIVATE")),fe(ha,dd,n),fe(ha,dd,"esm2017"),fe("fire-js","")}l_("");var h_="firebase",d_="10.14.0";fe(h_,d_,"app");var fn=new Vh("ANGULARFIRE2_VERSION");function ss(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(a=>a.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var Hi=(n,e)=>{let t=e?[e]:is(),i=[];return t.forEach(r=>{r.container.getProvider(n).instances.forEach(a=>{i.includes(a)||i.push(a)})}),i},Gn=class{constructor(){return Hi(f_)}},f_="app-check";function zn(){}var rs=class{zone;delegate;constructor(e,t=Ah){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,i){let r=this.zone,s=function(a){r.runGuarded(()=>{e.apply(this,[a])})};return this.delegate.schedule(s,t,i)}},ya=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let i=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",zn,{},zn,zn)),t.pipe(Sh({next:i,complete:i,error:i})).subscribe(e).add(i)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},jn=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new rs(Zone.current)),this.insideAngular=t.run(()=>new rs(Zone.current,wh)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(i){return new(i||n)(en(Ke))};static \u0275prov=ct({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function os(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function p_(n){return os().ngZone.runOutsideAngular(()=>n())}function dn(n){return os().ngZone.run(()=>n())}function m_(n){return g_(os())(n)}function g_(n){return function(t){return t=t.lift(new ya(n.ngZone)),t.pipe(Wo(n.outsideAngular),$o(n.insideAngular))}}var __=(n,e)=>function(){let i=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),dn(()=>n.apply(void 0,i))},ge=(n,e)=>function(){let t,i=arguments;for(let s=0;s<arguments.length;s++)typeof i[s]=="function"&&(e&&(t||=dn(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",zn,{},zn,zn))),i[s]=__(i[s],t));let r=p_(()=>n.apply(this,i));if(!e)if(r instanceof Bo){let s=os();return r.pipe(Wo(s.outsideAngular),$o(s.insideAngular))}else return dn(()=>r);return r instanceof Bo?r.pipe(m_):r instanceof Promise?dn(()=>new Promise((s,a)=>r.then(c=>dn(()=>s(c)),c=>dn(()=>a(c))))):typeof r=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),r.apply(this,arguments)}:dn(()=>r)};var ft=class{constructor(e){return e}},pn=class{constructor(){return is()}};function y_(n){return n&&n.length===1?n[0]:new ft(Wn())}var Ia=new Ln("angularfire2._apps"),I_={provide:ft,useFactory:y_,deps:[[new Ve,Ia]]},v_={provide:pn,deps:[[new Ve,Ia]]};function E_(n){return(e,t)=>{let i=t.get(Fn);fe("angularfire",fn.full,"core"),fe("angularfire",fn.full,"app"),fe("angular",Fh.full,i.toString());let r=e.runOutsideAngular(()=>n(t));return new ft(r)}}function dA(n,...e){return Mn([I_,v_,{provide:Ia,useFactory:E_(n),multi:!0,deps:[Ke,Vn,jn,...e]}])}var fA=ge(_a,!0);function Ld(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var Md=Ld,Vd=new ht("auth","Firebase",Ld());var ds=new xt("@firebase/auth");function T_(n,...e){ds.logLevel<=G.WARN&&ds.warn(`Auth (${Vt}): ${n}`,...e)}function cs(n,...e){ds.logLevel<=G.ERROR&&ds.error(`Auth (${Vt}): ${n}`,...e)}function Be(n,...e){throw Ba(n,...e)}function ze(n,...e){return Ba(n,...e)}function Ua(n,e,t){let i=Object.assign(Object.assign({},Md()),{[e]:t});return new ht("auth","Firebase",i).create(e,{appName:n.name})}function gt(n){return Ua(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function w_(n,e,t){let i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&Be(n,"argument-error"),Ua(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Ba(n,...e){if(typeof n!="string"){let t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return Vd.create(n,...e)}function F(n,e,...t){if(!n)throw Ba(e,...t)}function pt(n){let e="INTERNAL ASSERTION FAILED: "+n;throw cs(e),new Error(e)}function _t(n,e){n||pt(e)}function Ta(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function A_(){return Id()==="http:"||Id()==="https:"}function Id(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function b_(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(A_()||Xh()||"connection"in navigator)?navigator.onLine:!0}function S_(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var mn=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,_t(t>e,"Short delay should be less than long delay!"),this.isMobile=Yh()||Zh()}get(){return b_()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function qa(n,e){_t(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var fs=class{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;pt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;pt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;pt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var R_={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var C_=new mn(3e4,6e4);function Bt(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function yt(s,a,c,l){return g(this,arguments,function*(n,e,t,i,r={}){return Fd(n,r,()=>g(this,null,function*(){let d={},p={};i&&(e==="GET"?p=i:d={body:JSON.stringify(i)});let I=Bn(Object.assign({key:n.config.apiKey},p)).slice(1),b=yield n._getAdditionalHeaders();b["Content-Type"]="application/json",n.languageCode&&(b["X-Firebase-Locale"]=n.languageCode);let R=Object.assign({method:e,headers:b},d);return Jh()||(R.referrerPolicy="no-referrer"),fs.fetch()(Ud(n,n.config.apiHost,t,I),R)}))})}function Fd(n,e,t){return g(this,null,function*(){n._canInitEmulator=!1;let i=Object.assign(Object.assign({},R_),e);try{let r=new wa(n),s=yield Promise.race([t(),r.promise]);r.clearNetworkTimeout();let a=yield s.json();if("needConfirmation"in a)throw as(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{let c=s.ok?a.errorMessage:a.error.message,[l,d]=c.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw as(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw as(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw as(n,"user-disabled",a);let p=i[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw Ua(n,p,d);Be(n,p)}}catch(r){if(r instanceof Le)throw r;Be(n,"network-request-failed",{message:String(r)})}})}function er(s,a,c,l){return g(this,arguments,function*(n,e,t,i,r={}){let d=yield yt(n,e,t,i,r);return"mfaPendingCredential"in d&&Be(n,"multi-factor-auth-required",{_serverResponse:d}),d})}function Ud(n,e,t,i){let r=`${e}${t}?${i}`;return n.config.emulator?qa(n.config,r):`${n.config.apiScheme}://${r}`}function P_(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var wa=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(ze(this.auth,"network-request-failed")),C_.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function as(n,e,t){let i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);let r=ze(n,e,i);return r.customData._tokenResponse=t,r}function vd(n){return n!==void 0&&n.enterprise!==void 0}var Aa=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return P_(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}};function D_(n,e){return g(this,null,function*(){return yt(n,"GET","/v2/recaptchaConfig",Bt(n,e))})}function N_(n,e){return g(this,null,function*(){return yt(n,"POST","/v1/accounts:delete",e)})}function Bd(n,e){return g(this,null,function*(){return yt(n,"POST","/v1/accounts:lookup",e)})}function Ki(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function $a(n,e=!1){return g(this,null,function*(){let t=me(n),i=yield t.getIdToken(e),r=Wa(i);F(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");let s=typeof r.firebase=="object"?r.firebase:void 0,a=s?.sign_in_provider;return{claims:r,token:i,authTime:Ki(va(r.auth_time)),issuedAtTime:Ki(va(r.iat)),expirationTime:Ki(va(r.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function va(n){return Number(n)*1e3}function Wa(n){let[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return cs("JWT malformed, contained fewer than 3 sections"),null;try{let r=Xo(t);return r?JSON.parse(r):(cs("Failed to decode base64 JWT payload"),null)}catch(r){return cs("Caught error parsing JWT payload as JSON",r?.toString()),null}}function Ed(n){let e=Wa(n);return F(e,"internal-error"),F(typeof e.exp<"u","internal-error"),F(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function Kn(n,e,t=!1){return g(this,null,function*(){if(t)return e;try{return yield e}catch(i){throw i instanceof Le&&O_(i)&&n.auth.currentUser===n&&(yield n.auth.signOut()),i}})}function O_({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var ba=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;let r=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>g(this,null,function*(){yield this.iteration()}),t)}iteration(){return g(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Yi=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ki(this.lastLoginAt),this.creationTime=Ki(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function ps(n){return g(this,null,function*(){var e;let t=n.auth,i=yield n.getIdToken(),r=yield Kn(n,Bd(t,{idToken:i}));F(r?.users.length,t,"internal-error");let s=r.users[0];n._notifyReloadListener(s);let a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?qd(s.providerUserInfo):[],c=k_(n.providerData,a),l=n.isAnonymous,d=!(n.email&&s.passwordHash)&&!c?.length,p=l?d:!1,I={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:c,metadata:new Yi(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(n,I)})}function za(n){return g(this,null,function*(){let e=me(n);yield ps(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function k_(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function qd(n){return n.map(e=>{var{providerId:t}=e,i=jr(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}function x_(n,e){return g(this,null,function*(){let t=yield Fd(n,{},()=>g(this,null,function*(){let i=Bn({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=n.config,a=Ud(n,r,"/v1/token",`key=${s}`),c=yield n._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",fs.fetch()(a,{method:"POST",headers:c,body:i})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function L_(n,e){return g(this,null,function*(){return yt(n,"POST","/v2/accounts:revokeToken",Bt(n,e))})}var Qi=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){F(e.idToken,"internal-error"),F(typeof e.idToken<"u","internal-error"),F(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Ed(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){F(e.length!==0,"internal-error");let t=Ed(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return g(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(F(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return g(this,null,function*(){let{accessToken:i,refreshToken:r,expiresIn:s}=yield x_(e,t);this.updateTokensAndExpiration(i,r,Number(s))})}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){let{refreshToken:i,accessToken:r,expirationTime:s}=t,a=new n;return i&&(F(typeof i=="string","internal-error",{appName:e}),a.refreshToken=i),r&&(F(typeof r=="string","internal-error",{appName:e}),a.accessToken=r),s&&(F(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return pt("not implemented")}};function Ut(n,e){F(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var Qn=class n{constructor(e){var{uid:t,auth:i,stsTokenManager:r}=e,s=jr(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ba(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Yi(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return g(this,null,function*(){let t=yield Kn(this,this.stsTokenManager.getToken(this.auth,e));return F(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return $a(this,e)}reload(){return za(this)}_assign(e){this!==e&&(F(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){F(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return g(this,null,function*(){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&(yield ps(this)),yield this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)})}delete(){return g(this,null,function*(){if(Ue(this.auth.app))return Promise.reject(gt(this.auth));let e=yield this.getIdToken();return yield Kn(this,N_(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var i,r,s,a,c,l,d,p;let I=(i=t.displayName)!==null&&i!==void 0?i:void 0,b=(r=t.email)!==null&&r!==void 0?r:void 0,R=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,D=(a=t.photoURL)!==null&&a!==void 0?a:void 0,k=(c=t.tenantId)!==null&&c!==void 0?c:void 0,O=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,z=(d=t.createdAt)!==null&&d!==void 0?d:void 0,W=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:H,emailVerified:te,isAnonymous:De,providerData:J,stsTokenManager:E}=t;F(H&&E,e,"internal-error");let m=Qi.fromJSON(this.name,E);F(typeof H=="string",e,"internal-error"),Ut(I,e.name),Ut(b,e.name),F(typeof te=="boolean",e,"internal-error"),F(typeof De=="boolean",e,"internal-error"),Ut(R,e.name),Ut(D,e.name),Ut(k,e.name),Ut(O,e.name),Ut(z,e.name),Ut(W,e.name);let y=new n({uid:H,auth:e,email:b,emailVerified:te,displayName:I,isAnonymous:De,photoURL:D,phoneNumber:R,tenantId:k,stsTokenManager:m,createdAt:z,lastLoginAt:W});return J&&Array.isArray(J)&&(y.providerData=J.map(v=>Object.assign({},v))),O&&(y._redirectEventId=O),y}static _fromIdTokenResponse(e,t,i=!1){return g(this,null,function*(){let r=new Qi;r.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return yield ps(s),s})}static _fromGetAccountInfoResponse(e,t,i){return g(this,null,function*(){let r=t.users[0];F(r.localId!==void 0,"internal-error");let s=r.providerUserInfo!==void 0?qd(r.providerUserInfo):[],a=!(r.email&&r.passwordHash)&&!s?.length,c=new Qi;c.updateFromIdToken(i);let l=new n({uid:r.localId,auth:e,stsTokenManager:c,isAnonymous:a}),d={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new Yi(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!s?.length};return Object.assign(l,d),l})}};var Td=new Map;function mt(n){_t(n instanceof Function,"Expected a class definition");let e=Td.get(n);return e?(_t(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Td.set(n,e),e)}var M_=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return g(this,null,function*(){return!0})}_set(t,i){return g(this,null,function*(){this.storage[t]=i})}_get(t){return g(this,null,function*(){let i=this.storage[t];return i===void 0?null:i})}_remove(t){return g(this,null,function*(){delete this.storage[t]})}_addListener(t,i){}_removeListener(t,i){}}return n.type="NONE",n})(),Sa=M_;function us(n,e,t){return`firebase:${n}:${e}:${t}`}var ms=class n{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;let{config:r,name:s}=this.auth;this.fullUserKey=us(this.userKey,r.apiKey,s),this.fullPersistenceKey=us("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return g(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?Qn._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return g(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,i="authUser"){return g(this,null,function*(){if(!t.length)return new n(mt(Sa),e,i);let r=(yield Promise.all(t.map(d=>g(this,null,function*(){if(yield d._isAvailable())return d})))).filter(d=>d),s=r[0]||mt(Sa),a=us(i,e.config.apiKey,e.name),c=null;for(let d of t)try{let p=yield d._get(a);if(p){let I=Qn._fromJSON(e,p);d!==s&&(c=I),s=d;break}}catch{}let l=r.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new n(s,e,i):(s=l[0],c&&(yield s._set(a,c.toJSON())),yield Promise.all(t.map(d=>g(this,null,function*(){if(d!==s)try{yield d._remove(a)}catch{}}))),new n(s,e,i))})}};function wd(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Gd(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if($d(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Hd(e))return"Blackberry";if(Kd(e))return"Webos";if(Wd(e))return"Safari";if((e.includes("chrome/")||zd(e))&&!e.includes("edge/"))return"Chrome";if(jd(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function $d(n=pe()){return/firefox\//i.test(n)}function Wd(n=pe()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function zd(n=pe()){return/crios\//i.test(n)}function Gd(n=pe()){return/iemobile/i.test(n)}function jd(n=pe()){return/android/i.test(n)}function Hd(n=pe()){return/blackberry/i.test(n)}function Kd(n=pe()){return/webos/i.test(n)}function Ga(n=pe()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function V_(n=pe()){var e;return Ga(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function F_(){return ed()&&document.documentMode===10}function Qd(n=pe()){return Ga(n)||jd(n)||Kd(n)||Hd(n)||/windows phone/i.test(n)||Gd(n)}function Yd(n,e=[]){let t;switch(n){case"Browser":t=wd(pe());break;case"Worker":t=`${wd(pe())}-${n}`;break;default:t=n}let i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Vt}/${i}`}var Ra=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let i=s=>new Promise((a,c)=>{try{let l=e(s);a(l)}catch(l){c(l)}});i.onAbort=t,this.queue.push(i);let r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}runMiddleware(e){return g(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let i of this.queue)yield i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(let r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}})}};function U_(t){return g(this,arguments,function*(n,e={}){return yt(n,"GET","/v2/passwordPolicy",Bt(n,e))})}var B_=6,Ca=class{constructor(e){var t,i,r,s;let a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:B_,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(r=(i=e.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&r!==void 0?r:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,i,r,s,a,c;let l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(i=l.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(r=l.containsLowercaseLetter)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(c=l.containsNonAlphanumericCharacter)!==null&&c!==void 0?c:!0),l}validatePasswordLengthOptions(e,t){let i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var Pa=class{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new gs(this),this.idTokenSubscription=new gs(this),this.beforeStateQueue=new Ra(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Vd,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=mt(t)),this._initializationPromise=this.queue(()=>g(this,null,function*(){var i,r;if(!this._deleted&&(this.persistenceManager=yield ms.create(this,e),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((r=this.currentUser)===null||r===void 0?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return g(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return g(this,null,function*(){try{let t=yield Bd(this,{idToken:e}),i=yield Qn._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return g(this,null,function*(){var t;if(Ue(this.app)){let a=this.app.settings.authIdToken;return a?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(c,c))}):this.directlySetCurrentUser(null)}let i=yield this.assertedPersistence.getCurrentUser(),r=i,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,c=r?._redirectEventId,l=yield this.tryRedirectSignIn(e);(!a||a===c)&&l?.user&&(r=l.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(r)}catch(a){r=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return F(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)})}tryRedirectSignIn(e){return g(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return g(this,null,function*(){try{yield ps(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=S_()}_delete(){return g(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return g(this,null,function*(){if(Ue(this.app))return Promise.reject(gt(this));let t=e?me(e):null;return t&&F(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return g(this,null,function*(){if(!this._deleted)return e&&F(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>g(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return g(this,null,function*(){return Ue(this.app)?Promise.reject(gt(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return Ue(this.app)?Promise.reject(gt(this)):this.queue(()=>g(this,null,function*(){yield this.assertedPersistence.setPersistence(mt(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return g(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return g(this,null,function*(){let e=yield U_(this),t=new Ca(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new ht("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let i=this.onAuthStateChanged(()=>{i(),e()},t)}})}revokeAccessToken(e){return g(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),yield L_(this,i)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return g(this,null,function*(){let i=yield this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return g(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&mt(e)||this._popupRedirectResolver;F(t,this,"argument-error"),this.redirectPersistenceManager=yield ms.create(this,[mt(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return g(this,null,function*(){var t,i;return this._isInitialized&&(yield this.queue(()=>g(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return g(this,null,function*(){if(e===this.currentUser)return this.queue(()=>g(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let i=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),a=!1,c=this._isInitialized?Promise.resolve():this._initializationPromise;if(F(c,this,"internal-error"),c.then(()=>{a||s(this.currentUser)}),typeof t=="function"){let l=e.addObserver(t,i,r);return()=>{a=!0,l()}}else{let l=e.addObserver(t);return()=>{a=!0,l()}}}directlySetCurrentUser(e){return g(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return F(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Yd(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return g(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let i=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();i&&(t["X-Firebase-Client"]=i);let r=yield this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t})}_getAppCheckToken(){return g(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&T_(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function qt(n){return me(n)}var gs=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=rd(t=>this.observer=t)}get next(){return F(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var bs={loadJS(){return g(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function q_(n){bs=n}function Jd(n){return bs.loadJS(n)}function $_(){return bs.recaptchaEnterpriseScript}function W_(){return bs.gapiScript}function Xd(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var z_="recaptcha-enterprise",G_="NO_RECAPTCHA",Da=class{constructor(e){this.type=z_,this.auth=qt(e)}verify(e="verify",t=!1){return g(this,null,function*(){function i(s){return g(this,null,function*(){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise((a,c)=>g(this,null,function*(){D_(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{let d=new Aa(l);return s.tenantId==null?s._agentRecaptchaConfig=d:s._tenantRecaptchaConfigs[s.tenantId]=d,a(d.siteKey)}}).catch(l=>{c(l)})}))})}function r(s,a,c){let l=window.grecaptcha;vd(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(d=>{a(d)}).catch(()=>{a(G_)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,a)=>{i(this.auth).then(c=>{if(!t&&vd(window.grecaptcha))r(c,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let l=$_();l.length!==0&&(l+=c),Jd(l).then(()=>{r(c,s,a)}).catch(d=>{a(d)})}}).catch(c=>{a(c)})})})}};function Ad(n,e,t,i=!1){return g(this,null,function*(){let r=new Da(n),s;try{s=yield r.verify(t)}catch{s=yield r.verify(t,!0)}let a=Object.assign({},e);return i?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a})}function Na(n,e,t,i){return g(this,null,function*(){var r;if(!((r=n._getRecaptchaConfig())===null||r===void 0)&&r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let s=yield Ad(n,e,t,t==="getOobCode");return i(n,s)}else return i(n,e).catch(s=>g(this,null,function*(){if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let a=yield Ad(n,e,t,t==="getOobCode");return i(n,a)}else return Promise.reject(s)}))})}function ja(n,e){let t=ji(n,"auth");if(t.isInitialized()){let r=t.getImmediate(),s=t.getOptions();if(ln(s,e??{}))return r;Be(r,"already-initialized")}return t.initialize({options:e})}function j_(n,e){let t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(mt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function Ha(n,e,t){let i=qt(n);F(i._canInitEmulator,i,"emulator-config-failed"),F(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");let r=!!t?.disableWarnings,s=Zd(e),{host:a,port:c}=H_(e),l=c===null?"":`:${c}`;i.config.emulator={url:`${s}//${a}${l}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:a,port:c,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||K_()}function Zd(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function H_(n){let e=Zd(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){let s=r[1];return{host:s,port:bd(i.substr(s.length+1))}}else{let[s,a]=i.split(":");return{host:s,port:bd(a)}}}function bd(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function K_(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var Yn=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return pt("not implemented")}_getIdTokenResponse(e){return pt("not implemented")}_linkToIdToken(e,t){return pt("not implemented")}_getReauthenticationResolver(e){return pt("not implemented")}};function Q_(n,e){return g(this,null,function*(){return yt(n,"POST","/v1/accounts:signUp",e)})}function Y_(n,e){return g(this,null,function*(){return er(n,"POST","/v1/accounts:signInWithPassword",Bt(n,e))})}function J_(n,e){return g(this,null,function*(){return er(n,"POST","/v1/accounts:signInWithEmailLink",Bt(n,e))})}function X_(n,e){return g(this,null,function*(){return er(n,"POST","/v1/accounts:signInWithEmailLink",Bt(n,e))})}var Ji=class n extends Yn{constructor(e,t,i,r=null){super("password",i),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new n(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){return g(this,null,function*(){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Na(e,t,"signInWithPassword",Y_);case"emailLink":return J_(e,{email:this._email,oobCode:this._password});default:Be(e,"internal-error")}})}_linkToIdToken(e,t){return g(this,null,function*(){switch(this.signInMethod){case"password":let i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Na(e,i,"signUpPassword",Q_);case"emailLink":return X_(e,{idToken:t,email:this._email,oobCode:this._password});default:Be(e,"internal-error")}})}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};function Hn(n,e){return g(this,null,function*(){return er(n,"POST","/v1/accounts:signInWithIdp",Bt(n,e))})}var Z_="http://localhost",_s=class n extends Yn{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Be("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r}=t,s=jr(t,["providerId","signInMethod"]);if(!i||!r)return null;let a=new n(i,r);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){let t=this.buildRequest();return Hn(e,t)}_linkToIdToken(e,t){let i=this.buildRequest();return i.idToken=t,Hn(e,i)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,Hn(e,t)}buildRequest(){let e={requestUri:Z_,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Bn(t)}return e}};function ey(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function ty(n){let e=qn($n(n)).link,t=e?qn($n(e)).deep_link_id:null,i=qn($n(n)).deep_link_id;return(i?qn($n(i)).link:null)||i||t||e||n}var ys=class n{constructor(e){var t,i,r,s,a,c;let l=qn($n(e)),d=(t=l.apiKey)!==null&&t!==void 0?t:null,p=(i=l.oobCode)!==null&&i!==void 0?i:null,I=ey((r=l.mode)!==null&&r!==void 0?r:null);F(d&&p&&I,"argument-error"),this.apiKey=d,this.operation=I,this.code=p,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(a=l.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(c=l.tenantId)!==null&&c!==void 0?c:null}static parseLink(e){let t=ty(e);try{return new n(t)}catch{return null}}};var ef=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,i){return Ji._fromEmailAndPassword(t,i)}static credentialWithLink(t,i){let r=ys.parseLink(i);return F(r,"argument-error"),Ji._fromEmailAndCode(t,r.code,r.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),Xi=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var Is=class extends Xi{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var ny=(()=>{class n extends Is{constructor(){super("google.com"),this.addScope("profile")}static credential(t,i){return _s._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:i})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:i,oauthAccessToken:r}=t;if(!i&&!r)return null;try{return n.credential(i,r)}catch{return null}}}n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com";return n})();function iy(n,e){return g(this,null,function*(){return er(n,"POST","/v1/accounts:signUp",Bt(n,e))})}var Jn=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,i,r=!1){return g(this,null,function*(){let s=yield Qn._fromIdTokenResponse(e,i,r),a=Sd(i);return new n({user:s,providerId:a,_tokenResponse:i,operationType:t})})}static _forOperation(e,t,i){return g(this,null,function*(){yield e._updateTokensIfNecessary(i,!0);let r=Sd(i);return new n({user:e,providerId:r,_tokenResponse:i,operationType:t})})}};function Sd(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var Oa=class n extends Le{constructor(e,t,i,r){var s;super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new n(e,t,i,r)}};function tf(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Oa._fromErrorAndOperation(n,s,e,i):s})}function ry(n,e,t=!1){return g(this,null,function*(){let i=yield Kn(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return Jn._forOperation(n,"link",i)})}function sy(n,e,t=!1){return g(this,null,function*(){let{auth:i}=n;if(Ue(i.app))return Promise.reject(gt(i));let r="reauthenticate";try{let s=yield Kn(n,tf(i,r,e,n),t);F(s.idToken,i,"internal-error");let a=Wa(s.idToken);F(a,i,"internal-error");let{sub:c}=a;return F(n.uid===c,i,"user-mismatch"),Jn._forOperation(n,r,s)}catch(s){throw s?.code==="auth/user-not-found"&&Be(i,"user-mismatch"),s}})}function nf(n,e,t=!1){return g(this,null,function*(){if(Ue(n.app))return Promise.reject(gt(n));let i="signIn",r=yield tf(n,i,e),s=yield Jn._fromIdTokenResponse(n,i,r);return t||(yield n._updateCurrentUser(s.user)),s})}function Ka(n,e){return g(this,null,function*(){return nf(qt(n),e)})}function rf(n){return g(this,null,function*(){let e=qt(n);e._getPasswordPolicyInternal()&&(yield e._updatePasswordPolicy())})}function Qa(n,e,t){return g(this,null,function*(){if(Ue(n.app))return Promise.reject(gt(n));let i=qt(n),a=yield Na(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",iy).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&rf(n),l}),c=yield Jn._fromIdTokenResponse(i,"signIn",a);return yield i._updateCurrentUser(c.user),c})}function Ya(n,e,t){return Ue(n.app)?Promise.reject(gt(n)):Ka(me(n),ef.credential(e,t)).catch(i=>g(this,null,function*(){throw i.code==="auth/password-does-not-meet-requirements"&&rf(n),i}))}function oy(n,e){return g(this,null,function*(){return yt(n,"POST","/v1/accounts:update",e)})}function Ja(i,r){return g(this,arguments,function*(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;let s=me(n),c={idToken:yield s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},l=yield Kn(s,oy(s.auth,c));s.displayName=l.displayName||null,s.photoURL=l.photoUrl||null;let d=s.providerData.find(({providerId:p})=>p==="password");d&&(d.displayName=s.displayName,d.photoURL=s.photoURL),yield s._updateTokensIfNecessary(l)})}function Xa(n,e,t,i){return me(n).onIdTokenChanged(e,t,i)}function Za(n,e,t){return me(n).beforeAuthStateChanged(e,t)}function ec(n,e,t,i){return me(n).onAuthStateChanged(e,t,i)}function tc(n){return me(n).signOut()}var vs="__sak";var Es=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(vs,"1"),this.storage.removeItem(vs),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var ay=1e3,cy=10,uy=(()=>{class n extends Es{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,i)=>this.onStorageEvent(t,i),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Qd(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let i of Object.keys(this.listeners)){let r=this.storage.getItem(i),s=this.localCache[i];r!==s&&t(i,s,r)}}onStorageEvent(t,i=!1){if(!t.key){this.forAllChangedKeys((c,l,d)=>{this.notifyListeners(c,d)});return}let r=t.key;i?this.detachListener():this.stopPolling();let s=()=>{let c=this.storage.getItem(r);!i&&this.localCache[r]===c||this.notifyListeners(r,c)},a=this.storage.getItem(r);F_()&&a!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,cy):s()}notifyListeners(t,i){this.localCache[t]=i;let r=this.listeners[t];if(r)for(let s of Array.from(r))s(i&&JSON.parse(i))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,i,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:i,newValue:r}),!0)})},ay)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,i){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(i)}_removeListener(t,i){this.listeners[t]&&(this.listeners[t].delete(i),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,i){return g(this,null,function*(){yield Pt(n.prototype,this,"_set").call(this,t,i),this.localCache[t]=JSON.stringify(i)})}_get(t){return g(this,null,function*(){let i=yield Pt(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(i),i})}_remove(t){return g(this,null,function*(){yield Pt(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),sf=uy;var ly=(()=>{class n extends Es{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,i){}_removeListener(t,i){}}return n.type="SESSION",n})(),nc=ly;function hy(n){return Promise.all(n.map(e=>g(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var dy=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let i=this.receivers.find(s=>s.isListeningto(t));if(i)return i;let r=new n(t);return this.receivers.push(r),r}isListeningto(t){return this.eventTarget===t}handleEvent(t){return g(this,null,function*(){let i=t,{eventId:r,eventType:s,data:a}=i.data,c=this.handlersMap[s];if(!c?.size)return;i.ports[0].postMessage({status:"ack",eventId:r,eventType:s});let l=Array.from(c).map(p=>g(this,null,function*(){return p(i.origin,a)})),d=yield hy(l);i.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:d})})}_subscribe(t,i){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(i)}_unsubscribe(t,i){this.handlersMap[t]&&i&&this.handlersMap[t].delete(i),(!i||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function ic(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}var ka=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,i=50){return g(this,null,function*(){let r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,a;return new Promise((c,l)=>{let d=ic("",20);r.port1.start();let p=setTimeout(()=>{l(new Error("unsupported_event"))},i);a={messageChannel:r,onMessage(I){let b=I;if(b.data.eventId===d)switch(b.data.status){case"ack":clearTimeout(p),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),c(b.data.response);break;default:clearTimeout(p),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),r.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[r.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})})}};function Je(){return window}function fy(n){Je().location.href=n}function of(){return typeof Je().WorkerGlobalScope<"u"&&typeof Je().importScripts=="function"}function py(){return g(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function my(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function gy(){return of()?self:null}var af="firebaseLocalStorageDb",_y=1,Ts="firebaseLocalStorage",cf="fbase_key",gn=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function Ss(n,e){return n.transaction([Ts],e?"readwrite":"readonly").objectStore(Ts)}function yy(){let n=indexedDB.deleteDatabase(af);return new gn(n).toPromise()}function xa(){let n=indexedDB.open(af,_y);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let i=n.result;try{i.createObjectStore(Ts,{keyPath:cf})}catch(r){t(r)}}),n.addEventListener("success",()=>g(this,null,function*(){let i=n.result;i.objectStoreNames.contains(Ts)?e(i):(i.close(),yield yy(),e(yield xa()))}))})}function Rd(n,e,t){return g(this,null,function*(){let i=Ss(n,!0).put({[cf]:e,value:t});return new gn(i).toPromise()})}function Iy(n,e){return g(this,null,function*(){let t=Ss(n,!1).get(e),i=yield new gn(t).toPromise();return i===void 0?null:i.value})}function Cd(n,e){let t=Ss(n,!0).delete(e);return new gn(t).toPromise()}var vy=800,Ey=3,Ty=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return g(this,null,function*(){return this.db?this.db:(this.db=yield xa(),this.db)})}_withRetries(t){return g(this,null,function*(){let i=0;for(;;)try{let r=yield this._openDb();return yield t(r)}catch(r){if(i++>Ey)throw r;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return g(this,null,function*(){return of()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return g(this,null,function*(){this.receiver=dy._getInstance(gy()),this.receiver._subscribe("keyChanged",(t,i)=>g(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(i.key)}})),this.receiver._subscribe("ping",(t,i)=>g(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return g(this,null,function*(){var t,i;if(this.activeServiceWorker=yield py(),!this.activeServiceWorker)return;this.sender=new ka(this.activeServiceWorker);let r=yield this.sender._send("ping",{},800);r&&!((t=r[0])===null||t===void 0)&&t.fulfilled&&!((i=r[0])===null||i===void 0)&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return g(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||my()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return g(this,null,function*(){try{if(!indexedDB)return!1;let t=yield xa();return yield Rd(t,vs,"1"),yield Cd(t,vs),!0}catch{}return!1})}_withPendingWrite(t){return g(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,i){return g(this,null,function*(){return this._withPendingWrite(()=>g(this,null,function*(){return yield this._withRetries(r=>Rd(r,t,i)),this.localCache[t]=i,this.notifyServiceWorker(t)}))})}_get(t){return g(this,null,function*(){let i=yield this._withRetries(r=>Iy(r,t));return this.localCache[t]=i,i})}_remove(t){return g(this,null,function*(){return this._withPendingWrite(()=>g(this,null,function*(){return yield this._withRetries(i=>Cd(i,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return g(this,null,function*(){let t=yield this._withRetries(s=>{let a=Ss(s,!1).getAll();return new gn(a).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let i=[],r=new Set;if(t.length!==0)for(let{fbase_key:s,value:a}of t)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),i.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),i.push(s));return i})}notifyListeners(t,i){this.localCache[t]=i;let r=this.listeners[t];if(r)for(let s of Array.from(r))s(i)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>g(this,null,function*(){return this._poll()}),vy)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,i){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(i)}_removeListener(t,i){this.listeners[t]&&(this.listeners[t].delete(i),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),uf=Ty;var EA=Xd("rcb"),TA=new mn(3e4,6e4);function lf(n,e){return e?mt(e):(F(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var Zi=class extends Yn{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Hn(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Hn(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Hn(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function wy(n){return nf(n.auth,new Zi(n),n.bypassAuthState)}function Ay(n){let{auth:e,user:t}=n;return F(t,e,"internal-error"),sy(t,new Zi(n),n.bypassAuthState)}function by(n){return g(this,null,function*(){let{auth:e,user:t}=n;return F(t,e,"internal-error"),ry(t,new Zi(n),n.bypassAuthState)})}var ws=class{constructor(e,t,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>g(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}}))}onAuthEvent(e){return g(this,null,function*(){let{urlResponse:t,sessionId:i,postBody:r,tenantId:s,error:a,type:c}=e;if(a){this.reject(a);return}let l={auth:this.auth,requestUri:t,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(c)(l))}catch(d){this.reject(d)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return wy;case"linkViaPopup":case"linkViaRedirect":return by;case"reauthViaPopup":case"reauthViaRedirect":return Ay;default:Be(this.auth,"internal-error")}}resolve(e){_t(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){_t(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var Sy=new mn(2e3,1e4);function rc(n,e,t){return g(this,null,function*(){if(Ue(n.app))return Promise.reject(ze(n,"operation-not-supported-in-this-environment"));let i=qt(n);w_(n,e,Xi);let r=lf(i,t);return new Ry(i,"signInViaPopup",e,r).executeNotNull()})}var Ry=(()=>{class n extends ws{constructor(t,i,r,s,a){super(t,i,s,a),this.provider=r,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}executeNotNull(){return g(this,null,function*(){let t=yield this.execute();return F(t,this.auth,"internal-error"),t})}onExecution(){return g(this,null,function*(){_t(this.filter.length===1,"Popup operations only handle one event");let t=ic();this.authWindow=yield this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(i=>{this.reject(i)}),this.resolver._isIframeWebStorageSupported(this.auth,i=>{i||this.reject(ze(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()})}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(ze(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){let t=()=>{var i,r;if(!((r=(i=this.authWindow)===null||i===void 0?void 0:i.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ze(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,Sy.get())};t()}}n.currentPopupAction=null;return n})(),Cy="pendingRedirect",ls=new Map,La=class n extends ws{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}execute(){return g(this,null,function*(){let e=ls.get(this.auth._key());if(!e){try{let i=(yield Py(this.resolver,this.auth))?yield Pt(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}ls.set(this.auth._key(),e)}return this.bypassAuthState||ls.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return g(this,null,function*(){if(e.type==="signInViaRedirect")return Pt(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,Pt(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return g(this,null,function*(){})}cleanUp(){}};function Py(n,e){return g(this,null,function*(){let t=Oy(e),i=Ny(n);if(!(yield i._isAvailable()))return!1;let r=(yield i._get(t))==="true";return yield i._remove(t),r})}function Dy(n,e){ls.set(n._key(),e)}function Ny(n){return mt(n._redirectPersistence)}function Oy(n){return us(Cy,n.config.apiKey,n.name)}function ky(n,e,t=!1){return g(this,null,function*(){if(Ue(n.app))return Promise.reject(gt(n));let i=qt(n),r=lf(i,e),a=yield new La(i,r,t).execute();return a&&!t&&(delete a.user._redirectEventId,yield i._persistUserIfCurrent(a.user),yield i._setRedirectUser(null,e)),a})}var xy=10*60*1e3,Ma=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Ly(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!hf(e)){let r=((i=e.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";t.onError(ze(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=xy&&this.cachedEventUids.clear(),this.cachedEventUids.has(Pd(e))}saveEventToCache(e){this.cachedEventUids.add(Pd(e)),this.lastProcessedEventTime=Date.now()}};function Pd(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function hf({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function Ly(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return hf(n);default:return!1}}function My(t){return g(this,arguments,function*(n,e={}){return yt(n,"GET","/v1/projects",e)})}var Vy=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Fy=/^https?/;function Uy(n){return g(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield My(n);for(let t of e)try{if(By(t))return}catch{}Be(n,"unauthorized-domain")})}function By(n){let e=Ta(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){let a=new URL(n);return a.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===i}if(!Fy.test(t))return!1;if(Vy.test(n))return i===n;let r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}var qy=new mn(3e4,6e4);function Dd(){let n=Je().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function $y(n){return new Promise((e,t)=>{var i,r,s;function a(){Dd(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Dd(),t(ze(n,"network-request-failed"))},timeout:qy.get()})}if(!((r=(i=Je().gapi)===null||i===void 0?void 0:i.iframes)===null||r===void 0)&&r.Iframe)e(gapi.iframes.getContext());else if(!((s=Je().gapi)===null||s===void 0)&&s.load)a();else{let c=Xd("iframefcb");return Je()[c]=()=>{gapi.load?a():t(ze(n,"network-request-failed"))},Jd(`${W_()}?onload=${c}`).catch(l=>t(l))}}).catch(e=>{throw hs=null,e})}var hs=null;function Wy(n){return hs=hs||$y(n),hs}var zy=new mn(5e3,15e3),Gy="__/auth/iframe",jy="emulator/auth/iframe",Hy={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Ky=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Qy(n){let e=n.config;F(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?qa(e,jy):`https://${n.config.authDomain}/${Gy}`,i={apiKey:e.apiKey,appName:n.name,v:Vt},r=Ky.get(n.config.apiHost);r&&(i.eid=r);let s=n._getFrameworks();return s.length&&(i.fw=s.join(",")),`${t}?${Bn(i).slice(1)}`}function Yy(n){return g(this,null,function*(){let e=yield Wy(n),t=Je().gapi;return F(t,n,"internal-error"),e.open({where:document.body,url:Qy(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Hy,dontclear:!0},i=>new Promise((r,s)=>g(this,null,function*(){yield i.restyle({setHideOnLeave:!1});let a=ze(n,"network-request-failed"),c=Je().setTimeout(()=>{s(a)},zy.get());function l(){Je().clearTimeout(c),r(i)}i.ping(l).then(l,()=>{s(a)})})))})}var Jy={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Xy=500,Zy=600,eI="_blank",tI="http://localhost",As=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function nI(n,e,t,i=Xy,r=Zy){let s=Math.max((window.screen.availHeight-r)/2,0).toString(),a=Math.max((window.screen.availWidth-i)/2,0).toString(),c="",l=Object.assign(Object.assign({},Jy),{width:i.toString(),height:r.toString(),top:s,left:a}),d=pe().toLowerCase();t&&(c=zd(d)?eI:t),$d(d)&&(e=e||tI,l.scrollbars="yes");let p=Object.entries(l).reduce((b,[R,D])=>`${b}${R}=${D},`,"");if(V_(d)&&c!=="_self")return iI(e||"",c),new As(null);let I=window.open(e||"",c,p);F(I,n,"popup-blocked");try{I.focus()}catch{}return new As(I)}function iI(n,e){let t=document.createElement("a");t.href=n,t.target=e;let i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}var rI="__/auth/handler",sI="emulator/auth/handler",oI=encodeURIComponent("fac");function Nd(n,e,t,i,r,s){return g(this,null,function*(){F(n.config.authDomain,n,"auth-domain-config-required"),F(n.config.apiKey,n,"invalid-api-key");let a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Vt,eventId:r};if(e instanceof Xi){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",id(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(let[p,I]of Object.entries(s||{}))a[p]=I}if(e instanceof Is){let p=e.getScopes().filter(I=>I!=="");p.length>0&&(a.scopes=p.join(","))}n.tenantId&&(a.tid=n.tenantId);let c=a;for(let p of Object.keys(c))c[p]===void 0&&delete c[p];let l=yield n._getAppCheckToken(),d=l?`#${oI}=${encodeURIComponent(l)}`:"";return`${aI(n)}?${Bn(c).slice(1)}${d}`})}function aI({config:n}){return n.emulator?qa(n,sI):`https://${n.authDomain}/${rI}`}var Ea="webStorageSupport",Va=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=nc,this._completeRedirectFn=ky,this._overrideRedirectResult=Dy}_openPopup(e,t,i,r){return g(this,null,function*(){var s;_t((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let a=yield Nd(e,t,i,Ta(),r);return nI(e,a,ic())})}_openRedirect(e,t,i,r){return g(this,null,function*(){yield this._originValidation(e);let s=yield Nd(e,t,i,Ta(),r);return fy(s),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(_t(s,"If manager is not set, promise should be"),s)}let i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}initAndGetManager(e){return g(this,null,function*(){let t=yield Yy(e),i=new Ma(e);return t.register("authEvent",r=>(F(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ea,{type:Ea},r=>{var s;let a=(s=r?.[0])===null||s===void 0?void 0:s[Ea];a!==void 0&&t(!!a),Be(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Uy(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Qd()||Wd()||Ga()}},df=Va;var Od="@firebase/auth",kd="1.7.9";var Fa=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return g(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){F(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function cI(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function uI(n){Mt(new Fe("auth",(e,{options:t})=>{let i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=i.options;F(a&&!a.includes(":"),"invalid-api-key",{appName:i.name});let l={apiKey:a,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Yd(n)},d=new Pa(i,r,s,l);return j_(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),Mt(new Fe("auth-internal",e=>{let t=qt(e.getProvider("auth").getImmediate());return(i=>new Fa(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),fe(Od,kd,cI(n)),fe(Od,kd,"esm2017")}var lI=5*60,hI=ta("authIdTokenMaxAge")||lI,xd=null,dI=n=>e=>g(void 0,null,function*(){let t=e&&(yield e.getIdTokenResult()),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>hI)return;let r=t?.token;xd!==r&&(xd=r,yield fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))});function sc(n=Wn()){let e=ji(n,"auth");if(e.isInitialized())return e.getImmediate();let t=ja(n,{popupRedirectResolver:df,persistence:[uf,sf,nc]}),i=ta("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(i,location.origin);if(location.origin===s.origin){let a=dI(s.toString());Za(t,a,()=>a(t.currentUser)),Xa(t,c=>a(c))}}let r=Zo("auth");return r&&Ha(t,`http://${r}`),t}function fI(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}q_({loadJS(n){return new Promise((e,t)=>{let i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{let s=ze("internal-error");s.customData=r,t(s)},i.type="text/javascript",i.charset="UTF-8",fI().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});uI("Browser");var ff="auth",_n=class{constructor(e){return e}},tr=class{constructor(){return Hi(ff)}};var oc=new Ln("angularfire2.auth-instances");function ev(n,e){let t=ss(ff,n,e);return t&&new _n(t)}function tv(n){return(e,t)=>{let i=e.runOutsideAngular(()=>n(t));return new _n(i)}}var nv={provide:tr,deps:[[new Ve,oc]]},iv={provide:_n,useFactory:ev,deps:[[new Ve,oc],ft]};function ib(n,...e){return fe("angularfire",fn.full,"auth"),Mn([iv,nv,{provide:oc,useFactory:tv(n),multi:!0,deps:[Ke,Vn,jn,pn,[new Ve,Gn],...e]}])}var rb=ge(Qa,!0);var sb=ge(sc,!0);var ob=ge(ec,!0);var ab=ge(Ya,!0);var cb=ge(rc,!0);var ub=ge(tc,!0);var lb=ge(Ja,!0);var ve={apiBaseUrl:"https://api.themoviedb.org/3",apiKey:"cf0314e5a3517d9563326a898c21a65f",accountId:"21363106",readAccesToken:"eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiJjZjAzMTRlNWEzNTE3ZDk1NjMzMjZhODk4YzIxYTY1ZiIsIm5iZiI6MTcyMTkzNjQwMy41NzkzMjEsInN1YiI6IjY2ODU0ZWMwYzZkMzM5ZTM4MTFiY2Q3NSIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.Zki5f6K3TBwi9xCPTbltJ3WmozgbS7R4LfVPIIG6nCY"},db={apiKey:"AIzaSyBsOncQVHZV86okveJU8nSNuv18qEUEAB4",authDomain:"my-project-744e0.firebaseapp.com",projectId:"my-project-744e0",storageBucket:"my-project-744e0.appspot.com",messagingSenderId:"579036472837",appId:"1:579036472837:web:6f6aa3926bc45ca4185e6c",measurementId:"G-E2C0JX6K3P"};var yb=(()=>{let e=class e{constructor(i){this.httpClient=i,this.sessionId=""}getParams(){return{params:new kt().set("api_key",ve.apiKey)}}setSessionId(i){this.sessionId=i}getMoviesList(i,r=1){let s=new kt().set("page",r);return this.httpClient.get(`${ve.apiBaseUrl}/movie/${i}?api_key=${ve.apiKey}`,{params:s})}getMovieDetailsPage(i){return this.httpClient.get(`${ve.apiBaseUrl}/movie/${i}`,this.getParams())}getCredits(i){let r=new kt().set("language","en-US"),s=new $i({accept:"application/json",Authorization:`Bearer ${ve.readAccesToken}`});return this.httpClient.get(`${ve.apiBaseUrl}/movie/${i}/credits`,{params:r,headers:s})}getMovieTrailer(i){let r=new kt().set("language","en-US"),s=new $i({accept:"application/json",Authorization:`Bearer ${ve.readAccesToken}`});return this.httpClient.get(`${ve.apiBaseUrl}/movie/${i}/videos`,{params:r,headers:s})}setMovieToList(i,r,s){let a={media_type:"movie",media_id:r,[i]:s};if(this.sessionId!=null){let c=new kt().set("session_id",this.sessionId),l=new $i({accept:"application/json","content-type":"application/json",Authorization:`Bearer ${ve.readAccesToken}`});return this.httpClient.post(`${ve.apiBaseUrl}/account/${ve.accountId}/${i}`,a,{params:c,headers:l})}return bh([])}getUserMovieList(i){let r=new kt().set("language","en-US").set("page","1").set("session_id",this.sessionId).set("sort_by","created_at.asc");return this.httpClient.get(`${ve.apiBaseUrl}/account/${ve.accountId}/${i}/movies?api_key=${ve.apiKey}`,{params:r})}getSearchMovie(i){let r=new $i({accept:"application/json",Authorization:`Bearer ${ve.readAccesToken}`}),s=new kt().set("query",i).set("language","en-US");return this.httpClient.get(`${ve.apiBaseUrl}/search/movie`,{headers:r,params:s})}};e.\u0275fac=function(r){return new(r||e)(en(zh))},e.\u0275prov=ct({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var pf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},mf={};var $t,ac;(function(){var n;function e(E,m){function y(){}y.prototype=m.prototype,E.D=m.prototype,E.prototype=new y,E.prototype.constructor=E,E.C=function(v,T,A){for(var _=Array(arguments.length-2),st=2;st<arguments.length;st++)_[st-2]=arguments[st];return m.prototype[T].apply(v,_)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(E,m,y){y||(y=0);var v=Array(16);if(typeof m=="string")for(var T=0;16>T;++T)v[T]=m.charCodeAt(y++)|m.charCodeAt(y++)<<8|m.charCodeAt(y++)<<16|m.charCodeAt(y++)<<24;else for(T=0;16>T;++T)v[T]=m[y++]|m[y++]<<8|m[y++]<<16|m[y++]<<24;m=E.g[0],y=E.g[1],T=E.g[2];var A=E.g[3],_=m+(A^y&(T^A))+v[0]+3614090360&4294967295;m=y+(_<<7&4294967295|_>>>25),_=A+(T^m&(y^T))+v[1]+3905402710&4294967295,A=m+(_<<12&4294967295|_>>>20),_=T+(y^A&(m^y))+v[2]+606105819&4294967295,T=A+(_<<17&4294967295|_>>>15),_=y+(m^T&(A^m))+v[3]+3250441966&4294967295,y=T+(_<<22&4294967295|_>>>10),_=m+(A^y&(T^A))+v[4]+4118548399&4294967295,m=y+(_<<7&4294967295|_>>>25),_=A+(T^m&(y^T))+v[5]+1200080426&4294967295,A=m+(_<<12&4294967295|_>>>20),_=T+(y^A&(m^y))+v[6]+2821735955&4294967295,T=A+(_<<17&4294967295|_>>>15),_=y+(m^T&(A^m))+v[7]+4249261313&4294967295,y=T+(_<<22&4294967295|_>>>10),_=m+(A^y&(T^A))+v[8]+1770035416&4294967295,m=y+(_<<7&4294967295|_>>>25),_=A+(T^m&(y^T))+v[9]+2336552879&4294967295,A=m+(_<<12&4294967295|_>>>20),_=T+(y^A&(m^y))+v[10]+4294925233&4294967295,T=A+(_<<17&4294967295|_>>>15),_=y+(m^T&(A^m))+v[11]+2304563134&4294967295,y=T+(_<<22&4294967295|_>>>10),_=m+(A^y&(T^A))+v[12]+1804603682&4294967295,m=y+(_<<7&4294967295|_>>>25),_=A+(T^m&(y^T))+v[13]+4254626195&4294967295,A=m+(_<<12&4294967295|_>>>20),_=T+(y^A&(m^y))+v[14]+2792965006&4294967295,T=A+(_<<17&4294967295|_>>>15),_=y+(m^T&(A^m))+v[15]+1236535329&4294967295,y=T+(_<<22&4294967295|_>>>10),_=m+(T^A&(y^T))+v[1]+4129170786&4294967295,m=y+(_<<5&4294967295|_>>>27),_=A+(y^T&(m^y))+v[6]+3225465664&4294967295,A=m+(_<<9&4294967295|_>>>23),_=T+(m^y&(A^m))+v[11]+643717713&4294967295,T=A+(_<<14&4294967295|_>>>18),_=y+(A^m&(T^A))+v[0]+3921069994&4294967295,y=T+(_<<20&4294967295|_>>>12),_=m+(T^A&(y^T))+v[5]+3593408605&4294967295,m=y+(_<<5&4294967295|_>>>27),_=A+(y^T&(m^y))+v[10]+38016083&4294967295,A=m+(_<<9&4294967295|_>>>23),_=T+(m^y&(A^m))+v[15]+3634488961&4294967295,T=A+(_<<14&4294967295|_>>>18),_=y+(A^m&(T^A))+v[4]+3889429448&4294967295,y=T+(_<<20&4294967295|_>>>12),_=m+(T^A&(y^T))+v[9]+568446438&4294967295,m=y+(_<<5&4294967295|_>>>27),_=A+(y^T&(m^y))+v[14]+3275163606&4294967295,A=m+(_<<9&4294967295|_>>>23),_=T+(m^y&(A^m))+v[3]+4107603335&4294967295,T=A+(_<<14&4294967295|_>>>18),_=y+(A^m&(T^A))+v[8]+1163531501&4294967295,y=T+(_<<20&4294967295|_>>>12),_=m+(T^A&(y^T))+v[13]+2850285829&4294967295,m=y+(_<<5&4294967295|_>>>27),_=A+(y^T&(m^y))+v[2]+4243563512&4294967295,A=m+(_<<9&4294967295|_>>>23),_=T+(m^y&(A^m))+v[7]+1735328473&4294967295,T=A+(_<<14&4294967295|_>>>18),_=y+(A^m&(T^A))+v[12]+2368359562&4294967295,y=T+(_<<20&4294967295|_>>>12),_=m+(y^T^A)+v[5]+4294588738&4294967295,m=y+(_<<4&4294967295|_>>>28),_=A+(m^y^T)+v[8]+2272392833&4294967295,A=m+(_<<11&4294967295|_>>>21),_=T+(A^m^y)+v[11]+1839030562&4294967295,T=A+(_<<16&4294967295|_>>>16),_=y+(T^A^m)+v[14]+4259657740&4294967295,y=T+(_<<23&4294967295|_>>>9),_=m+(y^T^A)+v[1]+2763975236&4294967295,m=y+(_<<4&4294967295|_>>>28),_=A+(m^y^T)+v[4]+1272893353&4294967295,A=m+(_<<11&4294967295|_>>>21),_=T+(A^m^y)+v[7]+4139469664&4294967295,T=A+(_<<16&4294967295|_>>>16),_=y+(T^A^m)+v[10]+3200236656&4294967295,y=T+(_<<23&4294967295|_>>>9),_=m+(y^T^A)+v[13]+681279174&4294967295,m=y+(_<<4&4294967295|_>>>28),_=A+(m^y^T)+v[0]+3936430074&4294967295,A=m+(_<<11&4294967295|_>>>21),_=T+(A^m^y)+v[3]+3572445317&4294967295,T=A+(_<<16&4294967295|_>>>16),_=y+(T^A^m)+v[6]+76029189&4294967295,y=T+(_<<23&4294967295|_>>>9),_=m+(y^T^A)+v[9]+3654602809&4294967295,m=y+(_<<4&4294967295|_>>>28),_=A+(m^y^T)+v[12]+3873151461&4294967295,A=m+(_<<11&4294967295|_>>>21),_=T+(A^m^y)+v[15]+530742520&4294967295,T=A+(_<<16&4294967295|_>>>16),_=y+(T^A^m)+v[2]+3299628645&4294967295,y=T+(_<<23&4294967295|_>>>9),_=m+(T^(y|~A))+v[0]+4096336452&4294967295,m=y+(_<<6&4294967295|_>>>26),_=A+(y^(m|~T))+v[7]+1126891415&4294967295,A=m+(_<<10&4294967295|_>>>22),_=T+(m^(A|~y))+v[14]+2878612391&4294967295,T=A+(_<<15&4294967295|_>>>17),_=y+(A^(T|~m))+v[5]+4237533241&4294967295,y=T+(_<<21&4294967295|_>>>11),_=m+(T^(y|~A))+v[12]+1700485571&4294967295,m=y+(_<<6&4294967295|_>>>26),_=A+(y^(m|~T))+v[3]+2399980690&4294967295,A=m+(_<<10&4294967295|_>>>22),_=T+(m^(A|~y))+v[10]+4293915773&4294967295,T=A+(_<<15&4294967295|_>>>17),_=y+(A^(T|~m))+v[1]+2240044497&4294967295,y=T+(_<<21&4294967295|_>>>11),_=m+(T^(y|~A))+v[8]+1873313359&4294967295,m=y+(_<<6&4294967295|_>>>26),_=A+(y^(m|~T))+v[15]+4264355552&4294967295,A=m+(_<<10&4294967295|_>>>22),_=T+(m^(A|~y))+v[6]+2734768916&4294967295,T=A+(_<<15&4294967295|_>>>17),_=y+(A^(T|~m))+v[13]+1309151649&4294967295,y=T+(_<<21&4294967295|_>>>11),_=m+(T^(y|~A))+v[4]+4149444226&4294967295,m=y+(_<<6&4294967295|_>>>26),_=A+(y^(m|~T))+v[11]+3174756917&4294967295,A=m+(_<<10&4294967295|_>>>22),_=T+(m^(A|~y))+v[2]+718787259&4294967295,T=A+(_<<15&4294967295|_>>>17),_=y+(A^(T|~m))+v[9]+3951481745&4294967295,E.g[0]=E.g[0]+m&4294967295,E.g[1]=E.g[1]+(T+(_<<21&4294967295|_>>>11))&4294967295,E.g[2]=E.g[2]+T&4294967295,E.g[3]=E.g[3]+A&4294967295}i.prototype.u=function(E,m){m===void 0&&(m=E.length);for(var y=m-this.blockSize,v=this.B,T=this.h,A=0;A<m;){if(T==0)for(;A<=y;)r(this,E,A),A+=this.blockSize;if(typeof E=="string"){for(;A<m;)if(v[T++]=E.charCodeAt(A++),T==this.blockSize){r(this,v),T=0;break}}else for(;A<m;)if(v[T++]=E[A++],T==this.blockSize){r(this,v),T=0;break}}this.h=T,this.o+=m},i.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var m=1;m<E.length-8;++m)E[m]=0;var y=8*this.o;for(m=E.length-8;m<E.length;++m)E[m]=y&255,y/=256;for(this.u(E),E=Array(16),m=y=0;4>m;++m)for(var v=0;32>v;v+=8)E[y++]=this.g[m]>>>v&255;return E};function s(E,m){var y=c;return Object.prototype.hasOwnProperty.call(y,E)?y[E]:y[E]=m(E)}function a(E,m){this.h=m;for(var y=[],v=!0,T=E.length-1;0<=T;T--){var A=E[T]|0;v&&A==m||(y[T]=A,v=!1)}this.g=y}var c={};function l(E){return-128<=E&&128>E?s(E,function(m){return new a([m|0],0>m?-1:0)}):new a([E|0],0>E?-1:0)}function d(E){if(isNaN(E)||!isFinite(E))return I;if(0>E)return O(d(-E));for(var m=[],y=1,v=0;E>=y;v++)m[v]=E/y|0,y*=4294967296;return new a(m,0)}function p(E,m){if(E.length==0)throw Error("number format error: empty string");if(m=m||10,2>m||36<m)throw Error("radix out of range: "+m);if(E.charAt(0)=="-")return O(p(E.substring(1),m));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var y=d(Math.pow(m,8)),v=I,T=0;T<E.length;T+=8){var A=Math.min(8,E.length-T),_=parseInt(E.substring(T,T+A),m);8>A?(A=d(Math.pow(m,A)),v=v.j(A).add(d(_))):(v=v.j(y),v=v.add(d(_)))}return v}var I=l(0),b=l(1),R=l(16777216);n=a.prototype,n.m=function(){if(k(this))return-O(this).m();for(var E=0,m=1,y=0;y<this.g.length;y++){var v=this.i(y);E+=(0<=v?v:4294967296+v)*m,m*=4294967296}return E},n.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(D(this))return"0";if(k(this))return"-"+O(this).toString(E);for(var m=d(Math.pow(E,6)),y=this,v="";;){var T=te(y,m).g;y=z(y,T.j(m));var A=((0<y.g.length?y.g[0]:y.h)>>>0).toString(E);if(y=T,D(y))return A+v;for(;6>A.length;)A="0"+A;v=A+v}},n.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function D(E){if(E.h!=0)return!1;for(var m=0;m<E.g.length;m++)if(E.g[m]!=0)return!1;return!0}function k(E){return E.h==-1}n.l=function(E){return E=z(this,E),k(E)?-1:D(E)?0:1};function O(E){for(var m=E.g.length,y=[],v=0;v<m;v++)y[v]=~E.g[v];return new a(y,~E.h).add(b)}n.abs=function(){return k(this)?O(this):this},n.add=function(E){for(var m=Math.max(this.g.length,E.g.length),y=[],v=0,T=0;T<=m;T++){var A=v+(this.i(T)&65535)+(E.i(T)&65535),_=(A>>>16)+(this.i(T)>>>16)+(E.i(T)>>>16);v=_>>>16,A&=65535,_&=65535,y[T]=_<<16|A}return new a(y,y[y.length-1]&-2147483648?-1:0)};function z(E,m){return E.add(O(m))}n.j=function(E){if(D(this)||D(E))return I;if(k(this))return k(E)?O(this).j(O(E)):O(O(this).j(E));if(k(E))return O(this.j(O(E)));if(0>this.l(R)&&0>E.l(R))return d(this.m()*E.m());for(var m=this.g.length+E.g.length,y=[],v=0;v<2*m;v++)y[v]=0;for(v=0;v<this.g.length;v++)for(var T=0;T<E.g.length;T++){var A=this.i(v)>>>16,_=this.i(v)&65535,st=E.i(T)>>>16,wi=E.i(T)&65535;y[2*v+2*T]+=_*wi,W(y,2*v+2*T),y[2*v+2*T+1]+=A*wi,W(y,2*v+2*T+1),y[2*v+2*T+1]+=_*st,W(y,2*v+2*T+1),y[2*v+2*T+2]+=A*st,W(y,2*v+2*T+2)}for(v=0;v<m;v++)y[v]=y[2*v+1]<<16|y[2*v];for(v=m;v<2*m;v++)y[v]=0;return new a(y,0)};function W(E,m){for(;(E[m]&65535)!=E[m];)E[m+1]+=E[m]>>>16,E[m]&=65535,m++}function H(E,m){this.g=E,this.h=m}function te(E,m){if(D(m))throw Error("division by zero");if(D(E))return new H(I,I);if(k(E))return m=te(O(E),m),new H(O(m.g),O(m.h));if(k(m))return m=te(E,O(m)),new H(O(m.g),m.h);if(30<E.g.length){if(k(E)||k(m))throw Error("slowDivide_ only works with positive integers.");for(var y=b,v=m;0>=v.l(E);)y=De(y),v=De(v);var T=J(y,1),A=J(v,1);for(v=J(v,2),y=J(y,2);!D(v);){var _=A.add(v);0>=_.l(E)&&(T=T.add(y),A=_),v=J(v,1),y=J(y,1)}return m=z(E,T.j(m)),new H(T,m)}for(T=I;0<=E.l(m);){for(y=Math.max(1,Math.floor(E.m()/m.m())),v=Math.ceil(Math.log(y)/Math.LN2),v=48>=v?1:Math.pow(2,v-48),A=d(y),_=A.j(m);k(_)||0<_.l(E);)y-=v,A=d(y),_=A.j(m);D(A)&&(A=b),T=T.add(A),E=z(E,_)}return new H(T,E)}n.A=function(E){return te(this,E).h},n.and=function(E){for(var m=Math.max(this.g.length,E.g.length),y=[],v=0;v<m;v++)y[v]=this.i(v)&E.i(v);return new a(y,this.h&E.h)},n.or=function(E){for(var m=Math.max(this.g.length,E.g.length),y=[],v=0;v<m;v++)y[v]=this.i(v)|E.i(v);return new a(y,this.h|E.h)},n.xor=function(E){for(var m=Math.max(this.g.length,E.g.length),y=[],v=0;v<m;v++)y[v]=this.i(v)^E.i(v);return new a(y,this.h^E.h)};function De(E){for(var m=E.g.length+1,y=[],v=0;v<m;v++)y[v]=E.i(v)<<1|E.i(v-1)>>>31;return new a(y,E.h)}function J(E,m){var y=m>>5;m%=32;for(var v=E.g.length-y,T=[],A=0;A<v;A++)T[A]=0<m?E.i(A+y)>>>m|E.i(A+y+1)<<32-m:E.i(A+y);return new a(T,E.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,ac=mf.Md5=i,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=p,$t=mf.Integer=a}).apply(typeof pf<"u"?pf:typeof self<"u"?self:typeof window<"u"?window:{});var Rs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},It={};var cc,sv,Xn,uc,nr,Cs,lc,hc,dc;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,u,h){return o==Array.prototype||o==Object.prototype||(o[u]=h.value),o};function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof Rs=="object"&&Rs];for(var u=0;u<o.length;++u){var h=o[u];if(h&&h.Math==Math)return h}throw Error("Cannot find global object")}var i=t(this);function r(o,u){if(u)e:{var h=i;o=o.split(".");for(var f=0;f<o.length-1;f++){var w=o[f];if(!(w in h))break e;h=h[w]}o=o[o.length-1],f=h[o],u=u(f),u!=f&&u!=null&&e(h,o,{configurable:!0,writable:!0,value:u})}}function s(o,u){o instanceof String&&(o+="");var h=0,f=!1,w={next:function(){if(!f&&h<o.length){var S=h++;return{value:u(S,o[S]),done:!1}}return f=!0,{done:!0,value:void 0}}};return w[Symbol.iterator]=function(){return w},w}r("Array.prototype.values",function(o){return o||function(){return s(this,function(u,h){return h})}});var a=a||{},c=this||self;function l(o){var u=typeof o;return u=u!="object"?u:o?Array.isArray(o)?"array":u:"null",u=="array"||u=="object"&&typeof o.length=="number"}function d(o){var u=typeof o;return u=="object"&&o!=null||u=="function"}function p(o,u,h){return o.call.apply(o.bind,arguments)}function I(o,u,h){if(!o)throw Error();if(2<arguments.length){var f=Array.prototype.slice.call(arguments,2);return function(){var w=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(w,f),o.apply(u,w)}}return function(){return o.apply(u,arguments)}}function b(o,u,h){return b=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:I,b.apply(null,arguments)}function R(o,u){var h=Array.prototype.slice.call(arguments,1);return function(){var f=h.slice();return f.push.apply(f,arguments),o.apply(this,f)}}function D(o,u){function h(){}h.prototype=u.prototype,o.aa=u.prototype,o.prototype=new h,o.prototype.constructor=o,o.Qb=function(f,w,S){for(var N=Array(arguments.length-2),Z=2;Z<arguments.length;Z++)N[Z-2]=arguments[Z];return u.prototype[w].apply(f,N)}}function k(o){let u=o.length;if(0<u){let h=Array(u);for(let f=0;f<u;f++)h[f]=o[f];return h}return[]}function O(o,u){for(let h=1;h<arguments.length;h++){let f=arguments[h];if(l(f)){let w=o.length||0,S=f.length||0;o.length=w+S;for(let N=0;N<S;N++)o[w+N]=f[N]}else o.push(f)}}class z{constructor(u,h){this.i=u,this.j=h,this.h=0,this.g=null}get(){let u;return 0<this.h?(this.h--,u=this.g,this.g=u.next,u.next=null):u=this.i(),u}}function W(o){return/^[\s\xa0]*$/.test(o)}function H(){var o=c.navigator;return o&&(o=o.userAgent)?o:""}function te(o){return te[" "](o),o}te[" "]=function(){};var De=H().indexOf("Gecko")!=-1&&!(H().toLowerCase().indexOf("webkit")!=-1&&H().indexOf("Edge")==-1)&&!(H().indexOf("Trident")!=-1||H().indexOf("MSIE")!=-1)&&H().indexOf("Edge")==-1;function J(o,u,h){for(let f in o)u.call(h,o[f],f,o)}function E(o,u){for(let h in o)u.call(void 0,o[h],h,o)}function m(o){let u={};for(let h in o)u[h]=o[h];return u}let y="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function v(o,u){let h,f;for(let w=1;w<arguments.length;w++){f=arguments[w];for(h in f)o[h]=f[h];for(let S=0;S<y.length;S++)h=y[S],Object.prototype.hasOwnProperty.call(f,h)&&(o[h]=f[h])}}function T(o){var u=1;o=o.split(":");let h=[];for(;0<u&&o.length;)h.push(o.shift()),u--;return o.length&&h.push(o.join(":")),h}function A(o){c.setTimeout(()=>{throw o},0)}function _(){var o=mo;let u=null;return o.g&&(u=o.g,o.g=o.g.next,o.g||(o.h=null),u.next=null),u}class st{constructor(){this.h=this.g=null}add(u,h){let f=wi.get();f.set(u,h),this.h?this.h.next=f:this.g=f,this.h=f}}var wi=new z(()=>new vm,o=>o.reset());class vm{constructor(){this.next=this.g=this.h=null}set(u,h){this.h=u,this.g=h,this.next=null}reset(){this.next=this.g=this.h=null}}let Ai,bi=!1,mo=new st,El=()=>{let o=c.Promise.resolve(void 0);Ai=()=>{o.then(Em)}};var Em=()=>{for(var o;o=_();){try{o.h.call(o.g)}catch(h){A(h)}var u=wi;u.j(o),100>u.h&&(u.h++,o.next=u.g,u.g=o)}bi=!1};function At(){this.s=this.s,this.C=this.C}At.prototype.s=!1,At.prototype.ma=function(){this.s||(this.s=!0,this.N())},At.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Te(o,u){this.type=o,this.g=this.target=u,this.defaultPrevented=!1}Te.prototype.h=function(){this.defaultPrevented=!0};var Tm=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var o=!1,u=Object.defineProperty({},"passive",{get:function(){o=!0}});try{let h=()=>{};c.addEventListener("test",h,u),c.removeEventListener("test",h,u)}catch{}return o}();function Si(o,u){if(Te.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var h=this.type=o.type,f=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=u,u=o.relatedTarget){if(De){e:{try{te(u.nodeName);var w=!0;break e}catch{}w=!1}w||(u=null)}}else h=="mouseover"?u=o.fromElement:h=="mouseout"&&(u=o.toElement);this.relatedTarget=u,f?(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:wm[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&Si.aa.h.call(this)}}D(Si,Te);var wm={2:"touch",3:"pen",4:"mouse"};Si.prototype.h=function(){Si.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var Ri="closure_listenable_"+(1e6*Math.random()|0),Am=0;function bm(o,u,h,f,w){this.listener=o,this.proxy=null,this.src=u,this.type=h,this.capture=!!f,this.ha=w,this.key=++Am,this.da=this.fa=!1}function Pr(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function Dr(o){this.src=o,this.g={},this.h=0}Dr.prototype.add=function(o,u,h,f,w){var S=o.toString();o=this.g[S],o||(o=this.g[S]=[],this.h++);var N=_o(o,u,f,w);return-1<N?(u=o[N],h||(u.fa=!1)):(u=new bm(u,this.src,S,!!f,w),u.fa=h,o.push(u)),u};function go(o,u){var h=u.type;if(h in o.g){var f=o.g[h],w=Array.prototype.indexOf.call(f,u,void 0),S;(S=0<=w)&&Array.prototype.splice.call(f,w,1),S&&(Pr(u),o.g[h].length==0&&(delete o.g[h],o.h--))}}function _o(o,u,h,f){for(var w=0;w<o.length;++w){var S=o[w];if(!S.da&&S.listener==u&&S.capture==!!h&&S.ha==f)return w}return-1}var yo="closure_lm_"+(1e6*Math.random()|0),Io={};function Tl(o,u,h,f,w){if(f&&f.once)return Al(o,u,h,f,w);if(Array.isArray(u)){for(var S=0;S<u.length;S++)Tl(o,u[S],h,f,w);return null}return h=wo(h),o&&o[Ri]?o.K(u,h,d(f)?!!f.capture:!!f,w):wl(o,u,h,!1,f,w)}function wl(o,u,h,f,w,S){if(!u)throw Error("Invalid event type");var N=d(w)?!!w.capture:!!w,Z=Eo(o);if(Z||(o[yo]=Z=new Dr(o)),h=Z.add(u,h,f,N,S),h.proxy)return h;if(f=Sm(),h.proxy=f,f.src=o,f.listener=h,o.addEventListener)Tm||(w=N),w===void 0&&(w=!1),o.addEventListener(u.toString(),f,w);else if(o.attachEvent)o.attachEvent(Sl(u.toString()),f);else if(o.addListener&&o.removeListener)o.addListener(f);else throw Error("addEventListener and attachEvent are unavailable.");return h}function Sm(){function o(h){return u.call(o.src,o.listener,h)}let u=Rm;return o}function Al(o,u,h,f,w){if(Array.isArray(u)){for(var S=0;S<u.length;S++)Al(o,u[S],h,f,w);return null}return h=wo(h),o&&o[Ri]?o.L(u,h,d(f)?!!f.capture:!!f,w):wl(o,u,h,!0,f,w)}function bl(o,u,h,f,w){if(Array.isArray(u))for(var S=0;S<u.length;S++)bl(o,u[S],h,f,w);else f=d(f)?!!f.capture:!!f,h=wo(h),o&&o[Ri]?(o=o.i,u=String(u).toString(),u in o.g&&(S=o.g[u],h=_o(S,h,f,w),-1<h&&(Pr(S[h]),Array.prototype.splice.call(S,h,1),S.length==0&&(delete o.g[u],o.h--)))):o&&(o=Eo(o))&&(u=o.g[u.toString()],o=-1,u&&(o=_o(u,h,f,w)),(h=-1<o?u[o]:null)&&vo(h))}function vo(o){if(typeof o!="number"&&o&&!o.da){var u=o.src;if(u&&u[Ri])go(u.i,o);else{var h=o.type,f=o.proxy;u.removeEventListener?u.removeEventListener(h,f,o.capture):u.detachEvent?u.detachEvent(Sl(h),f):u.addListener&&u.removeListener&&u.removeListener(f),(h=Eo(u))?(go(h,o),h.h==0&&(h.src=null,u[yo]=null)):Pr(o)}}}function Sl(o){return o in Io?Io[o]:Io[o]="on"+o}function Rm(o,u){if(o.da)o=!0;else{u=new Si(u,this);var h=o.listener,f=o.ha||o.src;o.fa&&vo(o),o=h.call(f,u)}return o}function Eo(o){return o=o[yo],o instanceof Dr?o:null}var To="__closure_events_fn_"+(1e9*Math.random()>>>0);function wo(o){return typeof o=="function"?o:(o[To]||(o[To]=function(u){return o.handleEvent(u)}),o[To])}function we(){At.call(this),this.i=new Dr(this),this.M=this,this.F=null}D(we,At),we.prototype[Ri]=!0,we.prototype.removeEventListener=function(o,u,h,f){bl(this,o,u,h,f)};function Ne(o,u){var h,f=o.F;if(f)for(h=[];f;f=f.F)h.push(f);if(o=o.M,f=u.type||u,typeof u=="string")u=new Te(u,o);else if(u instanceof Te)u.target=u.target||o;else{var w=u;u=new Te(f,o),v(u,w)}if(w=!0,h)for(var S=h.length-1;0<=S;S--){var N=u.g=h[S];w=Nr(N,f,!0,u)&&w}if(N=u.g=o,w=Nr(N,f,!0,u)&&w,w=Nr(N,f,!1,u)&&w,h)for(S=0;S<h.length;S++)N=u.g=h[S],w=Nr(N,f,!1,u)&&w}we.prototype.N=function(){if(we.aa.N.call(this),this.i){var o=this.i,u;for(u in o.g){for(var h=o.g[u],f=0;f<h.length;f++)Pr(h[f]);delete o.g[u],o.h--}}this.F=null},we.prototype.K=function(o,u,h,f){return this.i.add(String(o),u,!1,h,f)},we.prototype.L=function(o,u,h,f){return this.i.add(String(o),u,!0,h,f)};function Nr(o,u,h,f){if(u=o.i.g[String(u)],!u)return!0;u=u.concat();for(var w=!0,S=0;S<u.length;++S){var N=u[S];if(N&&!N.da&&N.capture==h){var Z=N.listener,ye=N.ha||N.src;N.fa&&go(o.i,N),w=Z.call(ye,f)!==!1&&w}}return w&&!f.defaultPrevented}function Rl(o,u,h){if(typeof o=="function")h&&(o=b(o,h));else if(o&&typeof o.handleEvent=="function")o=b(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(u)?-1:c.setTimeout(o,u||0)}function Cl(o){o.g=Rl(()=>{o.g=null,o.i&&(o.i=!1,Cl(o))},o.l);let u=o.h;o.h=null,o.m.apply(null,u)}class Cm extends At{constructor(u,h){super(),this.m=u,this.l=h,this.h=null,this.i=!1,this.g=null}j(u){this.h=arguments,this.g?this.i=!0:Cl(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ci(o){At.call(this),this.h=o,this.g={}}D(Ci,At);var Pl=[];function Dl(o){J(o.g,function(u,h){this.g.hasOwnProperty(h)&&vo(u)},o),o.g={}}Ci.prototype.N=function(){Ci.aa.N.call(this),Dl(this)},Ci.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ao=c.JSON.stringify,Pm=c.JSON.parse,Dm=class{stringify(o){return c.JSON.stringify(o,void 0)}parse(o){return c.JSON.parse(o,void 0)}};function bo(){}bo.prototype.h=null;function Nl(o){return o.h||(o.h=o.i())}function Ol(){}var Pi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function So(){Te.call(this,"d")}D(So,Te);function Ro(){Te.call(this,"c")}D(Ro,Te);var Yt={},kl=null;function Or(){return kl=kl||new we}Yt.La="serverreachability";function xl(o){Te.call(this,Yt.La,o)}D(xl,Te);function Di(o){let u=Or();Ne(u,new xl(u))}Yt.STAT_EVENT="statevent";function Ll(o,u){Te.call(this,Yt.STAT_EVENT,o),this.stat=u}D(Ll,Te);function Oe(o){let u=Or();Ne(u,new Ll(u,o))}Yt.Ma="timingevent";function Ml(o,u){Te.call(this,Yt.Ma,o),this.size=u}D(Ml,Te);function Ni(o,u){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){o()},u)}function Oi(){this.g=!0}Oi.prototype.xa=function(){this.g=!1};function Nm(o,u,h,f,w,S){o.info(function(){if(o.g)if(S)for(var N="",Z=S.split("&"),ye=0;ye<Z.length;ye++){var Q=Z[ye].split("=");if(1<Q.length){var Ae=Q[0];Q=Q[1];var be=Ae.split("_");N=2<=be.length&&be[1]=="type"?N+(Ae+"="+Q+"&"):N+(Ae+"=redacted&")}}else N=null;else N=S;return"XMLHTTP REQ ("+f+") [attempt "+w+"]: "+u+`
`+h+`
`+N})}function Om(o,u,h,f,w,S,N){o.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+w+"]: "+u+`
`+h+`
`+S+" "+N})}function Nn(o,u,h,f){o.info(function(){return"XMLHTTP TEXT ("+u+"): "+xm(o,h)+(f?" "+f:"")})}function km(o,u){o.info(function(){return"TIMEOUT: "+u})}Oi.prototype.info=function(){};function xm(o,u){if(!o.g)return u;if(!u)return null;try{var h=JSON.parse(u);if(h){for(o=0;o<h.length;o++)if(Array.isArray(h[o])){var f=h[o];if(!(2>f.length)){var w=f[1];if(Array.isArray(w)&&!(1>w.length)){var S=w[0];if(S!="noop"&&S!="stop"&&S!="close")for(var N=1;N<w.length;N++)w[N]=""}}}}return Ao(h)}catch{return u}}var kr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Vl={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Co;function xr(){}D(xr,bo),xr.prototype.g=function(){return new XMLHttpRequest},xr.prototype.i=function(){return{}},Co=new xr;function bt(o,u,h,f){this.j=o,this.i=u,this.l=h,this.R=f||1,this.U=new Ci(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Fl}function Fl(){this.i=null,this.g="",this.h=!1}var Ul={},Po={};function Do(o,u,h){o.L=1,o.v=Fr(ot(u)),o.m=h,o.P=!0,Bl(o,null)}function Bl(o,u){o.F=Date.now(),Lr(o),o.A=ot(o.v);var h=o.A,f=o.R;Array.isArray(f)||(f=[String(f)]),eh(h.i,"t",f),o.C=0,h=o.j.J,o.h=new Fl,o.g=yh(o.j,h?u:null,!o.m),0<o.O&&(o.M=new Cm(b(o.Y,o,o.g),o.O)),u=o.U,h=o.g,f=o.ca;var w="readystatechange";Array.isArray(w)||(w&&(Pl[0]=w.toString()),w=Pl);for(var S=0;S<w.length;S++){var N=Tl(h,w[S],f||u.handleEvent,!1,u.h||u);if(!N)break;u.g[N.key]=N}u=o.H?m(o.H):{},o.m?(o.u||(o.u="POST"),u["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,u)):(o.u="GET",o.g.ea(o.A,o.u,null,u)),Di(),Nm(o.i,o.u,o.A,o.l,o.R,o.m)}bt.prototype.ca=function(o){o=o.target;let u=this.M;u&&at(o)==3?u.j():this.Y(o)},bt.prototype.Y=function(o){try{if(o==this.g)e:{let be=at(this.g);var u=this.g.Ba();let xn=this.g.Z();if(!(3>be)&&(be!=3||this.g&&(this.h.h||this.g.oa()||ah(this.g)))){this.J||be!=4||u==7||(u==8||0>=xn?Di(3):Di(2)),No(this);var h=this.g.Z();this.X=h;t:if(ql(this)){var f=ah(this.g);o="";var w=f.length,S=at(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Jt(this),ki(this);var N="";break t}this.h.i=new c.TextDecoder}for(u=0;u<w;u++)this.h.h=!0,o+=this.h.i.decode(f[u],{stream:!(S&&u==w-1)});f.length=0,this.h.g+=o,this.C=0,N=this.h.g}else N=this.g.oa();if(this.o=h==200,Om(this.i,this.u,this.A,this.l,this.R,be,h),this.o){if(this.T&&!this.K){t:{if(this.g){var Z,ye=this.g;if((Z=ye.g?ye.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!W(Z)){var Q=Z;break t}}Q=null}if(h=Q)Nn(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Oo(this,h);else{this.o=!1,this.s=3,Oe(12),Jt(this),ki(this);break e}}if(this.P){h=!0;let $e;for(;!this.J&&this.C<N.length;)if($e=Lm(this,N),$e==Po){be==4&&(this.s=4,Oe(14),h=!1),Nn(this.i,this.l,null,"[Incomplete Response]");break}else if($e==Ul){this.s=4,Oe(15),Nn(this.i,this.l,N,"[Invalid Chunk]"),h=!1;break}else Nn(this.i,this.l,$e,null),Oo(this,$e);if(ql(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),be!=4||N.length!=0||this.h.h||(this.s=1,Oe(16),h=!1),this.o=this.o&&h,!h)Nn(this.i,this.l,N,"[Invalid Chunked Response]"),Jt(this),ki(this);else if(0<N.length&&!this.W){this.W=!0;var Ae=this.j;Ae.g==this&&Ae.ba&&!Ae.M&&(Ae.j.info("Great, no buffering proxy detected. Bytes received: "+N.length),Fo(Ae),Ae.M=!0,Oe(11))}}else Nn(this.i,this.l,N,null),Oo(this,N);be==4&&Jt(this),this.o&&!this.J&&(be==4?ph(this.j,this):(this.o=!1,Lr(this)))}else Xm(this.g),h==400&&0<N.indexOf("Unknown SID")?(this.s=3,Oe(12)):(this.s=0,Oe(13)),Jt(this),ki(this)}}}catch{}finally{}};function ql(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function Lm(o,u){var h=o.C,f=u.indexOf(`
`,h);return f==-1?Po:(h=Number(u.substring(h,f)),isNaN(h)?Ul:(f+=1,f+h>u.length?Po:(u=u.slice(f,f+h),o.C=f+h,u)))}bt.prototype.cancel=function(){this.J=!0,Jt(this)};function Lr(o){o.S=Date.now()+o.I,$l(o,o.I)}function $l(o,u){if(o.B!=null)throw Error("WatchDog timer not null");o.B=Ni(b(o.ba,o),u)}function No(o){o.B&&(c.clearTimeout(o.B),o.B=null)}bt.prototype.ba=function(){this.B=null;let o=Date.now();0<=o-this.S?(km(this.i,this.A),this.L!=2&&(Di(),Oe(17)),Jt(this),this.s=2,ki(this)):$l(this,this.S-o)};function ki(o){o.j.G==0||o.J||ph(o.j,o)}function Jt(o){No(o);var u=o.M;u&&typeof u.ma=="function"&&u.ma(),o.M=null,Dl(o.U),o.g&&(u=o.g,o.g=null,u.abort(),u.ma())}function Oo(o,u){try{var h=o.j;if(h.G!=0&&(h.g==o||ko(h.h,o))){if(!o.K&&ko(h.h,o)&&h.G==3){try{var f=h.Da.g.parse(u)}catch{f=null}if(Array.isArray(f)&&f.length==3){var w=f;if(w[0]==0){e:if(!h.u){if(h.g)if(h.g.F+3e3<o.F)Wr(h),qr(h);else break e;Vo(h),Oe(18)}}else h.za=w[1],0<h.za-h.T&&37500>w[2]&&h.F&&h.v==0&&!h.C&&(h.C=Ni(b(h.Za,h),6e3));if(1>=Gl(h.h)&&h.ca){try{h.ca()}catch{}h.ca=void 0}}else Zt(h,11)}else if((o.K||h.g==o)&&Wr(h),!W(u))for(w=h.Da.g.parse(u),u=0;u<w.length;u++){let Q=w[u];if(h.T=Q[0],Q=Q[1],h.G==2)if(Q[0]=="c"){h.K=Q[1],h.ia=Q[2];let Ae=Q[3];Ae!=null&&(h.la=Ae,h.j.info("VER="+h.la));let be=Q[4];be!=null&&(h.Aa=be,h.j.info("SVER="+h.Aa));let xn=Q[5];xn!=null&&typeof xn=="number"&&0<xn&&(f=1.5*xn,h.L=f,h.j.info("backChannelRequestTimeoutMs_="+f)),f=h;let $e=o.g;if($e){let Gr=$e.g?$e.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Gr){var S=f.h;S.g||Gr.indexOf("spdy")==-1&&Gr.indexOf("quic")==-1&&Gr.indexOf("h2")==-1||(S.j=S.l,S.g=new Set,S.h&&(xo(S,S.h),S.h=null))}if(f.D){let Uo=$e.g?$e.g.getResponseHeader("X-HTTP-Session-Id"):null;Uo&&(f.ya=Uo,ne(f.I,f.D,Uo))}}h.G=3,h.l&&h.l.ua(),h.ba&&(h.R=Date.now()-o.F,h.j.info("Handshake RTT: "+h.R+"ms")),f=h;var N=o;if(f.qa=_h(f,f.J?f.ia:null,f.W),N.K){jl(f.h,N);var Z=N,ye=f.L;ye&&(Z.I=ye),Z.B&&(No(Z),Lr(Z)),f.g=N}else dh(f);0<h.i.length&&$r(h)}else Q[0]!="stop"&&Q[0]!="close"||Zt(h,7);else h.G==3&&(Q[0]=="stop"||Q[0]=="close"?Q[0]=="stop"?Zt(h,7):Mo(h):Q[0]!="noop"&&h.l&&h.l.ta(Q),h.v=0)}}Di(4)}catch{}}var Mm=class{constructor(o,u){this.g=o,this.map=u}};function Wl(o){this.l=o||10,c.PerformanceNavigationTiming?(o=c.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function zl(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function Gl(o){return o.h?1:o.g?o.g.size:0}function ko(o,u){return o.h?o.h==u:o.g?o.g.has(u):!1}function xo(o,u){o.g?o.g.add(u):o.h=u}function jl(o,u){o.h&&o.h==u?o.h=null:o.g&&o.g.has(u)&&o.g.delete(u)}Wl.prototype.cancel=function(){if(this.i=Hl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let o of this.g.values())o.cancel();this.g.clear()}};function Hl(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let u=o.i;for(let h of o.g.values())u=u.concat(h.D);return u}return k(o.i)}function Vm(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(l(o)){for(var u=[],h=o.length,f=0;f<h;f++)u.push(o[f]);return u}u=[],h=0;for(f in o)u[h++]=o[f];return u}function Fm(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(l(o)||typeof o=="string"){var u=[];o=o.length;for(var h=0;h<o;h++)u.push(h);return u}u=[],h=0;for(let f in o)u[h++]=f;return u}}}function Kl(o,u){if(o.forEach&&typeof o.forEach=="function")o.forEach(u,void 0);else if(l(o)||typeof o=="string")Array.prototype.forEach.call(o,u,void 0);else for(var h=Fm(o),f=Vm(o),w=f.length,S=0;S<w;S++)u.call(void 0,f[S],h&&h[S],o)}var Ql=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Um(o,u){if(o){o=o.split("&");for(var h=0;h<o.length;h++){var f=o[h].indexOf("="),w=null;if(0<=f){var S=o[h].substring(0,f);w=o[h].substring(f+1)}else S=o[h];u(S,w?decodeURIComponent(w.replace(/\+/g," ")):"")}}}function Xt(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof Xt){this.h=o.h,Mr(this,o.j),this.o=o.o,this.g=o.g,Vr(this,o.s),this.l=o.l;var u=o.i,h=new Mi;h.i=u.i,u.g&&(h.g=new Map(u.g),h.h=u.h),Yl(this,h),this.m=o.m}else o&&(u=String(o).match(Ql))?(this.h=!1,Mr(this,u[1]||"",!0),this.o=xi(u[2]||""),this.g=xi(u[3]||"",!0),Vr(this,u[4]),this.l=xi(u[5]||"",!0),Yl(this,u[6]||"",!0),this.m=xi(u[7]||"")):(this.h=!1,this.i=new Mi(null,this.h))}Xt.prototype.toString=function(){var o=[],u=this.j;u&&o.push(Li(u,Jl,!0),":");var h=this.g;return(h||u=="file")&&(o.push("//"),(u=this.o)&&o.push(Li(u,Jl,!0),"@"),o.push(encodeURIComponent(String(h)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h=this.s,h!=null&&o.push(":",String(h))),(h=this.l)&&(this.g&&h.charAt(0)!="/"&&o.push("/"),o.push(Li(h,h.charAt(0)=="/"?$m:qm,!0))),(h=this.i.toString())&&o.push("?",h),(h=this.m)&&o.push("#",Li(h,zm)),o.join("")};function ot(o){return new Xt(o)}function Mr(o,u,h){o.j=h?xi(u,!0):u,o.j&&(o.j=o.j.replace(/:$/,""))}function Vr(o,u){if(u){if(u=Number(u),isNaN(u)||0>u)throw Error("Bad port number "+u);o.s=u}else o.s=null}function Yl(o,u,h){u instanceof Mi?(o.i=u,Gm(o.i,o.h)):(h||(u=Li(u,Wm)),o.i=new Mi(u,o.h))}function ne(o,u,h){o.i.set(u,h)}function Fr(o){return ne(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function xi(o,u){return o?u?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function Li(o,u,h){return typeof o=="string"?(o=encodeURI(o).replace(u,Bm),h&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function Bm(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var Jl=/[#\/\?@]/g,qm=/[#\?:]/g,$m=/[#\?]/g,Wm=/[#\?@]/g,zm=/#/g;function Mi(o,u){this.h=this.g=null,this.i=o||null,this.j=!!u}function St(o){o.g||(o.g=new Map,o.h=0,o.i&&Um(o.i,function(u,h){o.add(decodeURIComponent(u.replace(/\+/g," ")),h)}))}n=Mi.prototype,n.add=function(o,u){St(this),this.i=null,o=On(this,o);var h=this.g.get(o);return h||this.g.set(o,h=[]),h.push(u),this.h+=1,this};function Xl(o,u){St(o),u=On(o,u),o.g.has(u)&&(o.i=null,o.h-=o.g.get(u).length,o.g.delete(u))}function Zl(o,u){return St(o),u=On(o,u),o.g.has(u)}n.forEach=function(o,u){St(this),this.g.forEach(function(h,f){h.forEach(function(w){o.call(u,w,f,this)},this)},this)},n.na=function(){St(this);let o=Array.from(this.g.values()),u=Array.from(this.g.keys()),h=[];for(let f=0;f<u.length;f++){let w=o[f];for(let S=0;S<w.length;S++)h.push(u[f])}return h},n.V=function(o){St(this);let u=[];if(typeof o=="string")Zl(this,o)&&(u=u.concat(this.g.get(On(this,o))));else{o=Array.from(this.g.values());for(let h=0;h<o.length;h++)u=u.concat(o[h])}return u},n.set=function(o,u){return St(this),this.i=null,o=On(this,o),Zl(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[u]),this.h+=1,this},n.get=function(o,u){return o?(o=this.V(o),0<o.length?String(o[0]):u):u};function eh(o,u,h){Xl(o,u),0<h.length&&(o.i=null,o.g.set(On(o,u),k(h)),o.h+=h.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let o=[],u=Array.from(this.g.keys());for(var h=0;h<u.length;h++){var f=u[h];let S=encodeURIComponent(String(f)),N=this.V(f);for(f=0;f<N.length;f++){var w=S;N[f]!==""&&(w+="="+encodeURIComponent(String(N[f]))),o.push(w)}}return this.i=o.join("&")};function On(o,u){return u=String(u),o.j&&(u=u.toLowerCase()),u}function Gm(o,u){u&&!o.j&&(St(o),o.i=null,o.g.forEach(function(h,f){var w=f.toLowerCase();f!=w&&(Xl(this,f),eh(this,w,h))},o)),o.j=u}function jm(o,u){let h=new Oi;if(c.Image){let f=new Image;f.onload=R(Rt,h,"TestLoadImage: loaded",!0,u,f),f.onerror=R(Rt,h,"TestLoadImage: error",!1,u,f),f.onabort=R(Rt,h,"TestLoadImage: abort",!1,u,f),f.ontimeout=R(Rt,h,"TestLoadImage: timeout",!1,u,f),c.setTimeout(function(){f.ontimeout&&f.ontimeout()},1e4),f.src=o}else u(!1)}function Hm(o,u){let h=new Oi,f=new AbortController,w=setTimeout(()=>{f.abort(),Rt(h,"TestPingServer: timeout",!1,u)},1e4);fetch(o,{signal:f.signal}).then(S=>{clearTimeout(w),S.ok?Rt(h,"TestPingServer: ok",!0,u):Rt(h,"TestPingServer: server error",!1,u)}).catch(()=>{clearTimeout(w),Rt(h,"TestPingServer: error",!1,u)})}function Rt(o,u,h,f,w){try{w&&(w.onload=null,w.onerror=null,w.onabort=null,w.ontimeout=null),f(h)}catch{}}function Km(){this.g=new Dm}function Qm(o,u,h){let f=h||"";try{Kl(o,function(w,S){let N=w;d(w)&&(N=Ao(w)),u.push(f+S+"="+encodeURIComponent(N))})}catch(w){throw u.push(f+"type="+encodeURIComponent("_badmap")),w}}function Vi(o){this.l=o.Ub||null,this.j=o.eb||!1}D(Vi,bo),Vi.prototype.g=function(){return new Ur(this.l,this.j)},Vi.prototype.i=function(o){return function(){return o}}({});function Ur(o,u){we.call(this),this.D=o,this.o=u,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}D(Ur,we),n=Ur.prototype,n.open=function(o,u){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=u,this.readyState=1,Ui(this)},n.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let u={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(u.body=o),(this.D||c).fetch(new Request(this.A,u)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Fi(this)),this.readyState=0},n.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,Ui(this)),this.g&&(this.readyState=3,Ui(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;th(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function th(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}n.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var u=o.value?o.value:new Uint8Array(0);(u=this.v.decode(u,{stream:!o.done}))&&(this.response=this.responseText+=u)}o.done?Fi(this):Ui(this),this.readyState==3&&th(this)}},n.Ra=function(o){this.g&&(this.response=this.responseText=o,Fi(this))},n.Qa=function(o){this.g&&(this.response=o,Fi(this))},n.ga=function(){this.g&&Fi(this)};function Fi(o){o.readyState=4,o.l=null,o.j=null,o.v=null,Ui(o)}n.setRequestHeader=function(o,u){this.u.append(o,u)},n.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let o=[],u=this.h.entries();for(var h=u.next();!h.done;)h=h.value,o.push(h[0]+": "+h[1]),h=u.next();return o.join(`\r
`)};function Ui(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(Ur.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function nh(o){let u="";return J(o,function(h,f){u+=f,u+=":",u+=h,u+=`\r
`}),u}function Lo(o,u,h){e:{for(f in h){var f=!1;break e}f=!0}f||(h=nh(h),typeof o=="string"?h!=null&&encodeURIComponent(String(h)):ne(o,u,h))}function se(o){we.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}D(se,we);var Ym=/^https?$/i,Jm=["POST","PUT"];n=se.prototype,n.Ha=function(o){this.J=o},n.ea=function(o,u,h,f){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);u=u?u.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Co.g(),this.v=this.o?Nl(this.o):Nl(Co),this.g.onreadystatechange=b(this.Ea,this);try{this.B=!0,this.g.open(u,String(o),!0),this.B=!1}catch(S){ih(this,S);return}if(o=h||"",h=new Map(this.headers),f)if(Object.getPrototypeOf(f)===Object.prototype)for(var w in f)h.set(w,f[w]);else if(typeof f.keys=="function"&&typeof f.get=="function")for(let S of f.keys())h.set(S,f.get(S));else throw Error("Unknown input type for opt_headers: "+String(f));f=Array.from(h.keys()).find(S=>S.toLowerCase()=="content-type"),w=c.FormData&&o instanceof c.FormData,!(0<=Array.prototype.indexOf.call(Jm,u,void 0))||f||w||h.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[S,N]of h)this.g.setRequestHeader(S,N);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{oh(this),this.u=!0,this.g.send(o),this.u=!1}catch(S){ih(this,S)}};function ih(o,u){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=u,o.m=5,rh(o),Br(o)}function rh(o){o.A||(o.A=!0,Ne(o,"complete"),Ne(o,"error"))}n.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,Ne(this,"complete"),Ne(this,"abort"),Br(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Br(this,!0)),se.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?sh(this):this.bb())},n.bb=function(){sh(this)};function sh(o){if(o.h&&typeof a<"u"&&(!o.v[1]||at(o)!=4||o.Z()!=2)){if(o.u&&at(o)==4)Rl(o.Ea,0,o);else if(Ne(o,"readystatechange"),at(o)==4){o.h=!1;try{let N=o.Z();e:switch(N){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var u=!0;break e;default:u=!1}var h;if(!(h=u)){var f;if(f=N===0){var w=String(o.D).match(Ql)[1]||null;!w&&c.self&&c.self.location&&(w=c.self.location.protocol.slice(0,-1)),f=!Ym.test(w?w.toLowerCase():"")}h=f}if(h)Ne(o,"complete"),Ne(o,"success");else{o.m=6;try{var S=2<at(o)?o.g.statusText:""}catch{S=""}o.l=S+" ["+o.Z()+"]",rh(o)}}finally{Br(o)}}}}function Br(o,u){if(o.g){oh(o);let h=o.g,f=o.v[0]?()=>{}:null;o.g=null,o.v=null,u||Ne(o,"ready");try{h.onreadystatechange=f}catch{}}}function oh(o){o.I&&(c.clearTimeout(o.I),o.I=null)}n.isActive=function(){return!!this.g};function at(o){return o.g?o.g.readyState:0}n.Z=function(){try{return 2<at(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(o){if(this.g){var u=this.g.responseText;return o&&u.indexOf(o)==0&&(u=u.substring(o.length)),Pm(u)}};function ah(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function Xm(o){let u={};o=(o.g&&2<=at(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let f=0;f<o.length;f++){if(W(o[f]))continue;var h=T(o[f]);let w=h[0];if(h=h[1],typeof h!="string")continue;h=h.trim();let S=u[w]||[];u[w]=S,S.push(h)}E(u,function(f){return f.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Bi(o,u,h){return h&&h.internalChannelParams&&h.internalChannelParams[o]||u}function ch(o){this.Aa=0,this.i=[],this.j=new Oi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Bi("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Bi("baseRetryDelayMs",5e3,o),this.cb=Bi("retryDelaySeedMs",1e4,o),this.Wa=Bi("forwardChannelMaxRetries",2,o),this.wa=Bi("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new Wl(o&&o.concurrentRequestLimit),this.Da=new Km,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=ch.prototype,n.la=8,n.G=1,n.connect=function(o,u,h,f){Oe(0),this.W=o,this.H=u||{},h&&f!==void 0&&(this.H.OSID=h,this.H.OAID=f),this.F=this.X,this.I=_h(this,null,this.W),$r(this)};function Mo(o){if(uh(o),o.G==3){var u=o.U++,h=ot(o.I);if(ne(h,"SID",o.K),ne(h,"RID",u),ne(h,"TYPE","terminate"),qi(o,h),u=new bt(o,o.j,u),u.L=2,u.v=Fr(ot(h)),h=!1,c.navigator&&c.navigator.sendBeacon)try{h=c.navigator.sendBeacon(u.v.toString(),"")}catch{}!h&&c.Image&&(new Image().src=u.v,h=!0),h||(u.g=yh(u.j,null),u.g.ea(u.v)),u.F=Date.now(),Lr(u)}gh(o)}function qr(o){o.g&&(Fo(o),o.g.cancel(),o.g=null)}function uh(o){qr(o),o.u&&(c.clearTimeout(o.u),o.u=null),Wr(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&c.clearTimeout(o.s),o.s=null)}function $r(o){if(!zl(o.h)&&!o.s){o.s=!0;var u=o.Ga;Ai||El(),bi||(Ai(),bi=!0),mo.add(u,o),o.B=0}}function Zm(o,u){return Gl(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=u.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=Ni(b(o.Ga,o,u),mh(o,o.B)),o.B++,!0)}n.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;let w=new bt(this,this.j,o),S=this.o;if(this.S&&(S?(S=m(S),v(S,this.S)):S=this.S),this.m!==null||this.O||(w.H=S,S=null),this.P)e:{for(var u=0,h=0;h<this.i.length;h++){t:{var f=this.i[h];if("__data__"in f.map&&(f=f.map.__data__,typeof f=="string")){f=f.length;break t}f=void 0}if(f===void 0)break;if(u+=f,4096<u){u=h;break e}if(u===4096||h===this.i.length-1){u=h+1;break e}}u=1e3}else u=1e3;u=hh(this,w,u),h=ot(this.I),ne(h,"RID",o),ne(h,"CVER",22),this.D&&ne(h,"X-HTTP-Session-Id",this.D),qi(this,h),S&&(this.O?u="headers="+encodeURIComponent(String(nh(S)))+"&"+u:this.m&&Lo(h,this.m,S)),xo(this.h,w),this.Ua&&ne(h,"TYPE","init"),this.P?(ne(h,"$req",u),ne(h,"SID","null"),w.T=!0,Do(w,h,null)):Do(w,h,u),this.G=2}}else this.G==3&&(o?lh(this,o):this.i.length==0||zl(this.h)||lh(this))};function lh(o,u){var h;u?h=u.l:h=o.U++;let f=ot(o.I);ne(f,"SID",o.K),ne(f,"RID",h),ne(f,"AID",o.T),qi(o,f),o.m&&o.o&&Lo(f,o.m,o.o),h=new bt(o,o.j,h,o.B+1),o.m===null&&(h.H=o.o),u&&(o.i=u.D.concat(o.i)),u=hh(o,h,1e3),h.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),xo(o.h,h),Do(h,f,u)}function qi(o,u){o.H&&J(o.H,function(h,f){ne(u,f,h)}),o.l&&Kl({},function(h,f){ne(u,f,h)})}function hh(o,u,h){h=Math.min(o.i.length,h);var f=o.l?b(o.l.Na,o.l,o):null;e:{var w=o.i;let S=-1;for(;;){let N=["count="+h];S==-1?0<h?(S=w[0].g,N.push("ofs="+S)):S=0:N.push("ofs="+S);let Z=!0;for(let ye=0;ye<h;ye++){let Q=w[ye].g,Ae=w[ye].map;if(Q-=S,0>Q)S=Math.max(0,w[ye].g-100),Z=!1;else try{Qm(Ae,N,"req"+Q+"_")}catch{f&&f(Ae)}}if(Z){f=N.join("&");break e}}}return o=o.i.splice(0,h),u.D=o,f}function dh(o){if(!o.g&&!o.u){o.Y=1;var u=o.Fa;Ai||El(),bi||(Ai(),bi=!0),mo.add(u,o),o.v=0}}function Vo(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=Ni(b(o.Fa,o),mh(o,o.v)),o.v++,!0)}n.Fa=function(){if(this.u=null,fh(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=Ni(b(this.ab,this),o)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Oe(10),qr(this),fh(this))};function Fo(o){o.A!=null&&(c.clearTimeout(o.A),o.A=null)}function fh(o){o.g=new bt(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var u=ot(o.qa);ne(u,"RID","rpc"),ne(u,"SID",o.K),ne(u,"AID",o.T),ne(u,"CI",o.F?"0":"1"),!o.F&&o.ja&&ne(u,"TO",o.ja),ne(u,"TYPE","xmlhttp"),qi(o,u),o.m&&o.o&&Lo(u,o.m,o.o),o.L&&(o.g.I=o.L);var h=o.g;o=o.ia,h.L=1,h.v=Fr(ot(u)),h.m=null,h.P=!0,Bl(h,o)}n.Za=function(){this.C!=null&&(this.C=null,qr(this),Vo(this),Oe(19))};function Wr(o){o.C!=null&&(c.clearTimeout(o.C),o.C=null)}function ph(o,u){var h=null;if(o.g==u){Wr(o),Fo(o),o.g=null;var f=2}else if(ko(o.h,u))h=u.D,jl(o.h,u),f=1;else return;if(o.G!=0){if(u.o)if(f==1){h=u.m?u.m.length:0,u=Date.now()-u.F;var w=o.B;f=Or(),Ne(f,new Ml(f,h)),$r(o)}else dh(o);else if(w=u.s,w==3||w==0&&0<u.X||!(f==1&&Zm(o,u)||f==2&&Vo(o)))switch(h&&0<h.length&&(u=o.h,u.i=u.i.concat(h)),w){case 1:Zt(o,5);break;case 4:Zt(o,10);break;case 3:Zt(o,6);break;default:Zt(o,2)}}}function mh(o,u){let h=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(h*=2),h*u}function Zt(o,u){if(o.j.info("Error code "+u),u==2){var h=b(o.fb,o),f=o.Xa;let w=!f;f=new Xt(f||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Mr(f,"https"),Fr(f),w?jm(f.toString(),h):Hm(f.toString(),h)}else Oe(2);o.G=0,o.l&&o.l.sa(u),gh(o),uh(o)}n.fb=function(o){o?(this.j.info("Successfully pinged google.com"),Oe(2)):(this.j.info("Failed to ping google.com"),Oe(1))};function gh(o){if(o.G=0,o.ka=[],o.l){let u=Hl(o.h);(u.length!=0||o.i.length!=0)&&(O(o.ka,u),O(o.ka,o.i),o.h.i.length=0,k(o.i),o.i.length=0),o.l.ra()}}function _h(o,u,h){var f=h instanceof Xt?ot(h):new Xt(h);if(f.g!="")u&&(f.g=u+"."+f.g),Vr(f,f.s);else{var w=c.location;f=w.protocol,u=u?u+"."+w.hostname:w.hostname,w=+w.port;var S=new Xt(null);f&&Mr(S,f),u&&(S.g=u),w&&Vr(S,w),h&&(S.l=h),f=S}return h=o.D,u=o.ya,h&&u&&ne(f,h,u),ne(f,"VER",o.la),qi(o,f),f}function yh(o,u,h){if(u&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return u=o.Ca&&!o.pa?new se(new Vi({eb:h})):new se(o.pa),u.Ha(o.J),u}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ih(){}n=Ih.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function zr(){}zr.prototype.g=function(o,u){return new ke(o,u)};function ke(o,u){we.call(this),this.g=new ch(u),this.l=o,this.h=u&&u.messageUrlParams||null,o=u&&u.messageHeaders||null,u&&u.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=u&&u.initMessageHeaders||null,u&&u.messageContentType&&(o?o["X-WebChannel-Content-Type"]=u.messageContentType:o={"X-WebChannel-Content-Type":u.messageContentType}),u&&u.va&&(o?o["X-WebChannel-Client-Profile"]=u.va:o={"X-WebChannel-Client-Profile":u.va}),this.g.S=o,(o=u&&u.Sb)&&!W(o)&&(this.g.m=o),this.v=u&&u.supportsCrossDomainXhr||!1,this.u=u&&u.sendRawJson||!1,(u=u&&u.httpSessionIdParam)&&!W(u)&&(this.g.D=u,o=this.h,o!==null&&u in o&&(o=this.h,u in o&&delete o[u])),this.j=new kn(this)}D(ke,we),ke.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ke.prototype.close=function(){Mo(this.g)},ke.prototype.o=function(o){var u=this.g;if(typeof o=="string"){var h={};h.__data__=o,o=h}else this.u&&(h={},h.__data__=Ao(o),o=h);u.i.push(new Mm(u.Ya++,o)),u.G==3&&$r(u)},ke.prototype.N=function(){this.g.l=null,delete this.j,Mo(this.g),delete this.g,ke.aa.N.call(this)};function vh(o){So.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var u=o.__sm__;if(u){e:{for(let h in u){o=h;break e}o=void 0}(this.i=o)&&(o=this.i,u=u!==null&&o in u?u[o]:void 0),this.data=u}else this.data=o}D(vh,So);function Eh(){Ro.call(this),this.status=1}D(Eh,Ro);function kn(o){this.g=o}D(kn,Ih),kn.prototype.ua=function(){Ne(this.g,"a")},kn.prototype.ta=function(o){Ne(this.g,new vh(o))},kn.prototype.sa=function(o){Ne(this.g,new Eh)},kn.prototype.ra=function(){Ne(this.g,"b")},zr.prototype.createWebChannel=zr.prototype.g,ke.prototype.send=ke.prototype.o,ke.prototype.open=ke.prototype.m,ke.prototype.close=ke.prototype.close,dc=It.createWebChannelTransport=function(){return new zr},hc=It.getStatEventTarget=function(){return Or()},lc=It.Event=Yt,Cs=It.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},kr.NO_ERROR=0,kr.TIMEOUT=8,kr.HTTP_ERROR=6,nr=It.ErrorCode=kr,Vl.COMPLETE="complete",uc=It.EventType=Vl,Ol.EventType=Pi,Pi.OPEN="a",Pi.CLOSE="b",Pi.ERROR="c",Pi.MESSAGE="d",we.prototype.listen=we.prototype.K,Xn=It.WebChannel=Ol,sv=It.FetchXmlHttpFactory=Vi,se.prototype.listenOnce=se.prototype.L,se.prototype.getLastError=se.prototype.Ka,se.prototype.getLastErrorCode=se.prototype.Ba,se.prototype.getStatus=se.prototype.Z,se.prototype.getResponseJson=se.prototype.Oa,se.prototype.getResponseText=se.prototype.oa,se.prototype.send=se.prototype.ea,se.prototype.setWithCredentials=se.prototype.Ha,cc=It.XhrIo=se}).apply(typeof Rs<"u"?Rs:typeof self<"u"?self:typeof window<"u"?window:{});var gf="@firebase/firestore";var _e=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};_e.UNAUTHENTICATED=new _e(null),_e.GOOGLE_CREDENTIALS=new _e("google-credentials-uid"),_e.FIRST_PARTY=new _e("first-party-uid"),_e.MOCK_USER=new _e("mock-user");var vi="10.14.0";var vn=new xt("@firebase/firestore");function ir(){return vn.logLevel}function L(n,...e){if(vn.logLevel<=G.DEBUG){let t=e.map(Xu);vn.debug(`Firestore (${vi}): ${n}`,...t)}}function vt(n,...e){if(vn.logLevel<=G.ERROR){let t=e.map(Xu);vn.error(`Firestore (${vi}): ${n}`,...t)}}function oi(n,...e){if(vn.logLevel<=G.WARN){let t=e.map(Xu);vn.warn(`Firestore (${vi}): ${n}`,...t)}}function Xu(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function U(n="Unexpected state"){let e=`FIRESTORE (${vi}) INTERNAL ASSERTION FAILED: `+n;throw vt(e),new Error(e)}function X(n,e){n||U()}function q(n,e){return n}var C={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},x=class extends Le{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var et=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var ks=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},_c=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(_e.UNAUTHENTICATED))}shutdown(){}},yc=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Ic=class{constructor(e){this.t=e,this.currentUser=_e.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){X(this.o===void 0);let i=this.i,r=l=>this.i!==i?(i=this.i,t(l)):Promise.resolve(),s=new et;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new et,e.enqueueRetryable(()=>r(this.currentUser))};let a=()=>{let l=s;e.enqueueRetryable(()=>g(this,null,function*(){yield l.promise,yield r(this.currentUser)}))},c=l=>{L("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>c(l)),setTimeout(()=>{if(!this.auth){let l=this.t.getImmediate({optional:!0});l?c(l):(L("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new et)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(L("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(X(typeof i.accessToken=="string"),new ks(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return X(e===null||typeof e=="string"),new _e(e)}},vc=class{constructor(e,t,i){this.l=e,this.h=t,this.P=i,this.type="FirstParty",this.user=_e.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Ec=class{constructor(e,t,i){this.l=e,this.h=t,this.P=i}getToken(){return Promise.resolve(new vc(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(_e.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Tc=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},wc=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){X(this.o===void 0);let i=s=>{s.error!=null&&L("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let a=s.token!==this.R;return this.R=s.token,L("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>i(s))};let r=s=>{L("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?r(s):L("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(X(typeof t.token=="string"),this.R=t.token,new Tc(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function ov(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}var xs=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,i="";for(;i.length<20;){let r=ov(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%e.length))}return i}};function Y(n,e){return n<e?-1:n>e?1:0}function ai(n,e,t){return n.length===e.length&&n.every((i,r)=>t(i,e[r]))}var Ee=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new x(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new x(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new x(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new x(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*t));return new n(t,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Y(this.nanoseconds,e.nanoseconds):Y(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var $=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new Ee(0,0))}static max(){return new n(new Ee(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Ls=class n{constructor(e,t,i){t===void 0?t=0:t>e.length&&U(),i===void 0?i=e.length-t:i>e.length-t&&U(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let i=Math.min(e.length,t.length);for(let r=0;r<i;r++){let s=e.get(r),a=t.get(r);if(s<a)return-1;if(s>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},re=class n extends Ls{construct(e,t,i){return new n(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let i of e){if(i.indexOf("//")>=0)throw new x(C.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(r=>r.length>0))}return new n(t)}static emptyPath(){return new n([])}},av=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Me=class n extends Ls{construct(e,t,i){return new n(e,t,i)}static isValidIdentifier(e){return av.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],i="",r=0,s=()=>{if(i.length===0)throw new x(C.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""},a=!1;for(;r<e.length;){let c=e[r];if(c==="\\"){if(r+1===e.length)throw new x(C.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let l=e[r+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new x(C.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=l,r+=2}else c==="`"?(a=!a,r++):c!=="."||a?(i+=c,r++):(s(),r++)}if(s(),a)throw new x(C.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var V=class n{constructor(e){this.path=e}static fromPath(e){return new n(re.fromString(e))}static fromName(e){return new n(re.fromString(e).popFirst(5))}static empty(){return new n(re.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&re.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return re.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new re(e.slice()))}};var Ac=class{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}};Ac.UNKNOWN_ID=-1;function cv(n,e){let t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=$.fromTimestamp(i===1e9?new Ee(t+1,0):new Ee(t,i));return new En(r,V.empty(),e)}function uv(n){return new En(n.readTime,n.key,-1)}var En=class n{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new n($.min(),V.empty(),-1)}static max(){return new n($.max(),V.empty(),-1)}};function lv(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=V.comparator(n.documentKey,e.documentKey),t!==0?t:Y(n.largestBatchId,e.largestBatchId))}var hv="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",bc=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function wr(n){return g(this,null,function*(){if(n.code!==C.FAILED_PRECONDITION||n.message!==hv)throw n;L("LocalStore","Unexpectedly lost primary lease")})}var P=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&U(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,i)=>{t(e)})}static reject(e){return new n((t,i)=>{i(e)})}static waitFor(e){return new n((t,i)=>{let r=0,s=0,a=!1;e.forEach(c=>{++r,c.next(()=>{++s,a&&s===r&&t()},l=>i(l))}),a=!0,s===r&&t()})}static or(e){let t=n.resolve(!1);for(let i of e)t=t.next(r=>r?n.resolve(r):i());return t}static forEach(e,t){let i=[];return e.forEach((r,s)=>{i.push(t.call(this,r,s))}),this.waitFor(i)}static mapArray(e,t){return new n((i,r)=>{let s=e.length,a=new Array(s),c=0;for(let l=0;l<s;l++){let d=l;t(e[d]).next(p=>{a[d]=p,++c,c===s&&i(a)},p=>r(p))}})}static doWhile(e,t){return new n((i,r)=>{let s=()=>{e()===!0?t().next(()=>{s()},r):i()};s()})}};function dv(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Ar(n){return n.name==="IndexedDbTransactionError"}var Yf=(()=>{class n{constructor(t,i){this.previousValue=t,i&&(i.sequenceNumberHandler=r=>this.ie(r),this.se=r=>i.writeSequenceNumber(r))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function ao(n){return n==null}function ur(n){return n===0&&1/n==-1/0}function fv(n){return typeof n=="number"&&Number.isInteger(n)&&!ur(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var pv=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Nb=[...pv,"documentOverlays"],mv=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],gv=mv,_v=[...gv,"indexConfiguration","indexState","indexEntries"];var Ob=[..._v,"globals"];function _f(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ei(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Jf(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var ae=class n{constructor(e,t){this.comparator=e,this.root=t||tt.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,tt.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,tt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){let r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){let e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ni(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ni(this.root,e,this.comparator,!1)}getReverseIterator(){return new ni(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ni(this.root,e,this.comparator,!0)}},ni=class{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},tt=class n{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??n.RED,this.left=r??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new n(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this,s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return n.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw U();let e=this.left.check();if(e!==this.right.check())throw U();return e+(this.isRed()?0:1)}};tt.EMPTY=null,tt.RED=!0,tt.BLACK=!1;tt.EMPTY=new class{constructor(){this.size=0}get key(){throw U()}get value(){throw U()}get color(){throw U()}get left(){throw U()}get right(){throw U()}copy(e,t,i,r,s){return this}insert(e,t,i){return new tt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Re=class n{constructor(e){this.comparator=e,this.data=new ae(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){let i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){let r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Ms(this.data.getIterator())}getIteratorFrom(e){return new Ms(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){let r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Ms=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Ze=class n{constructor(e){this.fields=e,e.sort(Me.comparator)}static empty(){return new n([])}unionWith(e){let t=new Re(Me.comparator);for(let i of this.fields)t=t.add(i);for(let i of e)t=t.add(i);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ai(this.fields,e.fields,(t,i)=>t.isEqual(i))}};var Vs=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Ce=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Vs("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(r){let s="";for(let a=0;a<r.length;++a)s+=String.fromCharCode(r[a]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Y(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Ce.EMPTY_BYTE_STRING=new Ce("");var yv=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Et(n){if(X(!!n),typeof n=="string"){let e=0,t=yv.exec(n);if(X(!!t),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}let i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:ie(n.seconds),nanos:ie(n.nanos)}}function ie(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Gt(n){return typeof n=="string"?Ce.fromBase64String(n):Ce.fromUint8Array(n)}function Zu(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function el(n){let e=n.mapValue.fields.__previous_value__;return Zu(e)?el(e):e}function lr(n){let e=Et(n.mapValue.fields.__local_write_time__.timestampValue);return new Ee(e.seconds,e.nanos)}var Sc=class{constructor(e,t,i,r,s,a,c,l,d){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=l,this.useFetchStreams=d}},Fs=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Ps={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Tn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Zu(n)?4:Zf(n)?9007199254740991:Xf(n)?10:11:U()}function rt(n,e){if(n===e)return!0;let t=Tn(n);if(t!==Tn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return lr(n).isEqual(lr(e));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;let a=Et(r.timestampValue),c=Et(s.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(r,s){return Gt(r.bytesValue).isEqual(Gt(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,s){return ie(r.geoPointValue.latitude)===ie(s.geoPointValue.latitude)&&ie(r.geoPointValue.longitude)===ie(s.geoPointValue.longitude)}(n,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return ie(r.integerValue)===ie(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){let a=ie(r.doubleValue),c=ie(s.doubleValue);return a===c?ur(a)===ur(c):isNaN(a)&&isNaN(c)}return!1}(n,e);case 9:return ai(n.arrayValue.values||[],e.arrayValue.values||[],rt);case 10:case 11:return function(r,s){let a=r.mapValue.fields||{},c=s.mapValue.fields||{};if(_f(a)!==_f(c))return!1;for(let l in a)if(a.hasOwnProperty(l)&&(c[l]===void 0||!rt(a[l],c[l])))return!1;return!0}(n,e);default:return U()}}function hr(n,e){return(n.values||[]).find(t=>rt(t,e))!==void 0}function ci(n,e){if(n===e)return 0;let t=Tn(n),i=Tn(e);if(t!==i)return Y(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Y(n.booleanValue,e.booleanValue);case 2:return function(s,a){let c=ie(s.integerValue||s.doubleValue),l=ie(a.integerValue||a.doubleValue);return c<l?-1:c>l?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1}(n,e);case 3:return yf(n.timestampValue,e.timestampValue);case 4:return yf(lr(n),lr(e));case 5:return Y(n.stringValue,e.stringValue);case 6:return function(s,a){let c=Gt(s),l=Gt(a);return c.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(s,a){let c=s.split("/"),l=a.split("/");for(let d=0;d<c.length&&d<l.length;d++){let p=Y(c[d],l[d]);if(p!==0)return p}return Y(c.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,a){let c=Y(ie(s.latitude),ie(a.latitude));return c!==0?c:Y(ie(s.longitude),ie(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return If(n.arrayValue,e.arrayValue);case 10:return function(s,a){var c,l,d,p;let I=s.fields||{},b=a.fields||{},R=(c=I.value)===null||c===void 0?void 0:c.arrayValue,D=(l=b.value)===null||l===void 0?void 0:l.arrayValue,k=Y(((d=R?.values)===null||d===void 0?void 0:d.length)||0,((p=D?.values)===null||p===void 0?void 0:p.length)||0);return k!==0?k:If(R,D)}(n.mapValue,e.mapValue);case 11:return function(s,a){if(s===Ps.mapValue&&a===Ps.mapValue)return 0;if(s===Ps.mapValue)return 1;if(a===Ps.mapValue)return-1;let c=s.fields||{},l=Object.keys(c),d=a.fields||{},p=Object.keys(d);l.sort(),p.sort();for(let I=0;I<l.length&&I<p.length;++I){let b=Y(l[I],p[I]);if(b!==0)return b;let R=ci(c[l[I]],d[p[I]]);if(R!==0)return R}return Y(l.length,p.length)}(n.mapValue,e.mapValue);default:throw U()}}function yf(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Y(n,e);let t=Et(n),i=Et(e),r=Y(t.seconds,i.seconds);return r!==0?r:Y(t.nanos,i.nanos)}function If(n,e){let t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){let s=ci(t[r],i[r]);if(s)return s}return Y(t.length,i.length)}function ui(n){return Rc(n)}function Rc(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let i=Et(t);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Gt(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return V.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let i="[",r=!0;for(let s of t.values||[])r?r=!1:i+=",",i+=Rc(s);return i+"]"}(n.arrayValue):"mapValue"in n?function(t){let i=Object.keys(t.fields||{}).sort(),r="{",s=!0;for(let a of i)s?s=!1:r+=",",r+=`${a}:${Rc(t.fields[a])}`;return r+"}"}(n.mapValue):U()}function vf(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Cc(n){return!!n&&"integerValue"in n}function tl(n){return!!n&&"arrayValue"in n}function Ef(n){return!!n&&"nullValue"in n}function Tf(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Ns(n){return!!n&&"mapValue"in n}function Xf(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function sr(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Ei(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=sr(i)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=sr(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Zf(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var Ge=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Ns(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=sr(t)}setAll(e){let t=Me.emptyPath(),i={},r=[];e.forEach((a,c)=>{if(!t.isImmediateParentOf(c)){let l=this.getFieldsMap(t);this.applyChanges(l,i,r),i={},r=[],t=c.popLast()}a?i[c.lastSegment()]=sr(a):r.push(c.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){let t=this.field(e.popLast());Ns(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return rt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];Ns(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){Ei(t,(r,s)=>e[r]=s);for(let r of i)delete e[r]}clone(){return new n(sr(this.value))}};function ep(n){let e=[];return Ei(n.fields,(t,i)=>{let r=new Me([t]);if(Ns(i)){let s=ep(i.mapValue).fields;if(s.length===0)e.push(r);else for(let a of s)e.push(r.child(a))}else e.push(r)}),new Ze(e)}var je=class n{constructor(e,t,i,r,s,a,c){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=a,this.documentState=c}static newInvalidDocument(e){return new n(e,0,$.min(),$.min(),$.min(),Ge.empty(),0)}static newFoundDocument(e,t,i,r){return new n(e,1,t,$.min(),i,r,0)}static newNoDocument(e,t){return new n(e,2,t,$.min(),$.min(),Ge.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,$.min(),$.min(),Ge.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual($.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ge.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ge.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=$.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var li=class{constructor(e,t){this.position=e,this.inclusive=t}};function wf(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){let s=e[r],a=n.position[r];if(s.field.isKeyField()?i=V.comparator(V.fromName(a.referenceValue),t.key):i=ci(a,t.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function Af(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!rt(n.position[t],e.position[t]))return!1;return!0}var hi=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function Iv(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Us=class{},he=class n extends Us{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new Dc(e,t,i):t==="array-contains"?new kc(e,i):t==="in"?new xc(e,i):t==="not-in"?new Lc(e,i):t==="array-contains-any"?new Mc(e,i):new n(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new Nc(e,i):new Oc(e,i)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(ci(t,this.value)):t!==null&&Tn(this.value)===Tn(t)&&this.matchesComparison(ci(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return U()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},He=class n extends Us{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return tp(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function tp(n){return n.op==="and"}function np(n){return vv(n)&&tp(n)}function vv(n){for(let e of n.filters)if(e instanceof He)return!1;return!0}function Pc(n){if(n instanceof he)return n.field.canonicalString()+n.op.toString()+ui(n.value);if(np(n))return n.filters.map(e=>Pc(e)).join(",");{let e=n.filters.map(t=>Pc(t)).join(",");return`${n.op}(${e})`}}function ip(n,e){return n instanceof he?function(i,r){return r instanceof he&&i.op===r.op&&i.field.isEqual(r.field)&&rt(i.value,r.value)}(n,e):n instanceof He?function(i,r){return r instanceof He&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce((s,a,c)=>s&&ip(a,r.filters[c]),!0):!1}(n,e):void U()}function rp(n){return n instanceof he?function(t){return`${t.field.canonicalString()} ${t.op} ${ui(t.value)}`}(n):n instanceof He?function(t){return t.op.toString()+" {"+t.getFilters().map(rp).join(" ,")+"}"}(n):"Filter"}var Dc=class extends he{constructor(e,t,i){super(e,t,i),this.key=V.fromName(i.referenceValue)}matches(e){let t=V.comparator(e.key,this.key);return this.matchesComparison(t)}},Nc=class extends he{constructor(e,t){super(e,"in",t),this.keys=sp("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Oc=class extends he{constructor(e,t){super(e,"not-in",t),this.keys=sp("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function sp(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(i=>V.fromName(i.referenceValue))}var kc=class extends he{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return tl(t)&&hr(t.arrayValue,this.value)}},xc=class extends he{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&hr(this.value.arrayValue,t)}},Lc=class extends he{constructor(e,t){super(e,"not-in",t)}matches(e){if(hr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!hr(this.value.arrayValue,t)}},Mc=class extends he{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!tl(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>hr(this.value.arrayValue,i))}};var Vc=class{constructor(e,t=null,i=[],r=[],s=null,a=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=a,this.endAt=c,this.ue=null}};function bf(n,e=null,t=[],i=[],r=null,s=null,a=null){return new Vc(n,e,t,i,r,s,a)}function nl(n){let e=q(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>Pc(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>function(s){return s.field.canonicalString()+s.dir}(i)).join(","),ao(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>ui(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>ui(i)).join(",")),e.ue=t}return e.ue}function il(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Iv(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!ip(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Af(n.startAt,e.startAt)&&Af(n.endAt,e.endAt)}function Fc(n){return V.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var wn=class{constructor(e,t=null,i=[],r=[],s=null,a="F",c=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=a,this.startAt=c,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function Ev(n,e,t,i,r,s,a,c){return new wn(n,e,t,i,r,s,a,c)}function op(n){return new wn(n)}function Sf(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function ap(n){return n.collectionGroup!==null}function or(n){let e=q(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new Re(Me.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(d=>{d.isInequality()&&(c=c.add(d.field))})}),c})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new hi(s,i))}),t.has(Me.keyField().canonicalString())||e.ce.push(new hi(Me.keyField(),i))}return e.ce}function nt(n){let e=q(n);return e.le||(e.le=Tv(e,or(n))),e.le}function Tv(n,e){if(n.limitType==="F")return bf(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(r=>{let s=r.dir==="desc"?"asc":"desc";return new hi(r.field,s)});let t=n.endAt?new li(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new li(n.startAt.position,n.startAt.inclusive):null;return bf(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function Uc(n,e){let t=n.filters.concat([e]);return new wn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Bc(n,e,t){return new wn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function co(n,e){return il(nt(n),nt(e))&&n.limitType===e.limitType}function cp(n){return`${nl(nt(n))}|lt:${n.limitType}`}function Zn(n){return`Query(target=${function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(r=>rp(r)).join(", ")}]`),ao(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(r=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(r)).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(r=>ui(r)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(r=>ui(r)).join(",")),`Target(${i})`}(nt(n))}; limitType=${n.limitType})`}function uo(n,e){return e.isFoundDocument()&&function(i,r){let s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):V.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)}(n,e)&&function(i,r){for(let s of or(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(n,e)&&function(i,r){for(let s of i.filters)if(!s.matches(r))return!1;return!0}(n,e)&&function(i,r){return!(i.startAt&&!function(a,c,l){let d=wf(a,c,l);return a.inclusive?d<=0:d<0}(i.startAt,or(i),r)||i.endAt&&!function(a,c,l){let d=wf(a,c,l);return a.inclusive?d>=0:d>0}(i.endAt,or(i),r))}(n,e)}function wv(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function up(n){return(e,t)=>{let i=!1;for(let r of or(n)){let s=Av(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function Av(n,e,t){let i=n.field.isKeyField()?V.comparator(e.key,t.key):function(s,a,c){let l=a.data.field(s),d=c.data.field(s);return l!==null&&d!==null?ci(l,d):U()}(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return U()}}var jt=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(let[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Ei(this.inner,(t,i)=>{for(let[r,s]of i)e(r,s)})}isEmpty(){return Jf(this.inner)}size(){return this.innerSize}};var bv=new ae(V.comparator);function Tt(){return bv}var lp=new ae(V.comparator);function rr(...n){let e=lp;for(let t of n)e=e.insert(t.key,t);return e}function hp(n){let e=lp;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function yn(){return ar()}function dp(){return ar()}function ar(){return new jt(n=>n.toString(),(n,e)=>n.isEqual(e))}var Sv=new ae(V.comparator),Rv=new Re(V.comparator);function j(...n){let e=Rv;for(let t of n)e=e.add(t);return e}var Cv=new Re(Y);function Pv(){return Cv}function rl(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ur(e)?"-0":e}}function fp(n){return{integerValue:""+n}}function Dv(n,e){return fv(e)?fp(e):rl(n,e)}var di=class{constructor(){this._=void 0}};function Nv(n,e,t){return n instanceof fi?function(r,s){let a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&Zu(s)&&(s=el(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(t,e):n instanceof An?mp(n,e):n instanceof bn?gp(n,e):function(r,s){let a=pp(r,s),c=Rf(a)+Rf(r.Pe);return Cc(a)&&Cc(r.Pe)?fp(c):rl(r.serializer,c)}(n,e)}function Ov(n,e,t){return n instanceof An?mp(n,e):n instanceof bn?gp(n,e):t}function pp(n,e){return n instanceof pi?function(i){return Cc(i)||function(s){return!!s&&"doubleValue"in s}(i)}(e)?e:{integerValue:0}:null}var fi=class extends di{},An=class extends di{constructor(e){super(),this.elements=e}};function mp(n,e){let t=_p(e);for(let i of n.elements)t.some(r=>rt(r,i))||t.push(i);return{arrayValue:{values:t}}}var bn=class extends di{constructor(e){super(),this.elements=e}};function gp(n,e){let t=_p(e);for(let i of n.elements)t=t.filter(r=>!rt(r,i));return{arrayValue:{values:t}}}var pi=class extends di{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function Rf(n){return ie(n.integerValue||n.doubleValue)}function _p(n){return tl(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function kv(n,e){return n.field.isEqual(e.field)&&function(i,r){return i instanceof An&&r instanceof An||i instanceof bn&&r instanceof bn?ai(i.elements,r.elements,rt):i instanceof pi&&r instanceof pi?rt(i.Pe,r.Pe):i instanceof fi&&r instanceof fi}(n.transform,e.transform)}var qc=class{constructor(e,t){this.version=e,this.transformResults=t}},Wt=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Os(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var mi=class{};function yp(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new dr(n.key,Wt.none()):new Sn(n.key,n.data,Wt.none());{let t=n.data,i=Ge.empty(),r=new Re(Me.comparator);for(let s of e.fields)if(!r.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?i.delete(s):i.set(s,a),r=r.add(s)}return new wt(n.key,i,new Ze(r.toArray()),Wt.none())}}function xv(n,e,t){n instanceof Sn?function(r,s,a){let c=r.value.clone(),l=Pf(r.fieldTransforms,s,a.transformResults);c.setAll(l),s.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(n,e,t):n instanceof wt?function(r,s,a){if(!Os(r.precondition,s))return void s.convertToUnknownDocument(a.version);let c=Pf(r.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(Ip(r)),l.setAll(c),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(n,e,t):function(r,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function cr(n,e,t,i){return n instanceof Sn?function(s,a,c,l){if(!Os(s.precondition,a))return c;let d=s.value.clone(),p=Df(s.fieldTransforms,l,a);return d.setAll(p),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(n,e,t,i):n instanceof wt?function(s,a,c,l){if(!Os(s.precondition,a))return c;let d=Df(s.fieldTransforms,l,a),p=a.data;return p.setAll(Ip(s)),p.setAll(d),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),c===null?null:c.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(I=>I.field))}(n,e,t,i):function(s,a,c){return Os(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c}(n,e,t)}function Lv(n,e){let t=null;for(let i of n.fieldTransforms){let r=e.data.field(i.field),s=pp(i.transform,r||null);s!=null&&(t===null&&(t=Ge.empty()),t.set(i.field,s))}return t||null}function Cf(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&ai(i,r,(s,a)=>kv(s,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Sn=class extends mi{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}},wt=class extends mi{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function Ip(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let i=n.data.field(t);e.set(t,i)}}),e}function Pf(n,e,t){let i=new Map;X(n.length===t.length);for(let r=0;r<t.length;r++){let s=n[r],a=s.transform,c=e.data.field(s.field);i.set(s.field,Ov(a,c,t[r]))}return i}function Df(n,e,t){let i=new Map;for(let r of n){let s=r.transform,a=t.data.field(r.field);i.set(r.field,Nv(s,a,e))}return i}var dr=class extends mi{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},$c=class extends mi{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Wc=class{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){let i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){let s=this.mutations[r];s.key.isEqual(e.key)&&xv(s,e,i[r])}}applyToLocalView(e,t){for(let i of this.baseMutations)i.key.isEqual(e.key)&&(t=cr(i,e,t,this.localWriteTime));for(let i of this.mutations)i.key.isEqual(e.key)&&(t=cr(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let i=dp();return this.mutations.forEach(r=>{let s=e.get(r.key),a=s.overlayedDocument,c=this.applyToLocalView(a,s.mutatedFields);c=t.has(r.key)?null:c;let l=yp(a,c);l!==null&&i.set(r.key,l),a.isValidDocument()||a.convertToNoDocument($.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),j())}isEqual(e){return this.batchId===e.batchId&&ai(this.mutations,e.mutations,(t,i)=>Cf(t,i))&&ai(this.baseMutations,e.baseMutations,(t,i)=>Cf(t,i))}},zc=class n{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){X(e.mutations.length===i.length);let r=function(){return Sv}(),s=e.mutations;for(let a=0;a<s.length;a++)r=r.insert(s[a].key,i[a].version);return new n(e,t,i,r)}};var Gc=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var jc=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var ue,K;function Mv(n){switch(n){default:return U();case C.CANCELLED:case C.UNKNOWN:case C.DEADLINE_EXCEEDED:case C.RESOURCE_EXHAUSTED:case C.INTERNAL:case C.UNAVAILABLE:case C.UNAUTHENTICATED:return!1;case C.INVALID_ARGUMENT:case C.NOT_FOUND:case C.ALREADY_EXISTS:case C.PERMISSION_DENIED:case C.FAILED_PRECONDITION:case C.ABORTED:case C.OUT_OF_RANGE:case C.UNIMPLEMENTED:case C.DATA_LOSS:return!0}}function vp(n){if(n===void 0)return vt("GRPC error has no .code"),C.UNKNOWN;switch(n){case ue.OK:return C.OK;case ue.CANCELLED:return C.CANCELLED;case ue.UNKNOWN:return C.UNKNOWN;case ue.DEADLINE_EXCEEDED:return C.DEADLINE_EXCEEDED;case ue.RESOURCE_EXHAUSTED:return C.RESOURCE_EXHAUSTED;case ue.INTERNAL:return C.INTERNAL;case ue.UNAVAILABLE:return C.UNAVAILABLE;case ue.UNAUTHENTICATED:return C.UNAUTHENTICATED;case ue.INVALID_ARGUMENT:return C.INVALID_ARGUMENT;case ue.NOT_FOUND:return C.NOT_FOUND;case ue.ALREADY_EXISTS:return C.ALREADY_EXISTS;case ue.PERMISSION_DENIED:return C.PERMISSION_DENIED;case ue.FAILED_PRECONDITION:return C.FAILED_PRECONDITION;case ue.ABORTED:return C.ABORTED;case ue.OUT_OF_RANGE:return C.OUT_OF_RANGE;case ue.UNIMPLEMENTED:return C.UNIMPLEMENTED;case ue.DATA_LOSS:return C.DATA_LOSS;default:return U()}}(K=ue||(ue={}))[K.OK=0]="OK",K[K.CANCELLED=1]="CANCELLED",K[K.UNKNOWN=2]="UNKNOWN",K[K.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",K[K.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",K[K.NOT_FOUND=5]="NOT_FOUND",K[K.ALREADY_EXISTS=6]="ALREADY_EXISTS",K[K.PERMISSION_DENIED=7]="PERMISSION_DENIED",K[K.UNAUTHENTICATED=16]="UNAUTHENTICATED",K[K.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",K[K.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",K[K.ABORTED=10]="ABORTED",K[K.OUT_OF_RANGE=11]="OUT_OF_RANGE",K[K.UNIMPLEMENTED=12]="UNIMPLEMENTED",K[K.INTERNAL=13]="INTERNAL",K[K.UNAVAILABLE=14]="UNAVAILABLE",K[K.DATA_LOSS=15]="DATA_LOSS";var Nf=null;function Vv(){return new TextEncoder}var Fv=new $t([4294967295,4294967295],0);function Of(n){let e=Vv().encode(n),t=new ac;return t.update(e),new Uint8Array(t.digest())}function kf(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new $t([t,i],0),new $t([r,s],0)]}var Hc=class n{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new In(`Invalid padding: ${t}`);if(i<0)throw new In(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new In(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new In(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=$t.fromNumber(this.Ie)}Ee(e,t,i){let r=e.add(t.multiply($t.fromNumber(i)));return r.compare(Fv)===1&&(r=new $t([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=Of(e),[i,r]=kf(t);for(let s=0;s<this.hashCount;s++){let a=this.Ee(i,r,s);if(!this.de(a))return!1}return!0}static create(e,t,i){let r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new n(s,r,t);return i.forEach(c=>a.insert(c)),a}insert(e){if(this.Ie===0)return;let t=Of(e),[i,r]=kf(t);for(let s=0;s<this.hashCount;s++){let a=this.Ee(i,r,s);this.Ae(a)}}Ae(e){let t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}},In=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Bs=class n{constructor(e,t,i,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,i){let r=new Map;return r.set(e,fr.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new n($.min(),r,new ae(Y),Tt(),j())}},fr=class n{constructor(e,t,i,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new n(i,t,j(),j(),j())}};var ri=class{constructor(e,t,i,r){this.Re=e,this.removedTargetIds=t,this.key=i,this.Ve=r}},qs=class{constructor(e,t){this.targetId=e,this.me=t}},$s=class{constructor(e,t,i=Ce.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}},Ws=class{constructor(){this.fe=0,this.ge=Lf(),this.pe=Ce.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=j(),t=j(),i=j();return this.ge.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:U()}}),new fr(this.pe,this.ye,e,t,i)}Ce(){this.we=!1,this.ge=Lf()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,X(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},Kc=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=Tt(),this.qe=xf(),this.Qe=new ae(Y)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let i=this.Ge(t);switch(e.state){case 0:this.ze(t)&&i.De(e.resumeToken);break;case 1:i.Oe(),i.Se||i.Ce(),i.De(e.resumeToken);break;case 2:i.Oe(),i.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(i.Ne(),i.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),i.De(e.resumeToken));break;default:U()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((i,r)=>{this.ze(r)&&t(r)})}He(e){let t=e.targetId,i=e.me.count,r=this.Je(t);if(r){let s=r.target;if(Fc(s))if(i===0){let a=new V(s.path);this.Ue(t,a,je.newNoDocument(a,$.min()))}else X(i===1);else{let a=this.Ye(t);if(a!==i){let c=this.Ze(e),l=c?this.Xe(c,e,a):1;if(l!==0){this.je(t);let d=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,d)}Nf?.et(function(p,I,b,R,D){var k,O,z,W,H,te;let De={localCacheCount:p,existenceFilterCount:I.count,databaseId:b.database,projectId:b.projectId},J=I.unchangedNames;return J&&(De.bloomFilter={applied:D===0,hashCount:(k=J?.hashCount)!==null&&k!==void 0?k:0,bitmapLength:(W=(z=(O=J?.bits)===null||O===void 0?void 0:O.bitmap)===null||z===void 0?void 0:z.length)!==null&&W!==void 0?W:0,padding:(te=(H=J?.bits)===null||H===void 0?void 0:H.padding)!==null&&te!==void 0?te:0,mightContain:E=>{var m;return(m=R?.mightContain(E))!==null&&m!==void 0&&m}}),De}(a,e.me,this.Le.tt(),c,l))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:i="",padding:r=0},hashCount:s=0}=t,a,c;try{a=Gt(i).toUint8Array()}catch(l){if(l instanceof Vs)return oi("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{c=new Hc(a,r,s)}catch(l){return oi(l instanceof In?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return c.Ie===0?null:c}Xe(e,t,i){return t.me.count===i-this.nt(e,t.targetId)?0:2}nt(e,t){let i=this.Le.getRemoteKeysForTarget(t),r=0;return i.forEach(s=>{let a=this.Le.tt(),c=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(c)||(this.Ue(t,s,null),r++)}),r}rt(e){let t=new Map;this.Be.forEach((s,a)=>{let c=this.Je(a);if(c){if(s.current&&Fc(c.target)){let l=new V(c.target.path);this.ke.get(l)!==null||this.it(a,l)||this.Ue(a,l,je.newNoDocument(l,e))}s.be&&(t.set(a,s.ve()),s.Ce())}});let i=j();this.qe.forEach((s,a)=>{let c=!0;a.forEachWhile(l=>{let d=this.Je(l);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(i=i.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));let r=new Bs(e,t,this.Qe,this.ke,i);return this.ke=Tt(),this.qe=xf(),this.Qe=new ae(Y),r}$e(e,t){if(!this.ze(e))return;let i=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,i),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,i){if(!this.ze(e))return;let r=this.Ge(e);this.it(e,t)?r.Fe(t,1):r.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),i&&(this.ke=this.ke.insert(t,i))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Ws,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Re(Y),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||L("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Ws),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function xf(){return new ae(V.comparator)}function Lf(){return new ae(V.comparator)}var Uv={asc:"ASCENDING",desc:"DESCENDING"},Bv={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},qv={and:"AND",or:"OR"},Qc=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Yc(n,e){return n.useProto3Json||ao(e)?e:{value:e}}function zs(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ep(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function $v(n,e){return zs(n,e.toTimestamp())}function it(n){return X(!!n),$.fromTimestamp(function(t){let i=Et(t);return new Ee(i.seconds,i.nanos)}(n))}function sl(n,e){return Jc(n,e).canonicalString()}function Jc(n,e){let t=function(r){return new re(["projects",r.projectId,"databases",r.database])}(n).child("documents");return e===void 0?t:t.child(e)}function Tp(n){let e=re.fromString(n);return X(Rp(e)),e}function Xc(n,e){return sl(n.databaseId,e.path)}function fc(n,e){let t=Tp(e);if(t.get(1)!==n.databaseId.projectId)throw new x(C.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new x(C.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new V(Ap(t))}function wp(n,e){return sl(n.databaseId,e)}function Wv(n){let e=Tp(n);return e.length===4?re.emptyPath():Ap(e)}function Zc(n){return new re(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Ap(n){return X(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Mf(n,e,t){return{name:Xc(n,e),fields:t.value.mapValue.fields}}function zv(n,e){let t;if("targetChange"in e){e.targetChange;let i=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:U()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=function(d,p){return d.useProto3Json?(X(p===void 0||typeof p=="string"),Ce.fromBase64String(p||"")):(X(p===void 0||p instanceof Buffer||p instanceof Uint8Array),Ce.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&function(d){let p=d.code===void 0?C.UNKNOWN:vp(d.code);return new x(p,d.message||"")}(a);t=new $s(i,r,s,c||null)}else if("documentChange"in e){e.documentChange;let i=e.documentChange;i.document,i.document.name,i.document.updateTime;let r=fc(n,i.document.name),s=it(i.document.updateTime),a=i.document.createTime?it(i.document.createTime):$.min(),c=new Ge({mapValue:{fields:i.document.fields}}),l=je.newFoundDocument(r,s,a,c),d=i.targetIds||[],p=i.removedTargetIds||[];t=new ri(d,p,l.key,l)}else if("documentDelete"in e){e.documentDelete;let i=e.documentDelete;i.document;let r=fc(n,i.document),s=i.readTime?it(i.readTime):$.min(),a=je.newNoDocument(r,s),c=i.removedTargetIds||[];t=new ri([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;let i=e.documentRemove;i.document;let r=fc(n,i.document),s=i.removedTargetIds||[];t=new ri([],s,r,null)}else{if(!("filter"in e))return U();{e.filter;let i=e.filter;i.targetId;let{count:r=0,unchangedNames:s}=i,a=new jc(r,s),c=i.targetId;t=new qs(c,a)}}return t}function Gv(n,e){let t;if(e instanceof Sn)t={update:Mf(n,e.key,e.value)};else if(e instanceof dr)t={delete:Xc(n,e.key)};else if(e instanceof wt)t={update:Mf(n,e.key,e.data),updateMask:eE(e.fieldMask)};else{if(!(e instanceof $c))return U();t={verify:Xc(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(s,a){let c=a.transform;if(c instanceof fi)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof An)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof bn)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof pi)return{fieldPath:a.field.canonicalString(),increment:c.Pe};throw U()}(0,i))),e.precondition.isNone||(t.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:$v(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:U()}(n,e.precondition)),t}function jv(n,e){return n&&n.length>0?(X(e!==void 0),n.map(t=>function(r,s){let a=r.updateTime?it(r.updateTime):it(s);return a.isEqual($.min())&&(a=it(s)),new qc(a,r.transformResults||[])}(t,e))):[]}function Hv(n,e){return{documents:[wp(n,e.path)]}}function Kv(n,e){let t={structuredQuery:{}},i=e.path,r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=wp(n,r);let s=function(d){if(d.length!==0)return Sp(He.create(d,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let a=function(d){if(d.length!==0)return d.map(p=>function(b){return{field:ei(b.field),direction:Jv(b.dir)}}(p))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);let c=Yc(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:t,parent:r}}function Qv(n){let e=Wv(n.parent),t=n.structuredQuery,i=t.from?t.from.length:0,r=null;if(i>0){X(i===1);let p=t.from[0];p.allDescendants?r=p.collectionId:e=e.child(p.collectionId)}let s=[];t.where&&(s=function(I){let b=bp(I);return b instanceof He&&np(b)?b.getFilters():[b]}(t.where));let a=[];t.orderBy&&(a=function(I){return I.map(b=>function(D){return new hi(ti(D.field),function(O){switch(O){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(D.direction))}(b))}(t.orderBy));let c=null;t.limit&&(c=function(I){let b;return b=typeof I=="object"?I.value:I,ao(b)?null:b}(t.limit));let l=null;t.startAt&&(l=function(I){let b=!!I.before,R=I.values||[];return new li(R,b)}(t.startAt));let d=null;return t.endAt&&(d=function(I){let b=!I.before,R=I.values||[];return new li(R,b)}(t.endAt)),Ev(e,r,a,s,c,"F",l,d)}function Yv(n,e){let t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return U()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function bp(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let i=ti(t.unaryFilter.field);return he.create(i,"==",{doubleValue:NaN});case"IS_NULL":let r=ti(t.unaryFilter.field);return he.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=ti(t.unaryFilter.field);return he.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=ti(t.unaryFilter.field);return he.create(a,"!=",{nullValue:"NULL_VALUE"});default:return U()}}(n):n.fieldFilter!==void 0?function(t){return he.create(ti(t.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return U()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return He.create(t.compositeFilter.filters.map(i=>bp(i)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return U()}}(t.compositeFilter.op))}(n):U()}function Jv(n){return Uv[n]}function Xv(n){return Bv[n]}function Zv(n){return qv[n]}function ei(n){return{fieldPath:n.canonicalString()}}function ti(n){return Me.fromServerFormat(n.fieldPath)}function Sp(n){return n instanceof he?function(t){if(t.op==="=="){if(Tf(t.value))return{unaryFilter:{field:ei(t.field),op:"IS_NAN"}};if(Ef(t.value))return{unaryFilter:{field:ei(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Tf(t.value))return{unaryFilter:{field:ei(t.field),op:"IS_NOT_NAN"}};if(Ef(t.value))return{unaryFilter:{field:ei(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ei(t.field),op:Xv(t.op),value:t.value}}}(n):n instanceof He?function(t){let i=t.getFilters().map(r=>Sp(r));return i.length===1?i[0]:{compositeFilter:{op:Zv(t.op),filters:i}}}(n):U()}function eE(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Rp(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var pr=class n{constructor(e,t,i,r,s=$.min(),a=$.min(),c=Ce.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=l}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var eu=class{constructor(e){this.ct=e}};function tE(n){let e=Qv({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Bc(e,e.limit,"L"):e}var Gs=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(ie(e.integerValue));else if("doubleValue"in e){let i=ie(e.doubleValue);isNaN(i)?this.dt(t,13):(this.dt(t,15),ur(i)?t.At(0):t.At(i))}else if("timestampValue"in e){let i=e.timestampValue;this.dt(t,20),typeof i=="string"&&(i=Et(i)),t.Rt(`${i.seconds||""}`),t.At(i.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Gt(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let i=e.geoPointValue;this.dt(t,45),t.At(i.latitude||0),t.At(i.longitude||0)}else"mapValue"in e?Zf(e)?this.dt(t,Number.MAX_SAFE_INTEGER):Xf(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):U()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let i=e.fields||{};this.dt(t,55);for(let r of Object.keys(i))this.Vt(r,t),this.Tt(i[r],t)}wt(e,t){var i,r;let s=e.fields||{};this.dt(t,53);let a="value",c=((r=(i=s[a].arrayValue)===null||i===void 0?void 0:i.values)===null||r===void 0?void 0:r.length)||0;this.dt(t,15),t.At(ie(c)),this.Vt(a,t),this.Tt(s[a],t)}bt(e,t){let i=e.values||[];this.dt(t,50);for(let r of i)this.Tt(r,t)}yt(e,t){this.dt(t,37),V.fromName(e).path.forEach(i=>{this.dt(t,60),this.Dt(i,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};Gs.vt=new Gs;var tu=class{constructor(){this.un=new nu}addToCollectionParentIndex(e,t){return this.un.add(t),P.resolve()}getCollectionParents(e,t){return P.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return P.resolve()}deleteFieldIndex(e,t){return P.resolve()}deleteAllFieldIndexes(e){return P.resolve()}createTargetIndexes(e,t){return P.resolve()}getDocumentsMatchingTarget(e,t){return P.resolve(null)}getIndexType(e,t){return P.resolve(0)}getFieldIndexes(e,t){return P.resolve([])}getNextCollectionGroupToUpdate(e){return P.resolve(null)}getMinOffset(e,t){return P.resolve(En.min())}getMinOffsetFromCollectionGroup(e,t){return P.resolve(En.min())}updateCollectionGroup(e,t,i){return P.resolve()}updateIndexEntries(e,t){return P.resolve()}},nu=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new Re(re.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new Re(re.comparator)).toArray()}};var xb=new Uint8Array(0);var Xe=class n{constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};Xe.DEFAULT_COLLECTION_PERCENTILE=10,Xe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Xe.DEFAULT=new Xe(41943040,Xe.DEFAULT_COLLECTION_PERCENTILE,Xe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Xe.DISABLED=new Xe(-1,0,0);var mr=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var iu=class{constructor(){this.changes=new jt(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,je.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let i=this.changes.get(t);return i!==void 0?P.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var ru=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var su=class{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(i=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(i!==null&&cr(i.mutation,r,Ze.empty(),Ee.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,j()).next(()=>i))}getLocalViewOfDocuments(e,t,i=j()){let r=yn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,i).next(s=>{let a=rr();return s.forEach((c,l)=>{a=a.insert(c,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let i=yn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,j()))}populateOverlays(e,t,i){let r=[];return i.forEach(s=>{t.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((a,c)=>{t.set(a,c)})})}computeViews(e,t,i,r){let s=Tt(),a=ar(),c=function(){return ar()}();return t.forEach((l,d)=>{let p=i.get(d.key);r.has(d.key)&&(p===void 0||p.mutation instanceof wt)?s=s.insert(d.key,d):p!==void 0?(a.set(d.key,p.mutation.getFieldMask()),cr(p.mutation,d,p.mutation.getFieldMask(),Ee.now())):a.set(d.key,Ze.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((d,p)=>a.set(d,p)),t.forEach((d,p)=>{var I;return c.set(d,new ru(p,(I=a.get(d))!==null&&I!==void 0?I:null))}),c))}recalculateAndSaveOverlays(e,t){let i=ar(),r=new ae((a,c)=>a-c),s=j();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let c of a)c.keys().forEach(l=>{let d=t.get(l);if(d===null)return;let p=i.get(l)||Ze.empty();p=c.applyToLocalView(d,p),i.set(l,p);let I=(r.get(c.batchId)||j()).add(l);r=r.insert(c.batchId,I)})}).next(()=>{let a=[],c=r.getReverseIterator();for(;c.hasNext();){let l=c.getNext(),d=l.key,p=l.value,I=dp();p.forEach(b=>{if(!s.has(b)){let R=yp(t.get(b),i.get(b));R!==null&&I.set(b,R),s=s.add(b)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,I))}return P.waitFor(a)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,r){return function(a){return V.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):ap(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next(s=>{let a=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):P.resolve(yn()),c=-1,l=s;return a.next(d=>P.forEach(d,(p,I)=>(c<I.largestBatchId&&(c=I.largestBatchId),s.get(p)?P.resolve():this.remoteDocumentCache.getEntry(e,p).next(b=>{l=l.insert(p,b)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,l,d,j())).next(p=>({batchId:c,changes:hp(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new V(t)).next(i=>{let r=rr();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){let s=t.collectionGroup,a=rr();return this.indexManager.getCollectionParents(e,s).next(c=>P.forEach(c,l=>{let d=function(I,b){return new wn(b,null,I.explicitOrderBy.slice(),I.filters.slice(),I.limit,I.limitType,I.startAt,I.endAt)}(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,i,r).next(p=>{p.forEach((I,b)=>{a=a.insert(I,b)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r))).next(a=>{s.forEach((l,d)=>{let p=d.getKey();a.get(p)===null&&(a=a.insert(p,je.newInvalidDocument(p)))});let c=rr();return a.forEach((l,d)=>{let p=s.get(l);p!==void 0&&cr(p.mutation,d,Ze.empty(),Ee.now()),uo(t,d)&&(c=c.insert(l,d))}),c})}};var ou=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return P.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(r){return{id:r.id,version:r.version,createTime:it(r.createTime)}}(t)),P.resolve()}getNamedQuery(e,t){return P.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(r){return{name:r.name,query:tE(r.bundledQuery),readTime:it(r.readTime)}}(t)),P.resolve()}};var au=class{constructor(){this.overlays=new ae(V.comparator),this.Ir=new Map}getOverlay(e,t){return P.resolve(this.overlays.get(t))}getOverlays(e,t){let i=yn();return P.forEach(t,r=>this.getOverlay(e,r).next(s=>{s!==null&&i.set(r,s)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((r,s)=>{this.ht(e,t,s)}),P.resolve()}removeOverlaysForBatchId(e,t,i){let r=this.Ir.get(i);return r!==void 0&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(i)),P.resolve()}getOverlaysForCollection(e,t,i){let r=yn(),s=t.length+1,a=new V(t.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){let l=c.getNext().value,d=l.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===s&&l.largestBatchId>i&&r.set(l.getKey(),l)}return P.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new ae((d,p)=>d-p),a=this.overlays.getIterator();for(;a.hasNext();){let d=a.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>i){let p=s.get(d.largestBatchId);p===null&&(p=yn(),s=s.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}let c=yn(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((d,p)=>c.set(d,p)),!(c.size()>=r)););return P.resolve(c)}ht(e,t,i){let r=this.overlays.get(i.key);if(r!==null){let a=this.Ir.get(r.largestBatchId).delete(i.key);this.Ir.set(r.largestBatchId,a)}this.overlays=this.overlays.insert(i.key,new Gc(t,i));let s=this.Ir.get(t);s===void 0&&(s=j(),this.Ir.set(t,s)),this.Ir.set(t,s.add(i.key))}};var cu=class{constructor(){this.sessionToken=Ce.EMPTY_BYTE_STRING}getSessionToken(e){return P.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,P.resolve()}};var gr=class{constructor(){this.Tr=new Re(le.Er),this.dr=new Re(le.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let i=new le(e,t);this.Tr=this.Tr.add(i),this.dr=this.dr.add(i)}Rr(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.Vr(new le(e,t))}mr(e,t){e.forEach(i=>this.removeReference(i,t))}gr(e){let t=new V(new re([])),i=new le(t,e),r=new le(t,e+1),s=[];return this.dr.forEachInRange([i,r],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new V(new re([])),i=new le(t,e),r=new le(t,e+1),s=j();return this.dr.forEachInRange([i,r],a=>{s=s.add(a.key)}),s}containsKey(e){let t=new le(e,0),i=this.Tr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}},le=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return V.comparator(e.key,t.key)||Y(e.wr,t.wr)}static Ar(e,t){return Y(e.wr,t.wr)||V.comparator(e.key,t.key)}};var uu=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Re(le.Er)}checkEmpty(e){return P.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){let s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new Wc(s,t,i,r);this.mutationQueue.push(a);for(let c of r)this.br=this.br.add(new le(c.key,s)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return P.resolve(a)}lookupMutationBatch(e,t){return P.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let i=t+1,r=this.vr(i),s=r<0?0:r;return P.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return P.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return P.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let i=new le(t,0),r=new le(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([i,r],a=>{let c=this.Dr(a.wr);s.push(c)}),P.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Re(Y);return t.forEach(r=>{let s=new le(r,0),a=new le(r,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],c=>{i=i.add(c.wr)})}),P.resolve(this.Cr(i))}getAllMutationBatchesAffectingQuery(e,t){let i=t.path,r=i.length+1,s=i;V.isDocumentKey(s)||(s=s.child(""));let a=new le(new V(s),0),c=new Re(Y);return this.br.forEachWhile(l=>{let d=l.key.path;return!!i.isPrefixOf(d)&&(d.length===r&&(c=c.add(l.wr)),!0)},a),P.resolve(this.Cr(c))}Cr(e){let t=[];return e.forEach(i=>{let r=this.Dr(i);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){X(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let i=this.br;return P.forEach(t.mutations,r=>{let s=new le(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.br=i})}On(e){}containsKey(e,t){let i=new le(t,0),r=this.br.firstAfterOrEqual(i);return P.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,P.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var lu=class{constructor(e){this.Mr=e,this.docs=function(){return new ae(V.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let i=t.key,r=this.docs.get(i),s=r?r.size:0,a=this.Mr(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let i=this.docs.get(t);return P.resolve(i?i.document.mutableCopy():je.newInvalidDocument(t))}getEntries(e,t){let i=Tt();return t.forEach(r=>{let s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():je.newInvalidDocument(r))}),P.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=Tt(),a=t.path,c=new V(a.child("")),l=this.docs.getIteratorFrom(c);for(;l.hasNext();){let{key:d,value:{document:p}}=l.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||lv(uv(p),i)<=0||(r.has(p.key)||uo(t,p))&&(s=s.insert(p.key,p.mutableCopy()))}return P.resolve(s)}getAllFromCollectionGroup(e,t,i,r){U()}Or(e,t){return P.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new hu(this)}getSize(e){return P.resolve(this.size)}},hu=class extends iu{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?t.push(this.cr.addEntry(e,r)):this.cr.removeEntry(i)}),P.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var du=class{constructor(e){this.persistence=e,this.Nr=new jt(t=>nl(t),il),this.lastRemoteSnapshotVersion=$.min(),this.highestTargetId=0,this.Lr=0,this.Br=new gr,this.targetCount=0,this.kr=mr.Bn()}forEachTarget(e,t){return this.Nr.forEach((i,r)=>t(r)),P.resolve()}getLastRemoteSnapshotVersion(e){return P.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return P.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),P.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.Lr&&(this.Lr=t),P.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new mr(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,P.resolve()}updateTargetData(e,t){return this.Kn(t),P.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,P.resolve()}removeTargets(e,t,i){let r=0,s=[];return this.Nr.forEach((a,c)=>{c.sequenceNumber<=t&&i.get(c.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,c.targetId)),r++)}),P.waitFor(s).next(()=>r)}getTargetCount(e){return P.resolve(this.targetCount)}getTargetData(e,t){let i=this.Nr.get(t)||null;return P.resolve(i)}addMatchingKeys(e,t,i){return this.Br.Rr(t,i),P.resolve()}removeMatchingKeys(e,t,i){this.Br.mr(t,i);let r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(a=>{s.push(r.markPotentiallyOrphaned(e,a))}),P.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),P.resolve()}getMatchingKeysForTargetId(e,t){let i=this.Br.yr(t);return P.resolve(i)}containsKey(e,t){return P.resolve(this.Br.containsKey(t))}};var fu=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Yf(0),this.Kr=!1,this.Kr=!0,this.$r=new cu,this.referenceDelegate=e(this),this.Ur=new du(this),this.indexManager=new tu,this.remoteDocumentCache=function(r){return new lu(r)}(i=>this.referenceDelegate.Wr(i)),this.serializer=new eu(t),this.Gr=new ou(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new au,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.qr[e.toKey()];return i||(i=new uu(t,this.referenceDelegate),this.qr[e.toKey()]=i),i}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,i){L("MemoryPersistence","Starting transaction:",e);let r=new pu(this.Qr.next());return this.referenceDelegate.zr(),i(r).next(s=>this.referenceDelegate.jr(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}Hr(e,t){return P.or(Object.values(this.qr).map(i=>()=>i.containsKey(e,t)))}},pu=class extends bc{constructor(e){super(),this.currentSequenceNumber=e}},mu=class n{constructor(e){this.persistence=e,this.Jr=new gr,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw U()}addReference(e,t,i){return this.Jr.addReference(i,t),this.Xr.delete(i.toString()),P.resolve()}removeReference(e,t,i){return this.Jr.removeReference(i,t),this.Xr.add(i.toString()),P.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),P.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(r=>this.Xr.add(r.toString()));let i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(s=>this.Xr.add(s.toString()))}).next(()=>i.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return P.forEach(this.Xr,i=>{let r=V.fromPath(i);return this.ei(e,r).next(s=>{s||t.removeEntry(r,$.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(i=>{i?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return P.or([()=>P.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var gu=class n{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.$i=i,this.Ui=r}static Wi(e,t){let i=j(),r=j();for(let s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new n(e,t.fromCache,i,r)}};var _u=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var yu=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return td()?8:dv(pe())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,i,r){let s={result:null};return this.Yi(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,t,r,i).next(a=>{s.result=a})}).next(()=>{if(s.result)return;let a=new _u;return this.Xi(e,t,a).next(c=>{if(s.result=c,this.zi)return this.es(e,t,a,c.size)})}).next(()=>s.result)}es(e,t,i,r){return i.documentReadCount<this.ji?(ir()<=G.DEBUG&&L("QueryEngine","SDK will not create cache indexes for query:",Zn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),P.resolve()):(ir()<=G.DEBUG&&L("QueryEngine","Query:",Zn(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.Hi*r?(ir()<=G.DEBUG&&L("QueryEngine","The SDK decides to create cache indexes for query:",Zn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,nt(t))):P.resolve())}Yi(e,t){if(Sf(t))return P.resolve(null);let i=nt(t);return this.indexManager.getIndexType(e,i).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=Bc(t,null,"F"),i=nt(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(s=>{let a=j(...s);return this.Ji.getDocuments(e,a).next(c=>this.indexManager.getMinOffset(e,i).next(l=>{let d=this.ts(t,c);return this.ns(t,d,a,l.readTime)?this.Yi(e,Bc(t,null,"F")):this.rs(e,d,t,l)}))})))}Zi(e,t,i,r){return Sf(t)||r.isEqual($.min())?P.resolve(null):this.Ji.getDocuments(e,i).next(s=>{let a=this.ts(t,s);return this.ns(t,a,i,r)?P.resolve(null):(ir()<=G.DEBUG&&L("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Zn(t)),this.rs(e,a,t,cv(r,-1)).next(c=>c))})}ts(e,t){let i=new Re(up(e));return t.forEach((r,s)=>{uo(e,s)&&(i=i.add(s))}),i}ns(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Xi(e,t,i){return ir()<=G.DEBUG&&L("QueryEngine","Using full collection scan to execute query:",Zn(t)),this.Ji.getDocumentsMatchingQuery(e,t,En.min(),i)}rs(e,t,i,r){return this.Ji.getDocumentsMatchingQuery(e,i,r).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}};var Iu=class{constructor(e,t,i,r){this.persistence=e,this.ss=t,this.serializer=r,this.os=new ae(Y),this._s=new jt(s=>nl(s),il),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(i)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new su(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function nE(n,e,t,i){return new Iu(n,e,t,i)}function Cp(n,e){return g(this,null,function*(){let t=q(n);return yield t.persistence.runTransaction("Handle user change","readonly",i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next(s=>(r=s,t.ls(e),t.mutationQueue.getAllMutationBatches(i))).next(s=>{let a=[],c=[],l=j();for(let d of r){a.push(d.batchId);for(let p of d.mutations)l=l.add(p.key)}for(let d of s){c.push(d.batchId);for(let p of d.mutations)l=l.add(p.key)}return t.localDocuments.getDocuments(i,l).next(d=>({hs:d,removedBatchIds:a,addedBatchIds:c}))})})})}function iE(n,e){let t=q(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{let r=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(c,l,d,p){let I=d.batch,b=I.keys(),R=P.resolve();return b.forEach(D=>{R=R.next(()=>p.getEntry(l,D)).next(k=>{let O=d.docVersions.get(D);X(O!==null),k.version.compareTo(O)<0&&(I.applyToRemoteDocument(k,d),k.isValidDocument()&&(k.setReadTime(d.commitVersion),p.addEntry(k)))})}),R.next(()=>c.mutationQueue.removeMutationBatch(l,I))}(t,i,e,s).next(()=>s.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(c){let l=j();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(l=l.add(c.batch.mutations[d].key));return l}(e))).next(()=>t.localDocuments.getDocuments(i,r))})}function Pp(n){let e=q(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function rE(n,e){let t=q(n),i=e.snapshotVersion,r=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let a=t.cs.newChangeBuffer({trackRemovals:!0});r=t.os;let c=[];e.targetChanges.forEach((p,I)=>{let b=r.get(I);if(!b)return;c.push(t.Ur.removeMatchingKeys(s,p.removedDocuments,I).next(()=>t.Ur.addMatchingKeys(s,p.addedDocuments,I)));let R=b.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(I)!==null?R=R.withResumeToken(Ce.EMPTY_BYTE_STRING,$.min()).withLastLimboFreeSnapshotVersion($.min()):p.resumeToken.approximateByteSize()>0&&(R=R.withResumeToken(p.resumeToken,i)),r=r.insert(I,R),function(k,O,z){return k.resumeToken.approximateByteSize()===0||O.snapshotVersion.toMicroseconds()-k.snapshotVersion.toMicroseconds()>=3e8?!0:z.addedDocuments.size+z.modifiedDocuments.size+z.removedDocuments.size>0}(b,R,p)&&c.push(t.Ur.updateTargetData(s,R))});let l=Tt(),d=j();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(s,p))}),c.push(sE(s,a,e.documentUpdates).next(p=>{l=p.Ps,d=p.Is})),!i.isEqual($.min())){let p=t.Ur.getLastRemoteSnapshotVersion(s).next(I=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,i));c.push(p)}return P.waitFor(c).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,d)).next(()=>l)}).then(s=>(t.os=r,s))}function sE(n,e,t){let i=j(),r=j();return t.forEach(s=>i=i.add(s)),e.getEntries(n,i).next(s=>{let a=Tt();return t.forEach((c,l)=>{let d=s.get(c);l.isFoundDocument()!==d.isFoundDocument()&&(r=r.add(c)),l.isNoDocument()&&l.version.isEqual($.min())?(e.removeEntry(c,l.readTime),a=a.insert(c,l)):!d.isValidDocument()||l.version.compareTo(d.version)>0||l.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(l),a=a.insert(c,l)):L("LocalStore","Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",l.version)}),{Ps:a,Is:r}})}function oE(n,e){let t=q(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function aE(n,e){let t=q(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return t.Ur.getTargetData(i,e).next(s=>s?(r=s,P.resolve(r)):t.Ur.allocateTargetId(i).next(a=>(r=new pr(e,a,"TargetPurposeListen",i.currentSequenceNumber),t.Ur.addTargetData(i,r).next(()=>r))))}).then(i=>{let r=t.os.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.os=t.os.insert(i.targetId,i),t._s.set(e,i.targetId)),i})}function vu(n,e,t){return g(this,null,function*(){let i=q(n),r=i.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield i.persistence.runTransaction("Release target",s,a=>i.persistence.referenceDelegate.removeTarget(a,r)))}catch(a){if(!Ar(a))throw a;L("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}i.os=i.os.remove(e),i._s.delete(r.target)})}function Vf(n,e,t){let i=q(n),r=$.min(),s=j();return i.persistence.runTransaction("Execute query","readwrite",a=>function(l,d,p){let I=q(l),b=I._s.get(p);return b!==void 0?P.resolve(I.os.get(b)):I.Ur.getTargetData(d,p)}(i,a,nt(e)).next(c=>{if(c)return r=c.lastLimboFreeSnapshotVersion,i.Ur.getMatchingKeysForTargetId(a,c.targetId).next(l=>{s=l})}).next(()=>i.ss.getDocumentsMatchingQuery(a,e,t?r:$.min(),t?s:j())).next(c=>(cE(i,wv(e),c),{documents:c,Ts:s})))}function cE(n,e,t){let i=n.us.get(e)||$.min();t.forEach((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)}),n.us.set(e,i)}var js=class{constructor(){this.activeTargetIds=Pv()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var Eu=class{constructor(){this.so=new js,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,i){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new js,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Tu=class{_o(e){}shutdown(){}};var Hs=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){L("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){L("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Ds=null;function pc(){return Ds===null?Ds=function(){return 268435456+Math.round(2147483648*Math.random())}():Ds++,"0x"+Ds.toString(16)}var uE={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var wu=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var Se="WebChannelConnection",Au=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let i=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=i+"://"+t.host,this.vo=`projects/${r}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${r}`:`project_id=${r}&database_id=${s}`}get Fo(){return!1}Mo(t,i,r,s,a){let c=pc(),l=this.xo(t,i.toUriEncodedString());L("RestConnection",`Sending RPC '${t}' ${c}:`,l,r);let d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,s,a),this.No(t,l,d,r).then(p=>(L("RestConnection",`Received RPC '${t}' ${c}: `,p),p),p=>{throw oi("RestConnection",`RPC '${t}' ${c} failed with error: `,p,"url: ",l,"request:",r),p})}Lo(t,i,r,s,a,c){return this.Mo(t,i,r,s,a)}Oo(t,i,r){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+vi}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach((s,a)=>t[a]=s),r&&r.headers.forEach((s,a)=>t[a]=s)}xo(t,i){let r=uE[t];return`${this.Do}/v1/${i}:${r}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,i,r){let s=pc();return new Promise((a,c)=>{let l=new cc;l.setWithCredentials(!0),l.listenOnce(uc.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case nr.NO_ERROR:let p=l.getResponseJson();L(Se,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(p)),a(p);break;case nr.TIMEOUT:L(Se,`RPC '${e}' ${s} timed out`),c(new x(C.DEADLINE_EXCEEDED,"Request time out"));break;case nr.HTTP_ERROR:let I=l.getStatus();if(L(Se,`RPC '${e}' ${s} failed with status:`,I,"response text:",l.getResponseText()),I>0){let b=l.getResponseJson();Array.isArray(b)&&(b=b[0]);let R=b?.error;if(R&&R.status&&R.message){let D=function(O){let z=O.toLowerCase().replace(/_/g,"-");return Object.values(C).indexOf(z)>=0?z:C.UNKNOWN}(R.status);c(new x(D,R.message))}else c(new x(C.UNKNOWN,"Server responded with status "+l.getStatus()))}else c(new x(C.UNAVAILABLE,"Connection failed."));break;default:U()}}finally{L(Se,`RPC '${e}' ${s} completed.`)}});let d=JSON.stringify(r);L(Se,`RPC '${e}' ${s} sending request:`,r),l.send(t,"POST",d,i,15)})}Bo(e,t,i){let r=pc(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=dc(),c=hc(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(l.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,t,i),l.encodeInitMessageHeaders=!0;let p=s.join("");L(Se,`Creating RPC '${e}' stream ${r}: ${p}`,l);let I=a.createWebChannel(p,l),b=!1,R=!1,D=new wu({Io:O=>{R?L(Se,`Not sending because RPC '${e}' stream ${r} is closed:`,O):(b||(L(Se,`Opening RPC '${e}' stream ${r} transport.`),I.open(),b=!0),L(Se,`RPC '${e}' stream ${r} sending:`,O),I.send(O))},To:()=>I.close()}),k=(O,z,W)=>{O.listen(z,H=>{try{W(H)}catch(te){setTimeout(()=>{throw te},0)}})};return k(I,Xn.EventType.OPEN,()=>{R||(L(Se,`RPC '${e}' stream ${r} transport opened.`),D.yo())}),k(I,Xn.EventType.CLOSE,()=>{R||(R=!0,L(Se,`RPC '${e}' stream ${r} transport closed`),D.So())}),k(I,Xn.EventType.ERROR,O=>{R||(R=!0,oi(Se,`RPC '${e}' stream ${r} transport errored:`,O),D.So(new x(C.UNAVAILABLE,"The operation could not be completed")))}),k(I,Xn.EventType.MESSAGE,O=>{var z;if(!R){let W=O.data[0];X(!!W);let H=W,te=H.error||((z=H[0])===null||z===void 0?void 0:z.error);if(te){L(Se,`RPC '${e}' stream ${r} received error:`,te);let De=te.status,J=function(y){let v=ue[y];if(v!==void 0)return vp(v)}(De),E=te.message;J===void 0&&(J=C.INTERNAL,E="Unknown error status: "+De+" with message "+te.message),R=!0,D.So(new x(J,E)),I.close()}else L(Se,`RPC '${e}' stream ${r} received:`,W),D.bo(W)}}),k(c,lc.STAT_EVENT,O=>{O.stat===Cs.PROXY?L(Se,`RPC '${e}' stream ${r} detected buffering proxy`):O.stat===Cs.NOPROXY&&L(Se,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{D.wo()},0),D}};function mc(){return typeof document<"u"?document:null}function lo(n){return new Qc(n,!0)}var Ks=class{constructor(e,t,i=1e3,r=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=i,this.qo=r,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),i=Math.max(0,Date.now()-this.Uo),r=Math.max(0,t-i);r>0&&L("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,r,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var Qs=class{constructor(e,t,i,r,s,a,c,l){this.ui=e,this.Ho=i,this.Jo=r,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Ks(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return g(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return g(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return g(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===C.RESOURCE_EXHAUSTED?(vt(t.toString()),vt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===C.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.Yo===t&&this.P_(i,r)},i=>{e(()=>{let r=new x(C.UNKNOWN,"Fetching auth token failed: "+i.message);return this.I_(r)})})}P_(e,t){let i=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{i(()=>this.listener.Eo())}),this.stream.Ro(()=>{i(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(r=>{i(()=>this.I_(r))}),this.stream.onMessage(r=>{i(()=>++this.e_==1?this.E_(r):this.onNext(r))})}i_(){this.state=5,this.t_.Go(()=>g(this,null,function*(){this.state=0,this.start()}))}I_(e){return L("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(L("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},bu=class extends Qs{constructor(e,t,i,r,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,a),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=zv(this.serializer,e),i=function(s){if(!("targetChange"in s))return $.min();let a=s.targetChange;return a.targetIds&&a.targetIds.length?$.min():a.readTime?it(a.readTime):$.min()}(e);return this.listener.d_(t,i)}A_(e){let t={};t.database=Zc(this.serializer),t.addTarget=function(s,a){let c,l=a.target;if(c=Fc(l)?{documents:Hv(s,l)}:{query:Kv(s,l)._t},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=Ep(s,a.resumeToken);let d=Yc(s,a.expectedCount);d!==null&&(c.expectedCount=d)}else if(a.snapshotVersion.compareTo($.min())>0){c.readTime=zs(s,a.snapshotVersion.toTimestamp());let d=Yc(s,a.expectedCount);d!==null&&(c.expectedCount=d)}return c}(this.serializer,e);let i=Yv(this.serializer,e);i&&(t.labels=i),this.a_(t)}R_(e){let t={};t.database=Zc(this.serializer),t.removeTarget=e,this.a_(t)}},Su=class extends Qs{constructor(e,t,i,r,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return X(!!e.streamToken),this.lastStreamToken=e.streamToken,X(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){X(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=jv(e.writeResults,e.commitTime),i=it(e.commitTime);return this.listener.g_(i,t)}p_(){let e={};e.database=Zc(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(i=>Gv(this.serializer,i))};this.a_(t)}};var Ru=class extends class{}{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.y_=!1}w_(){if(this.y_)throw new x(C.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,i,r){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,Jc(t,i),r,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new x(C.UNKNOWN,s.toString())})}Lo(e,t,i,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.Lo(e,Jc(t,i),r,a,c,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new x(C.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},Cu=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(vt(t),this.D_=!1):L("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var Pu=class{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{i.enqueueAndForget(()=>g(this,null,function*(){Rn(this)&&(L("RemoteStore","Restarting streams for network reachability change."),yield function(l){return g(this,null,function*(){let d=q(l);d.L_.add(4),yield br(d),d.q_.set("Unknown"),d.L_.delete(4),yield ho(d)})}(this))}))}),this.q_=new Cu(i,r)}};function ho(n){return g(this,null,function*(){if(Rn(n))for(let e of n.B_)yield e(!0)})}function br(n){return g(this,null,function*(){for(let e of n.B_)yield e(!1)})}function Dp(n,e){let t=q(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),ul(t)?cl(t):Ti(t).r_()&&al(t,e))}function ol(n,e){let t=q(n),i=Ti(t);t.N_.delete(e),i.r_()&&Np(t,e),t.N_.size===0&&(i.r_()?i.o_():Rn(t)&&t.q_.set("Unknown"))}function al(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo($.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ti(n).A_(e)}function Np(n,e){n.Q_.xe(e),Ti(n).R_(e)}function cl(n){n.Q_=new Kc({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Ti(n).start(),n.q_.v_()}function ul(n){return Rn(n)&&!Ti(n).n_()&&n.N_.size>0}function Rn(n){return q(n).L_.size===0}function Op(n){n.Q_=void 0}function lE(n){return g(this,null,function*(){n.q_.set("Online")})}function hE(n){return g(this,null,function*(){n.N_.forEach((e,t)=>{al(n,e)})})}function dE(n,e){return g(this,null,function*(){Op(n),ul(n)?(n.q_.M_(e),cl(n)):n.q_.set("Unknown")})}function fE(n,e,t){return g(this,null,function*(){if(n.q_.set("Online"),e instanceof $s&&e.state===2&&e.cause)try{yield function(r,s){return g(this,null,function*(){let a=s.cause;for(let c of s.targetIds)r.N_.has(c)&&(yield r.remoteSyncer.rejectListen(c,a),r.N_.delete(c),r.Q_.removeTarget(c))})}(n,e)}catch(i){L("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),yield Ys(n,i)}else if(e instanceof ri?n.Q_.Ke(e):e instanceof qs?n.Q_.He(e):n.Q_.We(e),!t.isEqual($.min()))try{let i=yield Pp(n.localStore);t.compareTo(i)>=0&&(yield function(s,a){let c=s.Q_.rt(a);return c.targetChanges.forEach((l,d)=>{if(l.resumeToken.approximateByteSize()>0){let p=s.N_.get(d);p&&s.N_.set(d,p.withResumeToken(l.resumeToken,a))}}),c.targetMismatches.forEach((l,d)=>{let p=s.N_.get(l);if(!p)return;s.N_.set(l,p.withResumeToken(Ce.EMPTY_BYTE_STRING,p.snapshotVersion)),Np(s,l);let I=new pr(p.target,l,d,p.sequenceNumber);al(s,I)}),s.remoteSyncer.applyRemoteEvent(c)}(n,t))}catch(i){L("RemoteStore","Failed to raise snapshot:",i),yield Ys(n,i)}})}function Ys(n,e,t){return g(this,null,function*(){if(!Ar(e))throw e;n.L_.add(1),yield br(n),n.q_.set("Offline"),t||(t=()=>Pp(n.localStore)),n.asyncQueue.enqueueRetryable(()=>g(this,null,function*(){L("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield ho(n)}))})}function kp(n,e){return e().catch(t=>Ys(n,t,e))}function fo(n){return g(this,null,function*(){let e=q(n),t=Ht(e),i=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;pE(e);)try{let r=yield oE(e.localStore,i);if(r===null){e.O_.length===0&&t.o_();break}i=r.batchId,mE(e,r)}catch(r){yield Ys(e,r)}xp(e)&&Lp(e)})}function pE(n){return Rn(n)&&n.O_.length<10}function mE(n,e){n.O_.push(e);let t=Ht(n);t.r_()&&t.V_&&t.m_(e.mutations)}function xp(n){return Rn(n)&&!Ht(n).n_()&&n.O_.length>0}function Lp(n){Ht(n).start()}function gE(n){return g(this,null,function*(){Ht(n).p_()})}function _E(n){return g(this,null,function*(){let e=Ht(n);for(let t of n.O_)e.m_(t.mutations)})}function yE(n,e,t){return g(this,null,function*(){let i=n.O_.shift(),r=zc.from(i,e,t);yield kp(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),yield fo(n)})}function IE(n,e){return g(this,null,function*(){e&&Ht(n).V_&&(yield function(i,r){return g(this,null,function*(){if(function(a){return Mv(a)&&a!==C.ABORTED}(r.code)){let s=i.O_.shift();Ht(i).s_(),yield kp(i,()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r)),yield fo(i)}})}(n,e)),xp(n)&&Lp(n)})}function Ff(n,e){return g(this,null,function*(){let t=q(n);t.asyncQueue.verifyOperationInProgress(),L("RemoteStore","RemoteStore received new credentials");let i=Rn(t);t.L_.add(3),yield br(t),i&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield ho(t)})}function vE(n,e){return g(this,null,function*(){let t=q(n);e?(t.L_.delete(2),yield ho(t)):e||(t.L_.add(2),yield br(t),t.q_.set("Unknown"))})}function Ti(n){return n.K_||(n.K_=function(t,i,r){let s=q(t);return s.w_(),new bu(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(n.datastore,n.asyncQueue,{Eo:lE.bind(null,n),Ro:hE.bind(null,n),mo:dE.bind(null,n),d_:fE.bind(null,n)}),n.B_.push(e=>g(this,null,function*(){e?(n.K_.s_(),ul(n)?cl(n):n.q_.set("Unknown")):(yield n.K_.stop(),Op(n))}))),n.K_}function Ht(n){return n.U_||(n.U_=function(t,i,r){let s=q(t);return s.w_(),new Su(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:gE.bind(null,n),mo:IE.bind(null,n),f_:_E.bind(null,n),g_:yE.bind(null,n)}),n.B_.push(e=>g(this,null,function*(){e?(n.U_.s_(),yield fo(n)):(yield n.U_.stop(),n.O_.length>0&&(L("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var Du=class n{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new et,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){let a=Date.now()+i,c=new n(e,t,a,r,s);return c.start(i),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new x(C.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function ll(n,e){if(vt("AsyncQueue",`${e}: ${n}`),Ar(n))return new x(C.UNAVAILABLE,`${e}: ${n}`);throw n}var Js=class n{constructor(e){this.comparator=e?(t,i)=>e(t,i)||V.comparator(t.key,i.key):(t,i)=>V.comparator(t.key,i.key),this.keyedMap=rr(),this.sortedSet=new ae(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){let r=t.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let i=new n;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}};var Xs=class{constructor(){this.W_=new ae(V.comparator)}track(e){let t=e.doc.key,i=this.W_.get(t);i?e.type!==0&&i.type===3?this.W_=this.W_.insert(t,e):e.type===3&&i.type!==1?this.W_=this.W_.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.W_=this.W_.remove(t):e.type===1&&i.type===2?this.W_=this.W_.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):U():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,i)=>{e.push(i)}),e}},gi=class n{constructor(e,t,i,r,s,a,c,l,d){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=l,this.hasCachedResults=d}static fromInitialDocuments(e,t,i,r,s){let a=[];return t.forEach(c=>{a.push({type:0,doc:c})}),new n(e,t,Js.emptySet(t),a,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&co(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}};var Nu=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},Ou=class{constructor(){this.queries=Uf(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,i){let r=q(t),s=r.queries;r.queries=Uf(),s.forEach((a,c)=>{for(let l of c.j_)l.onError(i)})})(this,new x(C.ABORTED,"Firestore shutting down"))}};function Uf(){return new jt(n=>cp(n),co)}function EE(n,e){return g(this,null,function*(){let t=q(n),i=3,r=e.query,s=t.queries.get(r);s?!s.H_()&&e.J_()&&(i=2):(s=new Nu,i=e.J_()?0:1);try{switch(i){case 0:s.z_=yield t.onListen(r,!0);break;case 1:s.z_=yield t.onListen(r,!1);break;case 2:yield t.onFirstRemoteStoreListen(r)}}catch(a){let c=ll(a,`Initialization of query '${Zn(e.query)}' failed`);return void e.onError(c)}t.queries.set(r,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&hl(t)})}function TE(n,e){return g(this,null,function*(){let t=q(n),i=e.query,r=3,s=t.queries.get(i);if(s){let a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?r=e.J_()?0:1:!s.H_()&&e.J_()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}})}function wE(n,e){let t=q(n),i=!1;for(let r of e){let s=r.query,a=t.queries.get(s);if(a){for(let c of a.j_)c.X_(r)&&(i=!0);a.z_=r}}i&&hl(t)}function AE(n,e,t){let i=q(n),r=i.queries.get(e);if(r)for(let s of r.j_)s.onError(t);i.queries.delete(e)}function hl(n){n.Y_.forEach(e=>{e.next()})}var ku,Bf;(Bf=ku||(ku={})).ea="default",Bf.Cache="cache";var xu=class{constructor(e,t,i){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=i||{}}X_(e){if(!this.options.includeMetadataChanges){let i=[];for(let r of e.docChanges)r.type!==3&&i.push(r);e=new gi(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let i=t!=="Offline";return(!this.options._a||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=gi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==ku.Cache}};var Zs=class{constructor(e){this.key=e}},eo=class{constructor(e){this.key=e}},Lu=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=j(),this.mutatedKeys=j(),this.Aa=up(e),this.Ra=new Js(this.Aa)}get Va(){return this.Ta}ma(e,t){let i=t?t.fa:new Xs,r=t?t.Ra:this.Ra,s=t?t.mutatedKeys:this.mutatedKeys,a=r,c=!1,l=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,d=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((p,I)=>{let b=r.get(p),R=uo(this.query,I)?I:null,D=!!b&&this.mutatedKeys.has(b.key),k=!!R&&(R.hasLocalMutations||this.mutatedKeys.has(R.key)&&R.hasCommittedMutations),O=!1;b&&R?b.data.isEqual(R.data)?D!==k&&(i.track({type:3,doc:R}),O=!0):this.ga(b,R)||(i.track({type:2,doc:R}),O=!0,(l&&this.Aa(R,l)>0||d&&this.Aa(R,d)<0)&&(c=!0)):!b&&R?(i.track({type:0,doc:R}),O=!0):b&&!R&&(i.track({type:1,doc:b}),O=!0,(l||d)&&(c=!0)),O&&(R?(a=a.add(R),s=k?s.add(p):s.delete(p)):(a=a.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){let p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),s=s.delete(p.key),i.track({type:1,doc:p})}return{Ra:a,fa:i,ns:c,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){let s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let a=e.fa.G_();a.sort((p,I)=>function(R,D){let k=O=>{switch(O){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return U()}};return k(R)-k(D)}(p.type,I.type)||this.Aa(p.doc,I.doc)),this.pa(i),r=r!=null&&r;let c=t&&!r?this.ya():[],l=this.da.size===0&&this.current&&!r?1:0,d=l!==this.Ea;return this.Ea=l,a.length!==0||d?{snapshot:new gi(this.query,e.Ra,s,a,e.mutatedKeys,l===0,d,!1,!!i&&i.resumeToken.approximateByteSize()>0),wa:c}:{wa:c}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Xs,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=j(),this.Ra.forEach(i=>{this.Sa(i.key)&&(this.da=this.da.add(i.key))});let t=[];return e.forEach(i=>{this.da.has(i)||t.push(new eo(i))}),this.da.forEach(i=>{e.has(i)||t.push(new Zs(i))}),t}ba(e){this.Ta=e.Ts,this.da=j();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return gi.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},Mu=class{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}},Vu=class{constructor(e){this.key=e,this.va=!1}},Fu=class{constructor(e,t,i,r,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new jt(c=>cp(c),co),this.Ma=new Map,this.xa=new Set,this.Oa=new ae(V.comparator),this.Na=new Map,this.La=new gr,this.Ba={},this.ka=new Map,this.qa=mr.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function bE(n,e,t=!0){return g(this,null,function*(){let i=qp(n),r,s=i.Fa.get(e);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.Da()):r=yield Mp(i,e,t,!0),r})}function SE(n,e){return g(this,null,function*(){let t=qp(n);yield Mp(t,e,!0,!1)})}function Mp(n,e,t,i){return g(this,null,function*(){let r=yield aE(n.localStore,nt(e)),s=r.targetId,a=n.sharedClientState.addLocalQueryTarget(s,t),c;return i&&(c=yield RE(n,e,s,a==="current",r.resumeToken)),n.isPrimaryClient&&t&&Dp(n.remoteStore,r),c})}function RE(n,e,t,i,r){return g(this,null,function*(){n.Ka=(I,b,R)=>function(k,O,z,W){return g(this,null,function*(){let H=O.view.ma(z);H.ns&&(H=yield Vf(k.localStore,O.query,!1).then(({documents:E})=>O.view.ma(E,H)));let te=W&&W.targetChanges.get(O.targetId),De=W&&W.targetMismatches.get(O.targetId)!=null,J=O.view.applyChanges(H,k.isPrimaryClient,te,De);return $f(k,O.targetId,J.wa),J.snapshot})}(n,I,b,R);let s=yield Vf(n.localStore,e,!0),a=new Lu(e,s.Ts),c=a.ma(s.documents),l=fr.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),d=a.applyChanges(c,n.isPrimaryClient,l);$f(n,t,d.wa);let p=new Mu(e,t,a);return n.Fa.set(e,p),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),d.snapshot})}function CE(n,e,t){return g(this,null,function*(){let i=q(n),r=i.Fa.get(e),s=i.Ma.get(r.targetId);if(s.length>1)return i.Ma.set(r.targetId,s.filter(a=>!co(a,e))),void i.Fa.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||(yield vu(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),t&&ol(i.remoteStore,r.targetId),Uu(i,r.targetId)}).catch(wr))):(Uu(i,r.targetId),yield vu(i.localStore,r.targetId,!0))})}function PE(n,e){return g(this,null,function*(){let t=q(n),i=t.Fa.get(e),r=t.Ma.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),ol(t.remoteStore,i.targetId))})}function DE(n,e,t){return g(this,null,function*(){let i=VE(n);try{let r=yield function(a,c){let l=q(a),d=Ee.now(),p=c.reduce((R,D)=>R.add(D.key),j()),I,b;return l.persistence.runTransaction("Locally write mutations","readwrite",R=>{let D=Tt(),k=j();return l.cs.getEntries(R,p).next(O=>{D=O,D.forEach((z,W)=>{W.isValidDocument()||(k=k.add(z))})}).next(()=>l.localDocuments.getOverlayedDocuments(R,D)).next(O=>{I=O;let z=[];for(let W of c){let H=Lv(W,I.get(W.key).overlayedDocument);H!=null&&z.push(new wt(W.key,H,ep(H.value.mapValue),Wt.exists(!0)))}return l.mutationQueue.addMutationBatch(R,d,z,c)}).next(O=>{b=O;let z=O.applyToLocalDocumentSet(I,k);return l.documentOverlayCache.saveOverlays(R,O.batchId,z)})}).then(()=>({batchId:b.batchId,changes:hp(I)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),function(a,c,l){let d=a.Ba[a.currentUser.toKey()];d||(d=new ae(Y)),d=d.insert(c,l),a.Ba[a.currentUser.toKey()]=d}(i,r.batchId,t),yield Sr(i,r.changes),yield fo(i.remoteStore)}catch(r){let s=ll(r,"Failed to persist write");t.reject(s)}})}function Vp(n,e){return g(this,null,function*(){let t=q(n);try{let i=yield rE(t.localStore,e);e.targetChanges.forEach((r,s)=>{let a=t.Na.get(s);a&&(X(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?a.va=!0:r.modifiedDocuments.size>0?X(a.va):r.removedDocuments.size>0&&(X(a.va),a.va=!1))}),yield Sr(t,i,e)}catch(i){yield wr(i)}})}function qf(n,e,t){let i=q(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){let r=[];i.Fa.forEach((s,a)=>{let c=a.view.Z_(e);c.snapshot&&r.push(c.snapshot)}),function(a,c){let l=q(a);l.onlineState=c;let d=!1;l.queries.forEach((p,I)=>{for(let b of I.j_)b.Z_(c)&&(d=!0)}),d&&hl(l)}(i.eventManager,e),r.length&&i.Ca.d_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}function NE(n,e,t){return g(this,null,function*(){let i=q(n);i.sharedClientState.updateQueryState(e,"rejected",t);let r=i.Na.get(e),s=r&&r.key;if(s){let a=new ae(V.comparator);a=a.insert(s,je.newNoDocument(s,$.min()));let c=j().add(s),l=new Bs($.min(),new Map,new ae(Y),a,c);yield Vp(i,l),i.Oa=i.Oa.remove(s),i.Na.delete(e),dl(i)}else yield vu(i.localStore,e,!1).then(()=>Uu(i,e,t)).catch(wr)})}function OE(n,e){return g(this,null,function*(){let t=q(n),i=e.batch.batchId;try{let r=yield iE(t.localStore,e);Up(t,i,null),Fp(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),yield Sr(t,r)}catch(r){yield wr(r)}})}function kE(n,e,t){return g(this,null,function*(){let i=q(n);try{let r=yield function(a,c){let l=q(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let p;return l.mutationQueue.lookupMutationBatch(d,c).next(I=>(X(I!==null),p=I.keys(),l.mutationQueue.removeMutationBatch(d,I))).next(()=>l.mutationQueue.performConsistencyCheck(d)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(d,p,c)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p)).next(()=>l.localDocuments.getDocuments(d,p))})}(i.localStore,e);Up(i,e,t),Fp(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),yield Sr(i,r)}catch(r){yield wr(r)}})}function Fp(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function Up(n,e,t){let i=q(n),r=i.Ba[i.currentUser.toKey()];if(r){let s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.Ba[i.currentUser.toKey()]=r}}function Uu(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let i of n.Ma.get(e))n.Fa.delete(i),t&&n.Ca.$a(i,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(i=>{n.La.containsKey(i)||Bp(n,i)})}function Bp(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(ol(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),dl(n))}function $f(n,e,t){for(let i of t)i instanceof Zs?(n.La.addReference(i.key,e),xE(n,i)):i instanceof eo?(L("SyncEngine","Document no longer in limbo: "+i.key),n.La.removeReference(i.key,e),n.La.containsKey(i.key)||Bp(n,i.key)):U()}function xE(n,e){let t=e.key,i=t.path.canonicalString();n.Oa.get(t)||n.xa.has(i)||(L("SyncEngine","New document in limbo: "+t),n.xa.add(i),dl(n))}function dl(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new V(re.fromString(e)),i=n.qa.next();n.Na.set(i,new Vu(t)),n.Oa=n.Oa.insert(t,i),Dp(n.remoteStore,new pr(nt(op(t.path)),i,"TargetPurposeLimboResolution",Yf.oe))}}function Sr(n,e,t){return g(this,null,function*(){let i=q(n),r=[],s=[],a=[];i.Fa.isEmpty()||(i.Fa.forEach((c,l)=>{a.push(i.Ka(l,e,t).then(d=>{var p;if((d||t)&&i.isPrimaryClient){let I=d?!d.fromCache:(p=t?.targetChanges.get(l.targetId))===null||p===void 0?void 0:p.current;i.sharedClientState.updateQueryState(l.targetId,I?"current":"not-current")}if(d){r.push(d);let I=gu.Wi(l.targetId,d);s.push(I)}}))}),yield Promise.all(a),i.Ca.d_(r),yield function(l,d){return g(this,null,function*(){let p=q(l);try{yield p.persistence.runTransaction("notifyLocalViewChanges","readwrite",I=>P.forEach(d,b=>P.forEach(b.$i,R=>p.persistence.referenceDelegate.addReference(I,b.targetId,R)).next(()=>P.forEach(b.Ui,R=>p.persistence.referenceDelegate.removeReference(I,b.targetId,R)))))}catch(I){if(!Ar(I))throw I;L("LocalStore","Failed to update sequence numbers: "+I)}for(let I of d){let b=I.targetId;if(!I.fromCache){let R=p.os.get(b),D=R.snapshotVersion,k=R.withLastLimboFreeSnapshotVersion(D);p.os=p.os.insert(b,k)}}})}(i.localStore,s))})}function LE(n,e){return g(this,null,function*(){let t=q(n);if(!t.currentUser.isEqual(e)){L("SyncEngine","User change. New user:",e.toKey());let i=yield Cp(t.localStore,e);t.currentUser=e,function(s,a){s.ka.forEach(c=>{c.forEach(l=>{l.reject(new x(C.CANCELLED,a))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),yield Sr(t,i.hs)}})}function ME(n,e){let t=q(n),i=t.Na.get(e);if(i&&i.va)return j().add(i.key);{let r=j(),s=t.Ma.get(e);if(!s)return r;for(let a of s){let c=t.Fa.get(a);r=r.unionWith(c.view.Va)}return r}}function qp(n){let e=q(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Vp.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=ME.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=NE.bind(null,e),e.Ca.d_=wE.bind(null,e.eventManager),e.Ca.$a=AE.bind(null,e.eventManager),e}function VE(n){let e=q(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=OE.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=kE.bind(null,e),e}var Wf=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return g(this,null,function*(){this.serializer=lo(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),yield this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)})}ja(t,i){return null}Ha(t,i){return null}za(t){return nE(this.persistence,new yu,t.initialUser,this.serializer)}Ga(t){return new fu(mu.Zr,this.serializer)}Wa(t){return new Eu}terminate(){return g(this,null,function*(){var t,i;(t=this.gcScheduler)===null||t===void 0||t.stop(),(i=this.indexBackfillerScheduler)===null||i===void 0||i.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})();var FE=(()=>{class n{initialize(t,i){return g(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(i),this.remoteStore=this.createRemoteStore(i),this.eventManager=this.createEventManager(i),this.syncEngine=this.createSyncEngine(i,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>qf(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=LE.bind(null,this.syncEngine),yield vE(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new Ou}()}createDatastore(t){let i=lo(t.databaseInfo.databaseId),r=function(a){return new Au(a)}(t.databaseInfo);return function(a,c,l,d){return new Ru(a,c,l,d)}(t.authCredentials,t.appCheckCredentials,r,i)}createRemoteStore(t){return function(r,s,a,c,l){return new Pu(r,s,a,c,l)}(this.localStore,this.datastore,t.asyncQueue,i=>qf(this.syncEngine,i,0),function(){return Hs.D()?new Hs:new Tu}())}createSyncEngine(t,i){return function(s,a,c,l,d,p,I){let b=new Fu(s,a,c,l,d,p);return I&&(b.Qa=!0),b}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,i)}terminate(){return g(this,null,function*(){var t,i;yield function(s){return g(this,null,function*(){let a=q(s);L("RemoteStore","RemoteStore shutting down."),a.L_.add(5),yield br(a),a.k_.shutdown(),a.q_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(i=this.eventManager)===null||i===void 0||i.terminate()})}}return n.provider={build:()=>new n},n})();var Bu=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):vt("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var qu=class{constructor(e,t,i,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=_e.UNAUTHENTICATED,this.clientId=xs.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,a=>g(this,null,function*(){L("FirestoreClient","Received user=",a.uid),yield this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(i,a=>(L("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new et;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>g(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let i=ll(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}};function gc(n,e){return g(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),L("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(r=>g(this,null,function*(){i.isEqual(r)||(yield Cp(e.localStore,r),i=r)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function zf(n,e){return g(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield UE(n);L("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(i=>Ff(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,r)=>Ff(e.remoteStore,r)),n._onlineComponents=e})}function UE(n){return g(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){L("FirestoreClient","Using user provided OfflineComponentProvider");try{yield gc(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(r){return r.name==="FirebaseError"?r.code===C.FAILED_PRECONDITION||r.code===C.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(t))throw t;oi("Error using user provided cache. Falling back to memory cache: "+t),yield gc(n,new Wf)}}else L("FirestoreClient","Using default OfflineComponentProvider"),yield gc(n,new Wf);return n._offlineComponents})}function $p(n){return g(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(L("FirestoreClient","Using user provided OnlineComponentProvider"),yield zf(n,n._uninitializedComponentsProvider._online)):(L("FirestoreClient","Using default OnlineComponentProvider"),yield zf(n,new FE))),n._onlineComponents})}function BE(n){return $p(n).then(e=>e.syncEngine)}function qE(n){return g(this,null,function*(){let e=yield $p(n),t=e.eventManager;return t.onListen=bE.bind(null,e.syncEngine),t.onUnlisten=CE.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=SE.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=PE.bind(null,e.syncEngine),t})}function $E(n,e,t={}){let i=new et;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(s,a,c,l,d){let p=new Bu({next:b=>{p.Za(),a.enqueueAndForget(()=>TE(s,I)),b.fromCache&&l.source==="server"?d.reject(new x(C.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(b)},error:b=>d.reject(b)}),I=new xu(c,p,{includeMetadataChanges:!0,_a:!0});return EE(s,I)}(yield qE(n),n.asyncQueue,e,t,i)})),i.promise}function Wp(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var Gf=new Map;function zp(n,e,t){if(!t)throw new x(C.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function WE(n,e,t,i){if(e===!0&&i===!0)throw new x(C.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function jf(n){if(!V.isDocumentKey(n))throw new x(C.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Hf(n){if(V.isDocumentKey(n))throw new x(C.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function po(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(i){return i.constructor?i.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":U()}function _r(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new x(C.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=po(n);throw new x(C.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var to=class{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new x(C.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new x(C.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}WE("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Wp((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new x(C.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new x(C.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new x(C.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(i,r){return i.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},_i=class{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new to({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new x(C.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new x(C.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new to(e),e.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new _c;switch(i.type){case"firstParty":return new Ec(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new x(C.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return g(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let i=Gf.get(t);i&&(L("ComponentProvider","Removing Datastore"),Gf.delete(t),i.terminate())}(this),Promise.resolve()}};function Gp(n,e,t,i={}){var r;let s=(n=_r(n,_i))._getSettings(),a=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&oi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),i.mockUserToken){let c,l;if(typeof i.mockUserToken=="string")c=i.mockUserToken,l=_e.MOCK_USER;else{c=Qh(i.mockUserToken,(r=n._app)===null||r===void 0?void 0:r.options.projectId);let d=i.mockUserToken.sub||i.mockUserToken.user_id;if(!d)throw new x(C.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new _e(d)}n._authCredentials=new yc(new ks(c,l))}}var yi=class n{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},qe=class n{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new zt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},zt=class n extends yi{constructor(e,t,i){super(e,t,op(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new qe(this.firestore,null,new V(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Kt(n,e,...t){if(n=me(n),zp("collection","path",e),n instanceof _i){let i=re.fromString(e,...t);return Hf(i),new zt(n,null,i)}{if(!(n instanceof qe||n instanceof zt))throw new x(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(re.fromString(e,...t));return Hf(i),new zt(n.firestore,null,i)}}function fl(n,e,...t){if(n=me(n),arguments.length===1&&(e=xs.newId()),zp("doc","path",e),n instanceof _i){let i=re.fromString(e,...t);return jf(i),new qe(n,null,new V(i))}{if(!(n instanceof qe||n instanceof zt))throw new x(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(re.fromString(e,...t));return jf(i),new qe(n.firestore,n instanceof zt?n.converter:null,new V(i))}}var no=class{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Ks(this,"async_queue_retry"),this.Vu=()=>{let i=mc();i&&L("AsyncQueue","Visibility state changed to "+i.visibilityState),this.t_.jo()},this.mu=e;let t=mc();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;let t=mc();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});let t=new et;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}pu(){return g(this,null,function*(){if(this.Pu.length!==0){try{yield this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Ar(e))throw e;L("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}})}gu(e){let t=this.mu.then(()=>(this.du=!0,e().catch(i=>{this.Eu=i,this.du=!1;let r=function(a){let c=a.message||"";return a.stack&&(c=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),c}(i);throw vt("INTERNAL UNHANDLED ERROR: ",r),i}).then(i=>(this.du=!1,i))));return this.mu=t,t}enqueueAfterDelay(e,t,i){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);let r=Du.createAndSchedule(this,e,t,i,s=>this.yu(s));return this.Tu.push(r),r}fu(){this.Eu&&U()}verifyOperationInProgress(){}wu(){return g(this,null,function*(){let e;do e=this.mu,yield e;while(e!==this.mu)})}Su(e){for(let t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(let t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){let t=this.Tu.indexOf(e);this.Tu.splice(t,1)}};var Ii=class extends _i{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new no,this._persistenceKey=r?.name||"[DEFAULT]"}_terminate(){return g(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new no(e),this._firestoreClient=void 0,yield e}})}};function jp(n,e){let t=typeof n=="object"?n:Wn(),i=typeof n=="string"?n:e||"(default)",r=ji(t,"firestore").getImmediate({identifier:i});if(!r._initialized){let s=Kh("firestore");s&&Gp(r,...s)}return r}function Hp(n){if(n._terminated)throw new x(C.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||zE(n),n._firestoreClient}function zE(n){var e,t,i;let r=n._freezeSettings(),s=function(c,l,d,p){return new Sc(c,l,d,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,Wp(p.experimentalLongPollingOptions),p.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,r);n._componentsProvider||!((t=r.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=r.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),n._firestoreClient=new qu(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(c){let l=c?._online.build();return{_offline:c?._offline.build(l),_online:l}}(n._componentsProvider))}var yr=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Ce.fromBase64String(e))}catch(t){throw new x(C.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Ce.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Ir=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new x(C.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Me(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var io=class{constructor(e){this._methodName=e}};var vr=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new x(C.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new x(C.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Y(this._lat,e._lat)||Y(this._long,e._long)}};var Er=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0}(this._values,e._values)}};var GE=/^__.*__$/,$u=class{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new wt(e,this.data,this.fieldMask,t,this.fieldTransforms):new Sn(e,this.data,t,this.fieldTransforms)}};function Kp(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw U()}}var Wu=class n{constructor(e,t,i,r,s,a){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;let i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.Fu({path:i,xu:!1});return r.Ou(e),r}Nu(e){var t;let i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.Fu({path:i,xu:!1});return r.vu(),r}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return ro(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Kp(this.Cu)&&GE.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}},zu=class{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||lo(e)}Qu(e,t,i,r=!1){return new Wu({Cu:e,methodName:t,qu:i,path:Me.emptyPath(),xu:!1,ku:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Qp(n){let e=n._freezeSettings(),t=lo(n._databaseId);return new zu(n._databaseId,!!e.ignoreUndefinedProperties,t)}function jE(n,e,t,i,r,s={}){let a=n.Qu(s.merge||s.mergeFields?2:0,e,t,r);Xp("Data must be an object, but it was:",a,i);let c=Yp(i,a),l,d;if(s.merge)l=new Ze(a.fieldMask),d=a.fieldTransforms;else if(s.mergeFields){let p=[];for(let I of s.mergeFields){let b=KE(e,I,t);if(!a.contains(b))throw new x(C.INVALID_ARGUMENT,`Field '${b}' is specified in your field mask but missing from your input data.`);YE(p,b)||p.push(b)}l=new Ze(p),d=a.fieldTransforms.filter(I=>l.covers(I.field))}else l=null,d=a.fieldTransforms;return new $u(new Ge(c),l,d)}function HE(n,e,t,i=!1){return pl(t,n.Qu(i?4:3,e))}function pl(n,e){if(Jp(n=me(n)))return Xp("Unsupported field value:",e,n),Yp(n,e);if(n instanceof io)return function(i,r){if(!Kp(r.Cu))throw r.Bu(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Bu(`${i._methodName}() is not currently supported inside arrays`);let s=i._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(i,r){let s=[],a=0;for(let c of i){let l=pl(c,r.Lu(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(n,e)}return function(i,r){if((i=me(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return Dv(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){let s=Ee.fromDate(i);return{timestampValue:zs(r.serializer,s)}}if(i instanceof Ee){let s=new Ee(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:zs(r.serializer,s)}}if(i instanceof vr)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof yr)return{bytesValue:Ep(r.serializer,i._byteString)};if(i instanceof qe){let s=r.databaseId,a=i.firestore._databaseId;if(!a.isEqual(s))throw r.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:sl(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof Er)return function(a,c){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw c.Bu("VectorValues must only contain numeric values.");return rl(c.serializer,l)})}}}}}}(i,r);throw r.Bu(`Unsupported field value: ${po(i)}`)}(n,e)}function Yp(n,e){let t={};return Jf(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ei(n,(i,r)=>{let s=pl(r,e.Mu(i));s!=null&&(t[i]=s)}),{mapValue:{fields:t}}}function Jp(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ee||n instanceof vr||n instanceof yr||n instanceof qe||n instanceof io||n instanceof Er)}function Xp(n,e,t){if(!Jp(t)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(t)){let i=po(t);throw i==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+i)}}function KE(n,e,t){if((e=me(e))instanceof Ir)return e._internalPath;if(typeof e=="string")return Zp(n,e);throw ro("Field path arguments must be of type string or ",n,!1,void 0,t)}var QE=new RegExp("[~\\*/\\[\\]]");function Zp(n,e,t){if(e.search(QE)>=0)throw ro(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Ir(...e.split("."))._internalPath}catch{throw ro(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function ro(n,e,t,i,r){let s=i&&!i.isEmpty(),a=r!==void 0,c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${i}`),a&&(l+=` in document ${r}`),l+=")"),new x(C.INVALID_ARGUMENT,c+n+l)}function YE(n,e){return n.some(t=>t.isEqual(e))}var so=class{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new qe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Gu(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(ml("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Gu=class extends so{data(){return super.data()}};function ml(n,e){return typeof e=="string"?Zp(n,e):e instanceof Ir?e._internalPath:e._delegate._internalPath}function JE(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new x(C.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Tr=class{},ju=class extends Tr{};function em(n,e,...t){let i=[];e instanceof Tr&&i.push(e),i=i.concat(t),function(s){let a=s.filter(l=>l instanceof Hu).length,c=s.filter(l=>l instanceof oo).length;if(a>1||a>0&&c>0)throw new x(C.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(let r of i)n=r._apply(n);return n}var oo=class n extends ju{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=this._parse(e);return nm(e._query,t),new yi(e.firestore,e.converter,Uc(e._query,t))}_parse(e){let t=Qp(e.firestore);return function(s,a,c,l,d,p,I){let b;if(d.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new x(C.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){Qf(I,p);let R=[];for(let D of I)R.push(Kf(l,s,D));b={arrayValue:{values:R}}}else b=Kf(l,s,I)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||Qf(I,p),b=HE(c,a,I,p==="in"||p==="not-in");return he.create(d,p,b)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function tm(n,e,t){let i=e,r=ml("where",n);return oo._create(r,i,t)}var Hu=class n extends Tr{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return t.length===1?t[0]:He.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(r,s){let a=r,c=s.getFlattenedFilters();for(let l of c)nm(a,l),a=Uc(a,l)}(e._query,t),new yi(e.firestore,e.converter,Uc(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};function Kf(n,e,t){if(typeof(t=me(t))=="string"){if(t==="")throw new x(C.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ap(e)&&t.indexOf("/")!==-1)throw new x(C.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let i=e.path.child(re.fromString(t));if(!V.isDocumentKey(i))throw new x(C.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return vf(n,new V(i))}if(t instanceof qe)return vf(n,t._key);throw new x(C.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${po(t)}.`)}function Qf(n,e){if(!Array.isArray(n)||n.length===0)throw new x(C.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function nm(n,e){let t=function(r,s){for(let a of r)for(let c of a.getFlattenedFilters())if(s.indexOf(c.op)>=0)return c.op;return null}(n.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new x(C.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new x(C.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Ku=class{convertValue(e,t="none"){switch(Tn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ie(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Gt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw U()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let i={};return Ei(e,(r,s)=>{i[r]=this.convertValue(s,t)}),i}convertVectorValue(e){var t,i,r;let s=(r=(i=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||i===void 0?void 0:i.values)===null||r===void 0?void 0:r.map(a=>ie(a.doubleValue));return new Er(s)}convertGeoPoint(e){return new vr(ie(e.latitude),ie(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":let i=el(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(lr(e));default:return null}}convertTimestamp(e){let t=Et(e);return new Ee(t.seconds,t.nanos)}convertDocumentKey(e,t){let i=re.fromString(e);X(Rp(i));let r=new Fs(i.get(1),i.get(3)),s=new V(i.popFirst(5));return r.isEqual(t)||vt(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function XE(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}var ii=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Qu=class extends so{constructor(e,t,i,r,s,a){super(e,t,i,r,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new si(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let i=this._document.data.field(ml("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}},si=class extends Qu{data(e={}){return super.data(e)}},Yu=class{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new ii(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new si(this._firestore,this._userDataWriter,i.key,i,new ii(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new x(C.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let a=0;return r._snapshot.docChanges.map(c=>{let l=new si(r._firestore,r._userDataWriter,c.doc.key,c.doc,new ii(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter);return c.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(c=>s||c.type!==3).map(c=>{let l=new si(r._firestore,r._userDataWriter,c.doc.key,c.doc,new ii(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter),d=-1,p=-1;return c.type!==0&&(d=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),p=a.indexOf(c.doc.key)),{type:ZE(c.type),doc:l,oldIndex:d,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function ZE(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return U()}}var Ju=class extends Ku{constructor(e){super(),this.firestore=e}convertBytes(e){return new yr(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new qe(this.firestore,null,t)}};function im(n){n=_r(n,yi);let e=_r(n.firestore,Ii),t=Hp(e),i=new Ju(e);return JE(n._query),$E(t,n._query).then(r=>new Yu(e,i,n,r))}function rm(n){return om(_r(n.firestore,Ii),[new dr(n._key,Wt.none())])}function sm(n,e){let t=_r(n.firestore,Ii),i=fl(n),r=XE(n.converter,e);return om(t,[jE(Qp(n.firestore),"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,Wt.exists(!1))]).then(()=>i)}function om(n,e){return function(i,r){let s=new et;return i.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return DE(yield BE(i),r,s)})),s.promise}(Hp(n),e)}(function(e,t=!0){(function(r){vi=r})(Vt),Mt(new Fe("firestore",(i,{instanceIdentifier:r,options:s})=>{let a=i.getProvider("app").getImmediate(),c=new Ii(new Ic(i.getProvider("auth-internal")),new wc(i.getProvider("app-check-internal")),function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new x(C.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Fs(d.options.projectId,p)}(a,r),a);return s=Object.assign({useFetchStreams:t},s),c._setSettings(s),c},"PUBLIC").setMultipleInstances(!0)),fe(gf,"4.7.3",e),fe(gf,"4.7.3","esm2017")})();var Cn=class{constructor(e){return e}},am="firestore",gl=class{constructor(){return Hi(am)}};var _l=new Ln("angularfire2.firestore-instances");function eT(n,e){let t=ss(am,n,e);return t&&new Cn(t)}function tT(n){return(e,t)=>{let i=e.runOutsideAngular(()=>n(t));return new Cn(i)}}var nT={provide:gl,deps:[[new Ve,_l]]},iT={provide:Cn,useFactory:eT,deps:[[new Ve,_l],ft]};function ZS(n,...e){return fe("angularfire",fn.full,"fst"),Mn([iT,nT,{provide:_l,useFactory:tT(n),multi:!0,deps:[Ke,Vn,jn,pn,[new Ve,tr],[new Ve,Gn],...e]}])}var yl=ge(sm,!0);var Il=ge(rm,!0);var vl=ge(fl,!0);var Pn=ge(im,!0);var e0=ge(jp,!0);var Rr=ge(em,!0);var Cr=ge(tm,!0);var s0=(()=>{let e=class e{constructor(i,r){this.firestore=i,this.auth=r,this.uid=""}getUid(i){this.uid=i,console.log(this.uid)}setMovieToFavorites(i){return g(this,null,function*(){let r=this.auth.currentUser;if(r){let s=Kt(this.firestore,`users/${r.uid}/favorites`),a=Rr(s,Cr("movie.id","==",i.id));(yield Pn(a)).empty&&(yield yl(s,{movie:i}))}})}putMovieFromFavorites(i){return g(this,null,function*(){let r=this.auth.currentUser;if(r){let s=Kt(this.firestore,`users/${r.uid}/favorites`),a=Rr(s,Cr("movie.id","==",i.id));(yield Pn(a)).forEach(l=>g(this,null,function*(){let d=vl(this.firestore,`users/${r.uid}/favorites/${l.id}`);yield Il(d)}))}})}getFavoriteMovies(i){let r=Kt(this.firestore,`users/${i}/favorites`);return zo(Pn(r).then(s=>{let a=[];return s.forEach(c=>{let l=c.data();a.push(l.movie)}),console.log(a),a}))}setMovieToWachlist(i){return g(this,null,function*(){let r=this.auth.currentUser;if(r){let s=Kt(this.firestore,`users/${r.uid}/wachlist`),a=Rr(s,Cr("movie.id","==",i.id));(yield Pn(a)).empty&&(yield yl(s,{movie:i}))}})}putMovieFromWachlist(i){return g(this,null,function*(){let r=this.auth.currentUser;if(r){let s=Kt(this.firestore,`users/${r.uid}/wachlist`),a=Rr(s,Cr("movie.id","==",i.id));(yield Pn(a)).forEach(l=>g(this,null,function*(){let d=vl(this.firestore,`users/${r.uid}/wachlist/${l.id}`);yield Il(d)}))}})}getWachlist(i){let r=Kt(this.firestore,`users/${i}/wachlist`);return zo(Pn(r).then(s=>{let a=[];return s.forEach(c=>{let l=c.data();a.push(l.movie)}),console.log(a),a}))}};e.\u0275fac=function(r){return new(r||e)(en(Cn),en(_n))},e.\u0275prov=ct({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var Dn=class n{static isArray(e,t=!0){return Array.isArray(e)&&(t||e.length!==0)}static isObject(e,t=!0){return typeof e=="object"&&!Array.isArray(e)&&e!=null&&(t||Object.keys(e).length!==0)}static equals(e,t,i){return i?this.resolveFieldData(e,i)===this.resolveFieldData(t,i):this.equalsByValue(e,t)}static equalsByValue(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var i=Array.isArray(e),r=Array.isArray(t),s,a,c;if(i&&r){if(a=e.length,a!=t.length)return!1;for(s=a;s--!==0;)if(!this.equalsByValue(e[s],t[s]))return!1;return!0}if(i!=r)return!1;var l=this.isDate(e),d=this.isDate(t);if(l!=d)return!1;if(l&&d)return e.getTime()==t.getTime();var p=e instanceof RegExp,I=t instanceof RegExp;if(p!=I)return!1;if(p&&I)return e.toString()==t.toString();var b=Object.keys(e);if(a=b.length,a!==Object.keys(t).length)return!1;for(s=a;s--!==0;)if(!Object.prototype.hasOwnProperty.call(t,b[s]))return!1;for(s=a;s--!==0;)if(c=b[s],!this.equalsByValue(e[c],t[c]))return!1;return!0}return e!==e&&t!==t}static resolveFieldData(e,t){if(e&&t){if(this.isFunction(t))return t(e);if(t.indexOf(".")==-1)return e[t];{let i=t.split("."),r=e;for(let s=0,a=i.length;s<a;++s){if(r==null)return null;r=r[i[s]]}return r}}else return null}static isFunction(e){return!!(e&&e.constructor&&e.call&&e.apply)}static reorderArray(e,t,i){let r;e&&t!==i&&(i>=e.length&&(i%=e.length,t%=e.length),e.splice(i,0,e.splice(t,1)[0]))}static insertIntoOrderedArray(e,t,i,r){if(i.length>0){let s=!1;for(let a=0;a<i.length;a++)if(this.findIndexInList(i[a],r)>t){i.splice(a,0,e),s=!0;break}s||i.push(e)}else i.push(e)}static findIndexInList(e,t){let i=-1;if(t){for(let r=0;r<t.length;r++)if(t[r]==e){i=r;break}}return i}static contains(e,t){if(e!=null&&t&&t.length){for(let i of t)if(this.equals(e,i))return!0}return!1}static removeAccents(e){return e&&(e=e.normalize("NFKD").replace(new RegExp("\\p{Diacritic}","gu"),"")),e}static isDate(e){return Object.prototype.toString.call(e)==="[object Date]"}static isEmpty(e){return e==null||e===""||Array.isArray(e)&&e.length===0||!this.isDate(e)&&typeof e=="object"&&Object.keys(e).length===0}static isNotEmpty(e){return!this.isEmpty(e)}static compare(e,t,i,r=1){let s=-1,a=this.isEmpty(e),c=this.isEmpty(t);return a&&c?s=0:a?s=r:c?s=-r:typeof e=="string"&&typeof t=="string"?s=e.localeCompare(t,i,{numeric:!0}):s=e<t?-1:e>t?1:0,s}static sort(e,t,i=1,r,s=1){let a=n.compare(e,t,r,i),c=i;return(n.isEmpty(e)||n.isEmpty(t))&&(c=s===1?i:s),c*a}static merge(e,t){if(!(e==null&&t==null)){{if((e==null||typeof e=="object")&&(t==null||typeof t=="object"))return Ct(Ct({},e||{}),t||{});if((e==null||typeof e=="string")&&(t==null||typeof t=="string"))return[e||"",t||""].join(" ")}return t||e}}static isPrintableCharacter(e=""){return this.isNotEmpty(e)&&e.length===1&&e.match(/\S| /)}static getItemValue(e,...t){return this.isFunction(e)?e(...t):e}static findLastIndex(e,t){let i=-1;if(this.isNotEmpty(e))try{i=e.findLastIndex(t)}catch{i=e.lastIndexOf([...e].reverse().find(t))}return i}static findLast(e,t){let i;if(this.isNotEmpty(e))try{i=e.findLast(t)}catch{i=[...e].reverse().find(t)}return i}static deepEquals(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var i=Array.isArray(e),r=Array.isArray(t),s,a,c;if(i&&r){if(a=e.length,a!=t.length)return!1;for(s=a;s--!==0;)if(!this.deepEquals(e[s],t[s]))return!1;return!0}if(i!=r)return!1;var l=e instanceof Date,d=t instanceof Date;if(l!=d)return!1;if(l&&d)return e.getTime()==t.getTime();var p=e instanceof RegExp,I=t instanceof RegExp;if(p!=I)return!1;if(p&&I)return e.toString()==t.toString();var b=Object.keys(e);if(a=b.length,a!==Object.keys(t).length)return!1;for(s=a;s--!==0;)if(!Object.prototype.hasOwnProperty.call(t,b[s]))return!1;for(s=a;s--!==0;)if(c=b[s],!this.deepEquals(e[c],t[c]))return!1;return!0}return e!==e&&t!==t}},cm=0;function um(n="pn_id_"){return cm++,`${n}${cm}`}function sT(){let n=[],e=(s,a)=>{let c=n.length>0?n[n.length-1]:{key:s,value:a},l=c.value+(c.key===s?0:a)+2;return n.push({key:s,value:l}),l},t=s=>{n=n.filter(a=>a.value!==s)},i=()=>n.length>0?n[n.length-1].value:0,r=s=>s&&parseInt(s.style.zIndex,10)||0;return{get:r,set:(s,a,c)=>{a&&(a.style.zIndex=String(e(s,c)))},clear:s=>{s&&(t(r(s)),s.style.zIndex="")},getCurrent:()=>i()}}var c0=sT();var lm=["*"];var Pe=(()=>{class n{static STARTS_WITH="startsWith";static CONTAINS="contains";static NOT_CONTAINS="notContains";static ENDS_WITH="endsWith";static EQUALS="equals";static NOT_EQUALS="notEquals";static IN="in";static LESS_THAN="lt";static LESS_THAN_OR_EQUAL_TO="lte";static GREATER_THAN="gt";static GREATER_THAN_OR_EQUAL_TO="gte";static BETWEEN="between";static IS="is";static IS_NOT="isNot";static BEFORE="before";static AFTER="after";static DATE_IS="dateIs";static DATE_IS_NOT="dateIsNot";static DATE_BEFORE="dateBefore";static DATE_AFTER="dateAfter"}return n})();var y0=(()=>{class n{clickSource=new qo;clickObservable=this.clickSource.asObservable();add(t){t&&this.clickSource.next(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ct({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var hm=(()=>{class n{ripple=!1;inputStyle=Go("outlined");overlayOptions={};csp=Go({nonce:void 0});filterMatchModeOptions={text:[Pe.STARTS_WITH,Pe.CONTAINS,Pe.NOT_CONTAINS,Pe.ENDS_WITH,Pe.EQUALS,Pe.NOT_EQUALS],numeric:[Pe.EQUALS,Pe.NOT_EQUALS,Pe.LESS_THAN,Pe.LESS_THAN_OR_EQUAL_TO,Pe.GREATER_THAN,Pe.GREATER_THAN_OR_EQUAL_TO],date:[Pe.DATE_IS,Pe.DATE_IS_NOT,Pe.DATE_BEFORE,Pe.DATE_AFTER]};translation={startsWith:"Starts with",contains:"Contains",notContains:"Not contains",endsWith:"Ends with",equals:"Equals",notEquals:"Not equals",noFilter:"No Filter",lt:"Less than",lte:"Less than or equal to",gt:"Greater than",gte:"Greater than or equal to",is:"Is",isNot:"Is not",before:"Before",after:"After",dateIs:"Date is",dateIsNot:"Date is not",dateBefore:"Date is before",dateAfter:"Date is after",clear:"Clear",apply:"Apply",matchAll:"Match All",matchAny:"Match Any",addRule:"Add Rule",removeRule:"Remove Rule",accept:"Yes",reject:"No",choose:"Choose",upload:"Upload",cancel:"Cancel",pending:"Pending",fileSizeTypes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],chooseYear:"Choose Year",chooseMonth:"Choose Month",chooseDate:"Choose Date",prevDecade:"Previous Decade",nextDecade:"Next Decade",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",prevHour:"Previous Hour",nextHour:"Next Hour",prevMinute:"Previous Minute",nextMinute:"Next Minute",prevSecond:"Previous Second",nextSecond:"Next Second",am:"am",pm:"pm",dateFormat:"mm/dd/yy",firstDayOfWeek:0,today:"Today",weekHeader:"Wk",weak:"Weak",medium:"Medium",strong:"Strong",passwordPrompt:"Enter a password",emptyMessage:"No results found",searchMessage:"{0} results are available",selectionMessage:"{0} items selected",emptySelectionMessage:"No selected item",emptySearchMessage:"No results found",emptyFilterMessage:"No results found",aria:{trueLabel:"True",falseLabel:"False",nullLabel:"Not Selected",star:"1 star",stars:"{star} stars",selectAll:"All items selected",unselectAll:"All items unselected",close:"Close",previous:"Previous",next:"Next",navigation:"Navigation",scrollTop:"Scroll Top",moveTop:"Move Top",moveUp:"Move Up",moveDown:"Move Down",moveBottom:"Move Bottom",moveToTarget:"Move to Target",moveToSource:"Move to Source",moveAllToTarget:"Move All to Target",moveAllToSource:"Move All to Source",pageLabel:"{page}",firstPageLabel:"First Page",lastPageLabel:"Last Page",nextPageLabel:"Next Page",prevPageLabel:"Previous Page",rowsPerPageLabel:"Rows per page",previousPageLabel:"Previous Page",jumpToPageDropdownLabel:"Jump to Page Dropdown",jumpToPageInputLabel:"Jump to Page Input",selectRow:"Row Selected",unselectRow:"Row Unselected",expandRow:"Row Expanded",collapseRow:"Row Collapsed",showFilterMenu:"Show Filter Menu",hideFilterMenu:"Hide Filter Menu",filterOperator:"Filter Operator",filterConstraint:"Filter Constraint",editRow:"Row Edit",saveEdit:"Save Edit",cancelEdit:"Cancel Edit",listView:"List View",gridView:"Grid View",slide:"Slide",slideNumber:"{slideNumber}",zoomImage:"Zoom Image",zoomIn:"Zoom In",zoomOut:"Zoom Out",rotateRight:"Rotate Right",rotateLeft:"Rotate Left",listLabel:"Option List",selectColor:"Select a color",removeLabel:"Remove",browseFiles:"Browse Files",maximizeLabel:"Maximize"}};zIndex={modal:1100,overlay:1e3,menu:1e3,tooltip:1100};translationSource=new qo;translationObserver=this.translationSource.asObservable();getTranslation(t){return this.translation[t]}setTranslation(t){this.translation=Ct(Ct({},this.translation),t),this.translationSource.next(this.translation)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=ct({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),I0=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275cmp=ut({type:n,selectors:[["p-header"]],standalone:!0,features:[lt],ngContentSelectors:lm,decls:1,vars:0,template:function(i,r){i&1&&(cn(),un(0))},encapsulation:2})}return n})(),v0=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275cmp=ut({type:n,selectors:[["p-footer"]],standalone:!0,features:[lt],ngContentSelectors:lm,decls:1,vars:0,template:function(i,r){i&1&&(cn(),un(0))},encapsulation:2})}return n})(),dm=(()=>{class n{template;type;name;constructor(t){this.template=t}getType(){return this.name}static \u0275fac=function(i){return new(i||n)(xe(Ph))};static \u0275dir=Ot({type:n,selectors:[["","pTemplate",""]],inputs:{type:"type",name:[oe.None,"pTemplate","name"]},standalone:!0})}return n})(),fm=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=Nt({type:n});static \u0275inj=Dt({})}return n})(),E0=(()=>{class n{static STARTS_WITH="startsWith";static CONTAINS="contains";static NOT_CONTAINS="notContains";static ENDS_WITH="endsWith";static EQUALS="equals";static NOT_EQUALS="notEquals";static NO_FILTER="noFilter";static LT="lt";static LTE="lte";static GT="gt";static GTE="gte";static IS="is";static IS_NOT="isNot";static BEFORE="before";static AFTER="after";static CLEAR="clear";static APPLY="apply";static MATCH_ALL="matchAll";static MATCH_ANY="matchAny";static ADD_RULE="addRule";static REMOVE_RULE="removeRule";static ACCEPT="accept";static REJECT="reject";static CHOOSE="choose";static UPLOAD="upload";static CANCEL="cancel";static PENDING="pending";static FILE_SIZE_TYPES="fileSizeTypes";static DAY_NAMES="dayNames";static DAY_NAMES_SHORT="dayNamesShort";static DAY_NAMES_MIN="dayNamesMin";static MONTH_NAMES="monthNames";static MONTH_NAMES_SHORT="monthNamesShort";static FIRST_DAY_OF_WEEK="firstDayOfWeek";static TODAY="today";static WEEK_HEADER="weekHeader";static WEAK="weak";static MEDIUM="medium";static STRONG="strong";static PASSWORD_PROMPT="passwordPrompt";static EMPTY_MESSAGE="emptyMessage";static EMPTY_FILTER_MESSAGE="emptyFilterMessage";static SHOW_FILTER_MENU="showFilterMenu";static HIDE_FILTER_MENU="hideFilterMenu";static SELECTION_MESSAGE="selectionMessage";static ARIA="aria";static SELECT_COLOR="selectColor";static BROWSE_FILES="browseFiles"}return n})();var ee=(()=>{class n{static zindex=1e3;static calculatedScrollbarWidth=null;static calculatedScrollbarHeight=null;static browser;static addClass(t,i){t&&i&&(t.classList?t.classList.add(i):t.className+=" "+i)}static addMultipleClasses(t,i){if(t&&i)if(t.classList){let r=i.trim().split(" ");for(let s=0;s<r.length;s++)t.classList.add(r[s])}else{let r=i.split(" ");for(let s=0;s<r.length;s++)t.className+=" "+r[s]}}static removeClass(t,i){t&&i&&(t.classList?t.classList.remove(i):t.className=t.className.replace(new RegExp("(^|\\b)"+i.split(" ").join("|")+"(\\b|$)","gi")," "))}static removeMultipleClasses(t,i){t&&i&&[i].flat().filter(Boolean).forEach(r=>r.split(" ").forEach(s=>this.removeClass(t,s)))}static hasClass(t,i){return t&&i?t.classList?t.classList.contains(i):new RegExp("(^| )"+i+"( |$)","gi").test(t.className):!1}static siblings(t){return Array.prototype.filter.call(t.parentNode.children,function(i){return i!==t})}static find(t,i){return Array.from(t.querySelectorAll(i))}static findSingle(t,i){return this.isElement(t)?t.querySelector(i):null}static index(t){let i=t.parentNode.childNodes,r=0;for(var s=0;s<i.length;s++){if(i[s]==t)return r;i[s].nodeType==1&&r++}return-1}static indexWithinGroup(t,i){let r=t.parentNode?t.parentNode.childNodes:[],s=0;for(var a=0;a<r.length;a++){if(r[a]==t)return s;r[a].attributes&&r[a].attributes[i]&&r[a].nodeType==1&&s++}return-1}static appendOverlay(t,i,r="self"){r!=="self"&&t&&i&&this.appendChild(t,i)}static alignOverlay(t,i,r="self",s=!0){t&&i&&(s&&(t.style.minWidth=`${n.getOuterWidth(i)}px`),r==="self"?this.relativePosition(t,i):this.absolutePosition(t,i))}static relativePosition(t,i,r=!0){let s=W=>{if(W)return getComputedStyle(W).getPropertyValue("position")==="relative"?W:s(W.parentElement)},a=t.offsetParent?{width:t.offsetWidth,height:t.offsetHeight}:this.getHiddenElementDimensions(t),c=i.offsetHeight,l=i.getBoundingClientRect(),d=this.getWindowScrollTop(),p=this.getWindowScrollLeft(),I=this.getViewport(),R=s(t)?.getBoundingClientRect()||{top:-1*d,left:-1*p},D,k;l.top+c+a.height>I.height?(D=l.top-R.top-a.height,t.style.transformOrigin="bottom",l.top+D<0&&(D=-1*l.top)):(D=c+l.top-R.top,t.style.transformOrigin="top");let O=l.left+a.width-I.width,z=l.left-R.left;a.width>I.width?k=(l.left-R.left)*-1:O>0?k=z-O:k=l.left-R.left,t.style.top=D+"px",t.style.left=k+"px",r&&(t.style.marginTop=origin==="bottom"?"calc(var(--p-anchor-gutter) * -1)":"calc(var(--p-anchor-gutter))")}static absolutePosition(t,i,r=!0){let s=t.offsetParent?{width:t.offsetWidth,height:t.offsetHeight}:this.getHiddenElementDimensions(t),a=s.height,c=s.width,l=i.offsetHeight,d=i.offsetWidth,p=i.getBoundingClientRect(),I=this.getWindowScrollTop(),b=this.getWindowScrollLeft(),R=this.getViewport(),D,k;p.top+l+a>R.height?(D=p.top+I-a,t.style.transformOrigin="bottom",D<0&&(D=I)):(D=l+p.top+I,t.style.transformOrigin="top"),p.left+c>R.width?k=Math.max(0,p.left+b+d-c):k=p.left+b,t.style.top=D+"px",t.style.left=k+"px",r&&(t.style.marginTop=origin==="bottom"?"calc(var(--p-anchor-gutter) * -1)":"calc(var(--p-anchor-gutter))")}static getParents(t,i=[]){return t.parentNode===null?i:this.getParents(t.parentNode,i.concat([t.parentNode]))}static getScrollableParents(t){let i=[];if(t){let r=this.getParents(t),s=/(auto|scroll)/,a=c=>{let l=window.getComputedStyle(c,null);return s.test(l.getPropertyValue("overflow"))||s.test(l.getPropertyValue("overflowX"))||s.test(l.getPropertyValue("overflowY"))};for(let c of r){let l=c.nodeType===1&&c.dataset.scrollselectors;if(l){let d=l.split(",");for(let p of d){let I=this.findSingle(c,p);I&&a(I)&&i.push(I)}}c.nodeType!==9&&a(c)&&i.push(c)}}return i}static getHiddenElementOuterHeight(t){t.style.visibility="hidden",t.style.display="block";let i=t.offsetHeight;return t.style.display="none",t.style.visibility="visible",i}static getHiddenElementOuterWidth(t){t.style.visibility="hidden",t.style.display="block";let i=t.offsetWidth;return t.style.display="none",t.style.visibility="visible",i}static getHiddenElementDimensions(t){let i={};return t.style.visibility="hidden",t.style.display="block",i.width=t.offsetWidth,i.height=t.offsetHeight,t.style.display="none",t.style.visibility="visible",i}static scrollInView(t,i){let r=getComputedStyle(t).getPropertyValue("borderTopWidth"),s=r?parseFloat(r):0,a=getComputedStyle(t).getPropertyValue("paddingTop"),c=a?parseFloat(a):0,l=t.getBoundingClientRect(),p=i.getBoundingClientRect().top+document.body.scrollTop-(l.top+document.body.scrollTop)-s-c,I=t.scrollTop,b=t.clientHeight,R=this.getOuterHeight(i);p<0?t.scrollTop=I+p:p+R>b&&(t.scrollTop=I+p-b+R)}static fadeIn(t,i){t.style.opacity=0;let r=+new Date,s=0,a=function(){s=+t.style.opacity.replace(",",".")+(new Date().getTime()-r)/i,t.style.opacity=s,r=+new Date,+s<1&&(window.requestAnimationFrame&&requestAnimationFrame(a)||setTimeout(a,16))};a()}static fadeOut(t,i){var r=1,s=50,a=i,c=s/a;let l=setInterval(()=>{r=r-c,r<=0&&(r=0,clearInterval(l)),t.style.opacity=r},s)}static getWindowScrollTop(){let t=document.documentElement;return(window.pageYOffset||t.scrollTop)-(t.clientTop||0)}static getWindowScrollLeft(){let t=document.documentElement;return(window.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}static matches(t,i){var r=Element.prototype,s=r.matches||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector||function(a){return[].indexOf.call(document.querySelectorAll(a),this)!==-1};return s.call(t,i)}static getOuterWidth(t,i){let r=t.offsetWidth;if(i){let s=getComputedStyle(t);r+=parseFloat(s.marginLeft)+parseFloat(s.marginRight)}return r}static getHorizontalPadding(t){let i=getComputedStyle(t);return parseFloat(i.paddingLeft)+parseFloat(i.paddingRight)}static getHorizontalMargin(t){let i=getComputedStyle(t);return parseFloat(i.marginLeft)+parseFloat(i.marginRight)}static innerWidth(t){let i=t.offsetWidth,r=getComputedStyle(t);return i+=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight),i}static width(t){let i=t.offsetWidth,r=getComputedStyle(t);return i-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight),i}static getInnerHeight(t){let i=t.offsetHeight,r=getComputedStyle(t);return i+=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom),i}static getOuterHeight(t,i){let r=t.offsetHeight;if(i){let s=getComputedStyle(t);r+=parseFloat(s.marginTop)+parseFloat(s.marginBottom)}return r}static getHeight(t){let i=t.offsetHeight,r=getComputedStyle(t);return i-=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom)+parseFloat(r.borderTopWidth)+parseFloat(r.borderBottomWidth),i}static getWidth(t){let i=t.offsetWidth,r=getComputedStyle(t);return i-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight)+parseFloat(r.borderLeftWidth)+parseFloat(r.borderRightWidth),i}static getViewport(){let t=window,i=document,r=i.documentElement,s=i.getElementsByTagName("body")[0],a=t.innerWidth||r.clientWidth||s.clientWidth,c=t.innerHeight||r.clientHeight||s.clientHeight;return{width:a,height:c}}static getOffset(t){var i=t.getBoundingClientRect();return{top:i.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:i.left+(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0)}}static replaceElementWith(t,i){let r=t.parentNode;if(!r)throw"Can't replace element";return r.replaceChild(i,t)}static getUserAgent(){if(navigator&&this.isClient())return navigator.userAgent}static isIE(){var t=window.navigator.userAgent,i=t.indexOf("MSIE ");if(i>0)return!0;var r=t.indexOf("Trident/");if(r>0){var s=t.indexOf("rv:");return!0}var a=t.indexOf("Edge/");return a>0}static isIOS(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}static isAndroid(){return/(android)/i.test(navigator.userAgent)}static isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0}static appendChild(t,i){if(this.isElement(i))i.appendChild(t);else if(i&&i.el&&i.el.nativeElement)i.el.nativeElement.appendChild(t);else throw"Cannot append "+i+" to "+t}static removeChild(t,i){if(this.isElement(i))i.removeChild(t);else if(i.el&&i.el.nativeElement)i.el.nativeElement.removeChild(t);else throw"Cannot remove "+t+" from "+i}static removeElement(t){"remove"in Element.prototype?t.remove():t.parentNode.removeChild(t)}static isElement(t){return typeof HTMLElement=="object"?t instanceof HTMLElement:t&&typeof t=="object"&&t!==null&&t.nodeType===1&&typeof t.nodeName=="string"}static calculateScrollbarWidth(t){if(t){let i=getComputedStyle(t);return t.offsetWidth-t.clientWidth-parseFloat(i.borderLeftWidth)-parseFloat(i.borderRightWidth)}else{if(this.calculatedScrollbarWidth!==null)return this.calculatedScrollbarWidth;let i=document.createElement("div");i.className="p-scrollbar-measure",document.body.appendChild(i);let r=i.offsetWidth-i.clientWidth;return document.body.removeChild(i),this.calculatedScrollbarWidth=r,r}}static calculateScrollbarHeight(){if(this.calculatedScrollbarHeight!==null)return this.calculatedScrollbarHeight;let t=document.createElement("div");t.className="p-scrollbar-measure",document.body.appendChild(t);let i=t.offsetHeight-t.clientHeight;return document.body.removeChild(t),this.calculatedScrollbarWidth=i,i}static invokeElementMethod(t,i,r){t[i].apply(t,r)}static clearSelection(){if(window.getSelection)window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().rangeCount>0&&window.getSelection().getRangeAt(0).getClientRects().length>0&&window.getSelection().removeAllRanges();else if(document.selection&&document.selection.empty)try{document.selection.empty()}catch{}}static getBrowser(){if(!this.browser){let t=this.resolveUserAgent();this.browser={},t.browser&&(this.browser[t.browser]=!0,this.browser.version=t.version),this.browser.chrome?this.browser.webkit=!0:this.browser.webkit&&(this.browser.safari=!0)}return this.browser}static resolveUserAgent(){let t=navigator.userAgent.toLowerCase(),i=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return{browser:i[1]||"",version:i[2]||"0"}}static isInteger(t){return Number.isInteger?Number.isInteger(t):typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}static isHidden(t){return!t||t.offsetParent===null}static isVisible(t){return t&&t.offsetParent!=null}static isExist(t){return t!==null&&typeof t<"u"&&t.nodeName&&t.parentNode}static focus(t,i){t&&document.activeElement!==t&&t.focus(i)}static getFocusableSelectorString(t=""){return`button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${t},
        [href][clientHeight][clientWidth]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${t},
        input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${t},
        select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${t},
        textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${t},
        [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${t},
        [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${t},
        .p-inputtext:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${t},
        .p-button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${t}`}static getFocusableElements(t,i=""){let r=this.find(t,this.getFocusableSelectorString(i)),s=[];for(let a of r){let c=getComputedStyle(a);this.isVisible(a)&&c.display!="none"&&c.visibility!="hidden"&&s.push(a)}return s}static getFocusableElement(t,i=""){let r=this.findSingle(t,this.getFocusableSelectorString(i));if(r){let s=getComputedStyle(r);if(this.isVisible(r)&&s.display!="none"&&s.visibility!="hidden")return r}return null}static getFirstFocusableElement(t,i=""){let r=this.getFocusableElements(t,i);return r.length>0?r[0]:null}static getLastFocusableElement(t,i){let r=this.getFocusableElements(t,i);return r.length>0?r[r.length-1]:null}static getNextFocusableElement(t,i=!1){let r=n.getFocusableElements(t),s=0;if(r&&r.length>0){let a=r.indexOf(r[0].ownerDocument.activeElement);i?a==-1||a===0?s=r.length-1:s=a-1:a!=-1&&a!==r.length-1&&(s=a+1)}return r[s]}static generateZIndex(){return this.zindex=this.zindex||999,++this.zindex}static getSelection(){return window.getSelection?window.getSelection().toString():document.getSelection?document.getSelection().toString():document.selection?document.selection.createRange().text:null}static getTargetElement(t,i){if(!t)return null;switch(t){case"document":return document;case"window":return window;case"@next":return i?.nextElementSibling;case"@prev":return i?.previousElementSibling;case"@parent":return i?.parentElement;case"@grandparent":return i?.parentElement.parentElement;default:let r=typeof t;if(r==="string")return document.querySelector(t);if(r==="object"&&t.hasOwnProperty("nativeElement"))return this.isExist(t.nativeElement)?t.nativeElement:void 0;let a=(c=>!!(c&&c.constructor&&c.call&&c.apply))(t)?t():t;return a&&a.nodeType===9||this.isExist(a)?a:null}}static isClient(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}static getAttribute(t,i){if(t){let r=t.getAttribute(i);return isNaN(r)?r==="true"||r==="false"?r==="true":r:+r}}static calculateBodyScrollbarWidth(){return window.innerWidth-document.documentElement.offsetWidth}static blockBodyScroll(t="p-overflow-hidden"){document.body.style.setProperty("--scrollbar-width",this.calculateBodyScrollbarWidth()+"px"),this.addClass(document.body,t)}static unblockBodyScroll(t="p-overflow-hidden"){document.body.style.removeProperty("--scrollbar-width"),this.removeClass(document.body,t)}static createElement(t,i={},...r){if(t){let s=document.createElement(t);return this.setAttributes(s,i),s.append(...r),s}}static setAttribute(t,i="",r){this.isElement(t)&&r!==null&&r!==void 0&&t.setAttribute(i,r)}static setAttributes(t,i={}){if(this.isElement(t)){let r=(s,a)=>{let c=t?.$attrs?.[s]?[t?.$attrs?.[s]]:[];return[a].flat().reduce((l,d)=>{if(d!=null){let p=typeof d;if(p==="string"||p==="number")l.push(d);else if(p==="object"){let I=Array.isArray(d)?r(s,d):Object.entries(d).map(([b,R])=>s==="style"&&(R||R===0)?`${b.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}:${R}`:R?b:void 0);l=I.length?l.concat(I.filter(b=>!!b)):l}}return l},c)};Object.entries(i).forEach(([s,a])=>{if(a!=null){let c=s.match(/^on(.+)/);c?t.addEventListener(c[1].toLowerCase(),a):s==="pBind"?this.setAttributes(t,a):(a=s==="class"?[...new Set(r("class",a))].join(" ").trim():s==="style"?r("style",a).join(";").trim():a,(t.$attrs=t.$attrs||{})&&(t.$attrs[s]=a),t.setAttribute(s,a))}})}}static isFocusableElement(t,i=""){return this.isElement(t)?t.matches(`button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${i},
                [href][clientHeight][clientWidth]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${i},
                input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${i},
                select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${i},
                textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${i},
                [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${i},
                [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${i}`):!1}}return n})(),pm=class{element;listener;scrollableParents;constructor(e,t=()=>{}){this.element=e,this.listener=t}bindScrollListener(){this.scrollableParents=ee.getScrollableParents(this.element);for(let e=0;e<this.scrollableParents.length;e++)this.scrollableParents[e].addEventListener("scroll",this.listener)}unbindScrollListener(){if(this.scrollableParents)for(let e=0;e<this.scrollableParents.length;e++)this.scrollableParents[e].removeEventListener("scroll",this.listener)}destroy(){this.unbindScrollListener(),this.element=null,this.listener=null,this.scrollableParents=null}};var mm=(()=>{class n{autofocus=!1;focused=!1;platformId=Hr(Fn);document=Hr(Un);host=Hr(tn);ngAfterContentChecked(){this.autofocus===!1?this.host.nativeElement.removeAttribute("autofocus"):this.host.nativeElement.setAttribute("autofocus",!0),this.focused||this.autoFocus()}ngAfterViewChecked(){this.focused||this.autoFocus()}autoFocus(){Xr(this.platformId)&&this.autofocus&&setTimeout(()=>{let t=ee.getFocusableElements(this.host?.nativeElement);t.length===0&&this.host.nativeElement.focus(),t.length>0&&t[0].focus(),this.focused=!0})}static \u0275fac=function(i){return new(i||n)};static \u0275dir=Ot({type:n,selectors:[["","pAutoFocus",""]],hostAttrs:[1,"p-element"],inputs:{autofocus:[oe.HasDecoratorInputTransform,"autofocus","autofocus",de]},standalone:!0,features:[nn]})}return n})(),D0=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=Nt({type:n});static \u0275inj=Dt({})}return n})();var aT=["*"],gm=(()=>{class n{label;spin=!1;styleClass;role;ariaLabel;ariaHidden;ngOnInit(){this.getAttributes()}getAttributes(){let t=Dn.isEmpty(this.label);this.role=t?void 0:"img",this.ariaLabel=t?void 0:this.label,this.ariaHidden=t}getClassNames(){return`p-icon ${this.styleClass?this.styleClass+" ":""}${this.spin?"p-icon-spin":""}`}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=ut({type:n,selectors:[["ng-component"]],hostAttrs:[1,"p-element","p-icon-wrapper"],inputs:{label:"label",spin:[oe.HasDecoratorInputTransform,"spin","spin",de],styleClass:"styleClass"},standalone:!0,features:[nn,lt],ngContentSelectors:aT,decls:1,vars:0,template:function(i,r){i&1&&(cn(),un(0))},encapsulation:2,changeDetection:0})}return n})();var _m=(()=>{class n extends gm{pathId;ngOnInit(){this.pathId="url(#"+um()+")"}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Ch(n)))(r||n)}})();static \u0275cmp=ut({type:n,selectors:[["SpinnerIcon"]],standalone:!0,features:[Nh,lt],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M6.99701 14C5.85441 13.999 4.72939 13.7186 3.72012 13.1832C2.71084 12.6478 1.84795 11.8737 1.20673 10.9284C0.565504 9.98305 0.165424 8.89526 0.041387 7.75989C-0.0826496 6.62453 0.073125 5.47607 0.495122 4.4147C0.917119 3.35333 1.59252 2.4113 2.46241 1.67077C3.33229 0.930247 4.37024 0.413729 5.4857 0.166275C6.60117 -0.0811796 7.76026 -0.0520535 8.86188 0.251112C9.9635 0.554278 10.9742 1.12227 11.8057 1.90555C11.915 2.01493 11.9764 2.16319 11.9764 2.31778C11.9764 2.47236 11.915 2.62062 11.8057 2.73C11.7521 2.78503 11.688 2.82877 11.6171 2.85864C11.5463 2.8885 11.4702 2.90389 11.3933 2.90389C11.3165 2.90389 11.2404 2.8885 11.1695 2.85864C11.0987 2.82877 11.0346 2.78503 10.9809 2.73C9.9998 1.81273 8.73246 1.26138 7.39226 1.16876C6.05206 1.07615 4.72086 1.44794 3.62279 2.22152C2.52471 2.99511 1.72683 4.12325 1.36345 5.41602C1.00008 6.70879 1.09342 8.08723 1.62775 9.31926C2.16209 10.5513 3.10478 11.5617 4.29713 12.1803C5.48947 12.7989 6.85865 12.988 8.17414 12.7157C9.48963 12.4435 10.6711 11.7264 11.5196 10.6854C12.3681 9.64432 12.8319 8.34282 12.8328 7C12.8328 6.84529 12.8943 6.69692 13.0038 6.58752C13.1132 6.47812 13.2616 6.41667 13.4164 6.41667C13.5712 6.41667 13.7196 6.47812 13.8291 6.58752C13.9385 6.69692 14 6.84529 14 7C14 8.85651 13.2622 10.637 11.9489 11.9497C10.6356 13.2625 8.85432 14 6.99701 14Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,r){i&1&&(Rh(),sn(0,"svg",0)(1,"g"),an(2,"path",1),on(),sn(3,"defs")(4,"clipPath",2),an(5,"rect",3),on()()()),i&2&&(Qr(r.getClassNames()),Qe("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),Ie(),Qe("clip-path",r.pathId),Ie(3),ce("id",r.pathId))},encapsulation:2})}return n})();var ym=(()=>{class n{document;platformId;renderer;el;zone;config;constructor(t,i,r,s,a,c){this.document=t,this.platformId=i,this.renderer=r,this.el=s,this.zone=a,this.config=c}animationListener;mouseDownListener;timeout;ngAfterViewInit(){Xr(this.platformId)&&this.config&&this.config.ripple&&this.zone.runOutsideAngular(()=>{this.create(),this.mouseDownListener=this.renderer.listen(this.el.nativeElement,"mousedown",this.onMouseDown.bind(this))})}onMouseDown(t){let i=this.getInk();if(!i||this.document.defaultView?.getComputedStyle(i,null).display==="none")return;if(ee.removeClass(i,"p-ink-active"),!ee.getHeight(i)&&!ee.getWidth(i)){let c=Math.max(ee.getOuterWidth(this.el.nativeElement),ee.getOuterHeight(this.el.nativeElement));i.style.height=c+"px",i.style.width=c+"px"}let r=ee.getOffset(this.el.nativeElement),s=t.pageX-r.left+this.document.body.scrollTop-ee.getWidth(i)/2,a=t.pageY-r.top+this.document.body.scrollLeft-ee.getHeight(i)/2;this.renderer.setStyle(i,"top",a+"px"),this.renderer.setStyle(i,"left",s+"px"),ee.addClass(i,"p-ink-active"),this.timeout=setTimeout(()=>{let c=this.getInk();c&&ee.removeClass(c,"p-ink-active")},401)}getInk(){let t=this.el.nativeElement.children;for(let i=0;i<t.length;i++)if(typeof t[i].className=="string"&&t[i].className.indexOf("p-ink")!==-1)return t[i];return null}resetInk(){let t=this.getInk();t&&ee.removeClass(t,"p-ink-active")}onAnimationEnd(t){this.timeout&&clearTimeout(this.timeout),ee.removeClass(t.currentTarget,"p-ink-active")}create(){let t=this.renderer.createElement("span");this.renderer.addClass(t,"p-ink"),this.renderer.appendChild(this.el.nativeElement,t),this.renderer.setAttribute(t,"aria-hidden","true"),this.renderer.setAttribute(t,"role","presentation"),this.animationListener||(this.animationListener=this.renderer.listen(t,"animationend",this.onAnimationEnd.bind(this)))}remove(){let t=this.getInk();t&&(this.mouseDownListener&&this.mouseDownListener(),this.animationListener&&this.animationListener(),this.mouseDownListener=null,this.animationListener=null,ee.removeElement(t))}ngOnDestroy(){this.config&&this.config.ripple&&this.remove()}static \u0275fac=function(i){return new(i||n)(xe(Un),xe(Fn),xe(Dh),xe(tn),xe(Ke),xe(hm,8))};static \u0275dir=Ot({type:n,selectors:[["","pRipple",""]],hostAttrs:[1,"p-ripple","p-element"],standalone:!0})}return n})(),Q0=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=Nt({type:n});static \u0275inj=Dt({})}return n})();var cT=["*"],Im=n=>({class:n});function uT(n,e){n&1&&Oh(0)}function lT(n,e){if(n&1&&an(0,"span",8),n&2){let t=We(3);ce("ngClass",t.iconClass()),Qe("aria-hidden",!0)("data-pc-section","loadingicon")}}function hT(n,e){if(n&1&&an(0,"SpinnerIcon",9),n&2){let t=We(3);ce("styleClass",t.spinnerIconClass())("spin",!0),Qe("aria-hidden",!0)("data-pc-section","loadingicon")}}function dT(n,e){if(n&1&&(Yr(0),rn(1,lT,1,3,"span",6)(2,hT,1,4,"SpinnerIcon",7),Jr()),n&2){let t=We(2);Ie(),ce("ngIf",t.loadingIcon),Ie(),ce("ngIf",!t.loadingIcon)}}function fT(n,e){}function pT(n,e){if(n&1&&rn(0,fT,0,0,"ng-template",10),n&2){let t=We(2);ce("ngIf",t.loadingIconTemplate)}}function mT(n,e){if(n&1&&(Yr(0),rn(1,dT,3,2,"ng-container",2)(2,pT,1,1,null,5),Jr()),n&2){let t=We();Ie(),ce("ngIf",!t.loadingIconTemplate),Ie(),ce("ngTemplateOutlet",t.loadingIconTemplate)("ngTemplateOutletContext",Ko(3,Im,t.iconClass()))}}function gT(n,e){if(n&1&&an(0,"span",8),n&2){let t=We(2);ce("ngClass",t.iconClass()),Qe("data-pc-section","icon")}}function _T(n,e){}function yT(n,e){if(n&1&&rn(0,_T,0,0,"ng-template",10),n&2){let t=We(2);ce("ngIf",!t.icon&&t.iconTemplate)}}function IT(n,e){if(n&1&&(Yr(0),rn(1,gT,1,2,"span",6)(2,yT,1,1,null,5),Jr()),n&2){let t=We();Ie(),ce("ngIf",t.icon&&!t.iconTemplate),Ie(),ce("ngTemplateOutlet",t.iconTemplate)("ngTemplateOutletContext",Ko(3,Im,t.iconClass()))}}function vT(n,e){if(n&1&&(sn(0,"span",11),jo(1),on()),n&2){let t=We();Qe("aria-hidden",t.icon&&!t.label)("data-pc-section","label"),Ie(),Ho(t.label)}}function ET(n,e){if(n&1&&(sn(0,"span",8),jo(1),on()),n&2){let t=We();Qr(t.badgeClass),ce("ngClass",t.badgeStyleClass()),Qe("data-pc-section","badge"),Ie(),Ho(t.badge)}}var Qt={button:"p-button",component:"p-component",iconOnly:"p-button-icon-only",disabled:"p-disabled",loading:"p-button-loading",labelOnly:"p-button-loading-label-only"},pR=(()=>{class n{el;document;iconPos="left";loadingIcon;get label(){return this._label}set label(t){this._label=t,this.initialized&&(this.updateLabel(),this.updateIcon(),this.setStyleClass())}get icon(){return this._icon}set icon(t){this._icon=t,this.initialized&&(this.updateIcon(),this.setStyleClass())}get loading(){return this._loading}set loading(t){this._loading=t,this.initialized&&(this.updateIcon(),this.setStyleClass())}severity;raised=!1;rounded=!1;text=!1;outlined=!1;size=null;plain=!1;_label;_icon;_loading=!1;initialized;get htmlElement(){return this.el.nativeElement}_internalClasses=Object.values(Qt);spinnerIcon=`<svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" class="p-icon-spin">
        <g clip-path="url(#clip0_417_21408)">
            <path
                d="M6.99701 14C5.85441 13.999 4.72939 13.7186 3.72012 13.1832C2.71084 12.6478 1.84795 11.8737 1.20673 10.9284C0.565504 9.98305 0.165424 8.89526 0.041387 7.75989C-0.0826496 6.62453 0.073125 5.47607 0.495122 4.4147C0.917119 3.35333 1.59252 2.4113 2.46241 1.67077C3.33229 0.930247 4.37024 0.413729 5.4857 0.166275C6.60117 -0.0811796 7.76026 -0.0520535 8.86188 0.251112C9.9635 0.554278 10.9742 1.12227 11.8057 1.90555C11.915 2.01493 11.9764 2.16319 11.9764 2.31778C11.9764 2.47236 11.915 2.62062 11.8057 2.73C11.7521 2.78503 11.688 2.82877 11.6171 2.85864C11.5463 2.8885 11.4702 2.90389 11.3933 2.90389C11.3165 2.90389 11.2404 2.8885 11.1695 2.85864C11.0987 2.82877 11.0346 2.78503 10.9809 2.73C9.9998 1.81273 8.73246 1.26138 7.39226 1.16876C6.05206 1.07615 4.72086 1.44794 3.62279 2.22152C2.52471 2.99511 1.72683 4.12325 1.36345 5.41602C1.00008 6.70879 1.09342 8.08723 1.62775 9.31926C2.16209 10.5513 3.10478 11.5617 4.29713 12.1803C5.48947 12.7989 6.85865 12.988 8.17414 12.7157C9.48963 12.4435 10.6711 11.7264 11.5196 10.6854C12.3681 9.64432 12.8319 8.34282 12.8328 7C12.8328 6.84529 12.8943 6.69692 13.0038 6.58752C13.1132 6.47812 13.2616 6.41667 13.4164 6.41667C13.5712 6.41667 13.7196 6.47812 13.8291 6.58752C13.9385 6.69692 14 6.84529 14 7C14 8.85651 13.2622 10.637 11.9489 11.9497C10.6356 13.2625 8.85432 14 6.99701 14Z"
                fill="currentColor"
            />
        </g>
        <defs>
            <clipPath id="clip0_417_21408">
                <rect width="14" height="14" fill="white" />
            </clipPath>
        </defs>
    </svg>`;constructor(t,i){this.el=t,this.document=i}ngAfterViewInit(){ee.addMultipleClasses(this.htmlElement,this.getStyleClass().join(" ")),this.createIcon(),this.createLabel(),this.initialized=!0}getStyleClass(){let t=[Qt.button,Qt.component];return this.icon&&!this.label&&Dn.isEmpty(this.htmlElement.textContent)&&t.push(Qt.iconOnly),this.loading&&(t.push(Qt.disabled,Qt.loading),!this.icon&&this.label&&t.push(Qt.labelOnly),this.icon&&!this.label&&!Dn.isEmpty(this.htmlElement.textContent)&&t.push(Qt.iconOnly)),this.text&&t.push("p-button-text"),this.severity&&t.push(`p-button-${this.severity}`),this.plain&&t.push("p-button-plain"),this.raised&&t.push("p-button-raised"),this.size&&t.push(`p-button-${this.size}`),this.outlined&&t.push("p-button-outlined"),this.rounded&&t.push("p-button-rounded"),this.size==="small"&&t.push("p-button-sm"),this.size==="large"&&t.push("p-button-lg"),t}setStyleClass(){let t=this.getStyleClass();this.htmlElement.classList.remove(...this._internalClasses),this.htmlElement.classList.add(...t)}createLabel(){if(!ee.findSingle(this.htmlElement,".p-button-label")&&this.label){let i=this.document.createElement("span");this.icon&&!this.label&&i.setAttribute("aria-hidden","true"),i.className="p-button-label",i.appendChild(this.document.createTextNode(this.label)),this.htmlElement.appendChild(i)}}createIcon(){if(!ee.findSingle(this.htmlElement,".p-button-icon")&&(this.icon||this.loading)){let i=this.document.createElement("span");i.className="p-button-icon",i.setAttribute("aria-hidden","true");let r=this.label?"p-button-icon-"+this.iconPos:null;r&&ee.addClass(i,r);let s=this.getIconClass();s&&ee.addMultipleClasses(i,s),!this.loadingIcon&&this.loading&&(i.innerHTML=this.spinnerIcon),this.htmlElement.insertBefore(i,this.htmlElement.firstChild)}}updateLabel(){let t=ee.findSingle(this.htmlElement,".p-button-label");if(!this.label){t&&this.htmlElement.removeChild(t);return}t?t.textContent=this.label:this.createLabel()}updateIcon(){let t=ee.findSingle(this.htmlElement,".p-button-icon"),i=ee.findSingle(this.htmlElement,".p-button-label");this.loading?!this.loadingIcon&&t?t.innerHTML=this.spinnerIcon:this.loadingIcon&&t&&(t.className=`p-button-icon ${this.loadingIcon}`):this.icon&&t?t.className=`p-button-icon ${this.icon}`:t&&(t.innerHTML="",this.createIcon()),t?this.iconPos?t.className="p-button-icon "+(i?"p-button-icon-"+this.iconPos:"")+" "+this.getIconClass():t.className="p-button-icon "+this.getIconClass():this.createIcon()}getIconClass(){return this.loading?"p-button-loading-icon "+(this.loadingIcon?this.loadingIcon:"p-icon"):this.icon||"p-hidden"}ngOnDestroy(){this.initialized=!1}static \u0275fac=function(i){return new(i||n)(xe(tn),xe(Un))};static \u0275dir=Ot({type:n,selectors:[["","pButton",""]],hostAttrs:[1,"p-element"],inputs:{iconPos:"iconPos",loadingIcon:"loadingIcon",label:"label",icon:"icon",loading:"loading",severity:"severity",raised:[oe.HasDecoratorInputTransform,"raised","raised",de],rounded:[oe.HasDecoratorInputTransform,"rounded","rounded",de],text:[oe.HasDecoratorInputTransform,"text","text",de],outlined:[oe.HasDecoratorInputTransform,"outlined","outlined",de],size:"size",plain:[oe.HasDecoratorInputTransform,"plain","plain",de]},standalone:!0,features:[nn]})}return n})(),TT=(()=>{class n{el;type="button";iconPos="left";icon;badge;label;disabled;loading=!1;loadingIcon;raised=!1;rounded=!1;text=!1;plain=!1;severity;outlined=!1;link=!1;tabindex;size;style;styleClass;badgeClass;ariaLabel;autofocus;onClick=new Kr;onFocus=new Kr;onBlur=new Kr;contentTemplate;loadingIconTemplate;iconTemplate;templates;constructor(t){this.el=t}spinnerIconClass(){return Object.entries(this.iconClass()).filter(([,t])=>!!t).reduce((t,[i])=>t+` ${i}`,"p-button-loading-icon")}iconClass(){let t={"p-button-icon":!0,"p-button-icon-left":this.iconPos==="left"&&this.label,"p-button-icon-right":this.iconPos==="right"&&this.label,"p-button-icon-top":this.iconPos==="top"&&this.label,"p-button-icon-bottom":this.iconPos==="bottom"&&this.label};return this.loading?t[`p-button-loading-icon pi-spin ${this.loadingIcon??""}`]=!0:this.icon&&(t[this.icon]=!0),t}get buttonClass(){return{"p-button p-component":!0,"p-button-icon-only":(this.icon||this.iconTemplate||this.loadingIcon||this.loadingIconTemplate)&&!this.label,"p-button-vertical":(this.iconPos==="top"||this.iconPos==="bottom")&&this.label,"p-disabled":this.disabled||this.loading,"p-button-loading":this.loading,"p-button-loading-label-only":this.loading&&!this.icon&&this.label&&!this.loadingIcon&&this.iconPos==="left","p-button-link":this.link,[`p-button-${this.severity}`]:this.severity,"p-button-raised":this.raised,"p-button-rounded":this.rounded,"p-button-text":this.text,"p-button-outlined":this.outlined,"p-button-sm":this.size==="small","p-button-lg":this.size==="large","p-button-plain":this.plain,[`${this.styleClass}`]:this.styleClass}}ngAfterContentInit(){this.templates?.forEach(t=>{switch(t.getType()){case"content":this.contentTemplate=t.template;break;case"icon":this.iconTemplate=t.template;break;case"loadingicon":this.loadingIconTemplate=t.template;break;default:this.contentTemplate=t.template;break}})}badgeStyleClass(){return{"p-badge p-component":!0,"p-badge-no-gutter":this.badge&&String(this.badge).length===1}}static \u0275fac=function(i){return new(i||n)(xe(tn))};static \u0275cmp=ut({type:n,selectors:[["p-button"]],contentQueries:function(i,r,s){if(i&1&&xh(s,dm,4),i&2){let a;Lh(a=Mh())&&(r.templates=a)}},hostAttrs:[1,"p-element"],inputs:{type:"type",iconPos:"iconPos",icon:"icon",badge:"badge",label:"label",disabled:[oe.HasDecoratorInputTransform,"disabled","disabled",de],loading:[oe.HasDecoratorInputTransform,"loading","loading",de],loadingIcon:"loadingIcon",raised:[oe.HasDecoratorInputTransform,"raised","raised",de],rounded:[oe.HasDecoratorInputTransform,"rounded","rounded",de],text:[oe.HasDecoratorInputTransform,"text","text",de],plain:[oe.HasDecoratorInputTransform,"plain","plain",de],severity:"severity",outlined:[oe.HasDecoratorInputTransform,"outlined","outlined",de],link:[oe.HasDecoratorInputTransform,"link","link",de],tabindex:[oe.HasDecoratorInputTransform,"tabindex","tabindex",Uh],size:"size",style:"style",styleClass:"styleClass",badgeClass:"badgeClass",ariaLabel:"ariaLabel",autofocus:[oe.HasDecoratorInputTransform,"autofocus","autofocus",de]},outputs:{onClick:"onClick",onFocus:"onFocus",onBlur:"onBlur"},standalone:!0,features:[nn,lt],ngContentSelectors:cT,decls:7,vars:14,consts:[["pRipple","","pAutoFocus","",3,"click","focus","blur","ngStyle","disabled","ngClass","autofocus"],[4,"ngTemplateOutlet"],[4,"ngIf"],["class","p-button-label",4,"ngIf"],[3,"ngClass","class",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngClass",4,"ngIf"],[3,"styleClass","spin",4,"ngIf"],[3,"ngClass"],[3,"styleClass","spin"],[3,"ngIf"],[1,"p-button-label"]],template:function(i,r){i&1&&(cn(),sn(0,"button",0),kh("click",function(a){return r.onClick.emit(a)})("focus",function(a){return r.onFocus.emit(a)})("blur",function(a){return r.onBlur.emit(a)}),un(1),rn(2,uT,1,0,"ng-container",1)(3,mT,3,5,"ng-container",2)(4,IT,3,5,"ng-container",2)(5,vT,2,3,"span",3)(6,ET,2,5,"span",4),on()),i&2&&(ce("ngStyle",r.style)("disabled",r.disabled||r.loading)("ngClass",r.buttonClass)("autofocus",r.autofocus),Qe("type",r.type)("aria-label",r.ariaLabel)("data-pc-name","button")("data-pc-section","root")("tabindex",r.tabindex),Ie(2),ce("ngTemplateOutlet",r.contentTemplate),Ie(),ce("ngIf",r.loading),Ie(),ce("ngIf",!r.loading),Ie(),ce("ngIf",!r.contentTemplate&&r.label),Ie(),ce("ngIf",!r.contentTemplate&&r.badge))},dependencies:[qh,Wh,$h,Bh,ym,mm,_m],encapsulation:2,changeDetection:0})}return n})(),mR=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=Nt({type:n});static \u0275inj=Dt({imports:[TT,fm]})}return n})();export{AT as a,bT as b,ST as c,RT as d,CT as e,PT as f,DT as g,NT as h,OT as i,kT as j,xT as k,LT as l,MT as m,VT as n,FT as o,UT as p,BT as q,qT as r,WT as s,zT as t,GT as u,jT as v,HT as w,KT as x,QT as y,YT as z,JT as A,XT as B,ZT as C,ew as D,tw as E,nw as F,iw as G,rw as H,sw as I,ow as J,aw as K,cw as L,uw as M,lw as N,hw as O,dw as P,fw as Q,pw as R,mw as S,gw as T,_w as U,yw as V,Iw as W,vw as X,Ew as Y,Tw as Z,ww as _,Aw as $,ve as aa,db as ba,yb as ca,dA as da,fA as ea,ny as fa,_n as ga,ib as ha,rb as ia,sb as ja,ob as ka,ab as la,cb as ma,ub as na,lb as oa,ZS as pa,e0 as qa,s0 as ra,Dn as sa,um as ta,c0 as ua,y0 as va,hm as wa,I0 as xa,v0 as ya,dm as za,fm as Aa,E0 as Ba,ee as Ca,pm as Da,mm as Ea,D0 as Fa,gm as Ga,ym as Ha,Q0 as Ia,pR as Ja,TT as Ka,mR as La};
